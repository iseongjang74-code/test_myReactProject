import{u as Ft,a as qt,r as m,j as e,O as Vt,L as Wt,b as Yt,X as zt,K as Kt,S as St,B as Jt,c as Xt,V as $e,F as kt,A as Zt,U as Tt,d as Qt,e as Et,Z as lt,R as Ct,f as es,C as ts,T as it,g as ss,H as as,h as rs,i as ns,k as ls,l as is,m as os,P as cs,n as ds,o as ms,p as xs,q as He,s as hs,t as us,v as Se,w as ps}from"./vendor_react-uPswq-Yw.js";import{G as _e,T as K,M as fs}from"./vendor_ai-CSRnzdR-.js";import"./vendor-DnC4bF5A.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();const gs=({activeCategory:t,onCategoryChange:n})=>{const s=Ft(),a=qt(),[r,i]=m.useState(()=>typeof window<"u"?localStorage.getItem("theme")==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches:!1);m.useEffect(()=>{const h=window.document.documentElement;r?(h.classList.add("dark"),localStorage.setItem("theme","dark")):(h.classList.remove("dark"),localStorage.setItem("theme","light"))},[r]);const o=()=>{i(!r)},d=typeof window<"u"&&window.history.length>1,c=typeof window<"u"&&a.pathname==="/"&&!d,u=["All","Game","MBTI"],g={All:"전체",Game:"게임",MBTI:"MBTI"};return e.jsx("header",{className:"bg-white dark:bg-slate-800 shadow-md sticky top-0 z-10",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"py-4 flex justify-between items-center",role:"banner",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-sky-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})}),e.jsx("span",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"SiteBuilder"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:o,className:"p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors","aria-label":"테마 전환",children:r?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})})})]}),e.jsxs("nav",{"aria-label":"카테고리 네비게이션",className:"flex items-center border-b border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:()=>s(c?"/":-1),"aria-label":c?"홈으로 이동":"뒤로가기",title:c?"홈으로 이동":"뒤로가기",className:"p-2 mx-2 rounded-md text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:c?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9.5L12 4l9 5.5V21a1 1 0 0 1-1 1h-6v-6H10v6H4a1 1 0 0 1-1-1V9.5z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("div",{className:"flex-1 flex",children:u.map(h=>e.jsx("button",{onClick:()=>n(h),"aria-current":t===h?"page":void 0,className:`px-4 py-2 text-sm font-medium transition-colors duration-200 ${t===h?"border-b-2 border-sky-500 text-sky-600 dark:text-sky-400":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:g[h]},h))})]})]})})},bs=()=>e.jsx("footer",{className:"bg-white dark:bg-slate-800 shadow-inner mt-16",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 text-center text-slate-500 dark:text-slate-400",children:[e.jsxs("p",{className:"text-sm",children:["© ",new Date().getFullYear()," 기로뇽뇽. All rights reserved."]}),e.jsx("p",{className:"text-xs mt-2",children:"경기도 성남시 분당구 대장동 풍경채 어바니티 7단지"})]})}),ys=()=>{const[t,n]=m.useState("All");return e.jsxs("div",{className:"flex flex-col min-h-screen text-slate-800 dark:text-slate-200 transition-colors duration-300",children:[e.jsx(gs,{activeCategory:t,onCategoryChange:n}),e.jsx("main",{className:"flex-grow",children:e.jsx(Vt,{context:{activeCategory:t,setActiveCategory:n}})}),e.jsx(bs,{})]})},js=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"})}),ws=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),vs=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),ot=({website:t,onDelete:n})=>{const s=r=>{r.preventDefault(),r.stopPropagation(),n(t.id)},a=r=>{r.preventDefault(),r.stopPropagation()};return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-lg overflow-hidden transform hover:-translate-y-2 transition-transform duration-300 ease-in-out flex flex-col",children:[e.jsx("img",{src:t.thumbnailUrl,alt:t.name,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-6 flex flex-col flex-grow",children:[e.jsx("h3",{className:"text-xl font-bold mb-2 text-slate-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 flex-grow mb-6",children:t.description}),e.jsxs("div",{className:"mt-auto flex justify-end gap-2",children:[e.jsx("button",{className:"p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors","aria-label":"Visit site",children:e.jsx(vs,{})}),e.jsx("button",{onClick:a,className:"p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors","aria-label":"Edit site",children:e.jsx(js,{})}),e.jsx("button",{onClick:s,className:"p-2 rounded-full text-red-500 hover:bg-red-100 dark:hover:bg-red-900/50 transition-colors","aria-label":"Delete site",children:e.jsx(ws,{})})]})]})]})},Ns=({website:t,onDelete:n})=>t.path?e.jsx(Wt,{to:t.path,className:"block hover:scale-[1.01] transition-transform duration-150",children:e.jsx(ot,{website:t,onDelete:n})}):e.jsx(ot,{website:t,onDelete:n}),Ss=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),ks=({isOpen:t,onClose:n,onCreate:s})=>{const[a,r]=m.useState(""),[i,o]=m.useState(""),[d,c]=m.useState("Game");m.useEffect(()=>{t&&(r(""),o(""),c("Game"))},[t]);const u=g=>{g.preventDefault(),a.trim()&&i.trim()&&s({name:a,description:i,category:d})};return t?e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4",onClick:n,children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-2xl p-8 w-full max-w-md transform transition-all duration-300 ease-in-out scale-95 opacity-0 animate-fade-in-scale",onClick:g=>g.stopPropagation(),style:{animation:"fade-in-scale 0.3s forwards"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Create New Website"}),e.jsx("button",{onClick:n,className:"p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors","aria-label":"Close modal",children:e.jsx(Ss,{})})]}),e.jsxs("form",{onSubmit:u,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"website-name",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Website Name"}),e.jsx("input",{type:"text",id:"website-name",value:a,onChange:g=>r(g.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",placeholder:"e.g., My Awesome Project",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"website-description",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{id:"website-description",value:i,onChange:g=>o(g.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",placeholder:"A brief description of what your website is about.",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"website-category",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Category"}),e.jsxs("select",{id:"website-category",value:d,onChange:g=>c(g.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e.jsx("option",{value:"Game",children:"게임"}),e.jsx("option",{value:"MBTI",children:"MBTI"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-slate-200 dark:bg-slate-600 text-slate-800 dark:text-slate-200 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-500 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-sky-500 text-white font-bold rounded-lg hover:bg-sky-600 disabled:bg-sky-300 dark:disabled:bg-sky-800 disabled:cursor-not-allowed transition-colors",disabled:!a.trim()||!i.trim(),children:"Create Site"})]})]})]}),e.jsx("style",{children:`
        @keyframes fade-in-scale {
          from {
            transform: scale(0.95);
            opacity: 0;
          }
          to {
            transform: scale(1);
            opacity: 1;
          }
        }
      `})]}):null},ct=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),Ts=()=>{const{activeCategory:t,setActiveCategory:n}=Yt(),[s,a]=m.useState([{id:1,name:"DilemmaSimulator",description:"A professional portfolio showcasing my projects and skills in software development.",thumbnailUrl:"https://picsum.photos/seed/portfolio/600/400",category:"MBTI",path:"/DilemmaSimulator"},{id:2,name:"card",description:"A fordddddscuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/myCard"},{id:3,name:"gacha",description:"A forum for gamerjjjjjjs to discuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/gacha"},{id:4,name:"last night",description:"A forum for gaaaaaaamers to discuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/last_night"},{id:5,name:"mordern",description:"A forum for gaaaaaaamers to discuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/mordern"},{id:6,name:"word",description:"A forum for gaaaaaaamers to discuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/word"},{id:7,name:"word2",description:"A forum for gaaaaaaamers to discuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/word2"},{id:8,name:"click war",description:"A forum for gaaaaaaamers to discuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/click_war"},{id:9,name:"friend",description:"A forum for gaaaaaaamers to discuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/friend"},{id:10,name:"math",description:"A forum for gaaaaaaamers to discuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/math"},{id:11,name:"AI_voca",description:"A forum for gaaaaaamers to discuss strategies and new releases.",thumbnailUrl:"https://picsum.photos/seed/gaming/600/400",category:"Game",path:"/AI_voca"}]),[r,i]=m.useState(!1),o=m.useCallback(u=>{a(g=>[...g,{...u,id:Date.now(),thumbnailUrl:`https://picsum.photos/seed/${Date.now()}/600/400`,path:`/${u.name.toLowerCase().replace(/\s+/g,"-")}`}]),i(!1)},[]),d=m.useCallback(u=>{a(g=>g.filter(h=>h.id!==u))},[]),c=m.useMemo(()=>t==="All"?s:s.filter(u=>u.category===t),[s,t]);return e.jsxs("div",{className:"container mx-auto p-4 md:p-8 flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-slate-900 dark:text-white",children:"My Sites"}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg shadow-lg transform hover:scale-105 transition-transform duration-200",children:[e.jsx(ct,{}),"New Site"]})]}),c.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:c.map(u=>e.jsx(Ns,{website:u,onDelete:d},u.id))}):e.jsx("div",{className:"text-center py-16 px-6 bg-white dark:bg-slate-800 rounded-lg shadow-md",children:s.length===0?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"No Websites Yet!"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:'It looks a bit empty here. Click the "New Site" button to start your first project.'}),e.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center gap-2 bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transform hover:scale-105 transition-transform duration-200",children:[e.jsx(ct,{}),"Create Your First Site"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"No Websites in this Category"}),e.jsxs("p",{className:"text-slate-600 dark:text-slate-400",children:['There are no sites matching the category "',t,'".']})]})}),e.jsx(ks,{isOpen:r,onClose:()=>i(!1),onCreate:o})]})},Es={start:{title:"엄마 편? 아빠 편?",description:"딜레마로 인한 결과를 참혹하게 보여줄 예정",isStart:!0,choices:[{text:"엄마 편",nextScene:"momRouteStart",color:"red"},{text:"아빠 편",nextScene:"dadRouteStart",color:"blue"}]},momRouteStart:{character:"아빠",dialogue:"그래? 너 엄마 편이야? 그럼 앞으로 게임은 없다.",choices:[{text:"말로 설득하기",nextScene:"momRoute_persuade"},{text:"몰래 게임하기",nextScene:"momRoute_sneak"}]},momRoute_persuade:{character:"아빠",dialogue:"시끄럽다. 당분간 너는 공부 먼저다.",description:"아빠가 게임기 전원을 뽑고 숨겨버린다.",choices:[{text:"게임기 찾기",nextScene:"momRoute_findGame"},{text:"순순히 따르기",nextScene:"momRoute_obey"}]},momRoute_sneak:{character:"나",dialogue:"아빠가 잠들 때까지 기다렸다가 몰래 게임을 했다. 하지만 다음 날 아침, 아빠에게 들키고 말았다.",description:"아빠가 화를 내며 휴대폰을 압수했다.",choices:[{text:"미안하다고 말하기",nextScene:"momRoute_apologize"},{text:"반항하기",nextScene:"momRoute_rebel"}]},momRoute_findGame:{character:"나",dialogue:"아빠가 게임기를 어디에 숨겼을까?",description:"방, 거실, 차 안을 뒤져보았지만 찾을 수 없었다. 결국 아빠에게 게임기를 찾으려 한 것을 들키고 휴대폰도 압수당했다.",choices:[{text:"미안하다고 말하기",nextScene:"momRoute_apologize"},{text:"반항하기",nextScene:"momRoute_rebel"}]},momRoute_obey:{isEnding:!0,endingTitle:"현명한 타협 엔딩",dialogue:"나는 아빠의 말을 따르기로 했다. 게임 없는 삶은 지루했지만, 더 큰 갈등은 피할 수 있었다.",description:"시간이 흘러 아빠의 화가 누그러졌고, 우리는 게임 시간을 정하는 것으로 타협했다.",choices:[{text:"다시 시작하기",nextScene:"start"}]},momRoute_apologize:{isEnding:!0,endingTitle:"게임 상실 엔딩",dialogue:"잘못했어요... 다시는 안 그럴게요.",description:"나의 사과에 아빠의 마음도 조금은 누그러졌다. 휴대폰은 돌려받았지만, 게임기는 영영 돌아오지 않았다.",choices:[{text:"다시 시작하기",nextScene:"start"}]},momRoute_rebel:{isEnding:!0,endingTitle:"완전한 통제 엔딩",dialogue:"아빠가 뭔데요! 이건 내 거란 말이에요!",description:"나의 반항에 아빠는 더욱 화를 냈고, 집안의 분위기는 최악으로 치달았다. 나는 방에 갇혀 외부와의 모든 소통이 차단되었다.",choices:[{text:"다시 시작하기",nextScene:"start"}]},dadRouteStart:{character:"엄마",dialogue:"네가… 아빠 편을 든다고? 그래. 그럼 공부만 해.",choices:[{text:"사과하기",nextScene:"dadRoute_apologize"},{text:"그냥 방으로 들어가기",nextScene:"dadRoute_goRoom"}]},dadRoute_apologize:{character:"나",dialogue:"엄마, 미안해요. 그런 뜻이 아니었는데...",description:"엄마는 내 사과를 받아주었지만, 서운한 감정은 쉽게 가시지 않는 듯 보였다. 엄마는 한숨을 쉬며 내 성적표를 꺼내 들었다.",choices:[{text:"대화를 이어나가기",nextScene:"dadRoute_talk"},{text:"자리를 피하기",nextScene:"dadRoute_goRoom"}]},dadRoute_goRoom:{character:"엄마",dialogue:"어딜 도망가? 앉아봐. 수학 학원 하나 더 등록하자.",description:"엄마가 내 방 문을 열고 들어와 잔소리를 시작한다.",choices:[{text:"거절하기",nextScene:"dadRoute_refuse"},{text:"억지로 동의하기",nextScene:"dadRoute_agree"}]},dadRoute_talk:{isEnding:!0,endingTitle:"관계 회복 엔딩",dialogue:"엄마, 저도 노력하고 있어요. 조금만 믿고 기다려주세요.",description:"나의 진심 어린 말에 엄마는 잠시 생각에 잠겼다. 우리는 오랜 대화 끝에 서로의 입장을 이해하게 되었다.",choices:[{text:"다시 시작하기",nextScene:"start"}]},dadRoute_refuse:{character:"나",dialogue:"싫어요. 지금도 충분히 힘들어요.",description:"나의 거절에 엄마는 크게 실망한 눈치였다. 그날 이후, 엄마의 잔소리는 전보다 훨씬 심해졌다.",choices:[{text:"알아서 할게라고 말하기",nextScene:"dadRoute_byMyself"},{text:"폭발해서 소리치기",nextScene:"dadRoute_explode"}]},dadRoute_agree:{character:"나",dialogue:"네... 알겠어요.",description:"학원이 하나 더 늘었고, 친구들과 만날 시간은 완전히 사라졌다. 엄마의 기대치는 점점 더 높아져만 간다.",choices:[{text:"알아서 할게라고 말하기",nextScene:"dadRoute_byMyself"},{text:"폭발해서 소리치기",nextScene:"dadRoute_explode"}]},dadRoute_byMyself:{isEnding:!0,endingTitle:"공부 지옥 엔딩",dialogue:"엄마, 제발요. 제가 알아서 할게요!",description:"엄마는 내 말을 믿지 않았다. 결국 나는 엄마가 짜준 빡빡한 스케줄 속에서 숨 막히는 하루하루를 보내게 되었다.",choices:[{text:"다시 시작하기",nextScene:"start"}]},dadRoute_explode:{isEnding:!0,endingTitle:"관계 파탄 엔딩",dialogue:"이제 그만 좀 하세요! 숨 막혀 죽을 것 같단 말이에요!",description:"나의 폭발에 엄마는 충격을 받은 듯 보였다. 집안은 얼음장처럼 차가워졌고, 엄마와 나는 서로 말을 섞지 않게 되었다.",choices:[{text:"다시 시작하기",nextScene:"start"}]}},Cs=({scene:t,onChoice:n})=>e.jsxs(e.Fragment,{children:[e.jsxs("main",{className:"flex flex-col items-center space-y-6 md:space-y-8 w-full max-w-2xl",children:[e.jsx("div",{className:"relative w-full aspect-[16/10] bg-black/30 rounded-xl border border-gray-700 overflow-hidden shadow-2xl",children:e.jsxs("svg",{className:"absolute inset-0 w-full h-full",viewBox:"0 0 400 250",preserveAspectRatio:"xMidYMid slice",children:[e.jsxs("defs",{children:[e.jsxs("radialGradient",{id:"redGlow",cx:"15%",cy:"50%",r:"50%",fx:"15%",fy:"50%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"rgba(220, 38, 38, 0.5)",stopOpacity:1}}),e.jsx("stop",{offset:"100%",style:{stopColor:"rgba(220, 38, 38, 0)",stopOpacity:0}})]}),e.jsxs("radialGradient",{id:"blueGlow",cx:"85%",cy:"50%",r:"50%",fx:"85%",fy:"50%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"rgba(59, 130, 246, 0.5)",stopOpacity:1}}),e.jsx("stop",{offset:"100%",style:{stopColor:"rgba(59, 130, 246, 0)",stopOpacity:0}})]})]}),e.jsx("rect",{width:"400",height:"250",fill:"url(#redGlow)"}),e.jsx("rect",{width:"400",height:"250",fill:"url(#blueGlow)"}),e.jsx("g",{transform:"translate(60 160) scale(0.6)",children:e.jsx("path",{d:"M52.3,92.5c-2.4-5.3-4.5-10.7-6-16.3c-3.4-12.7-5.9-25.7-6.2-39.1c-0.2-8.3,0.5-16.6,1.9-24.7 c1.6-9.1,4.1-17.9,8-26.1c5.2-11,12.3-20.7,21.6-28.3c8.9-7.2,19.3-12.3,30.7-14.9c-8.9,13.1-13.4,28.2-12.9,43.4 c0.5,15.7,5.9,30.8,15.4,43.2C89.7,94.2,75.4,98.5,62.3,105.9C58.1,100.3,54.8,96.1,52.3,92.5z",fill:"black"})}),e.jsx("g",{transform:"translate(250 160) scale(0.6) scale(-1, 1) translate(-140, 0)",children:e.jsx("path",{d:"M52.3,92.5c-2.4-5.3-4.5-10.7-6-16.3c-3.4-12.7-5.9-25.7-6.2-39.1c-0.2-8.3,0.5-16.6,1.9-24.7 c1.6-9.1,4.1-17.9,8-26.1c5.2-11,12.3-20.7,21.6-28.3c8.9-7.2,19.3-12.3,30.7-14.9c-8.9,13.1-13.4,28.2-12.9,43.4 c0.5,15.7,5.9,30.8,15.4,43.2C89.7,94.2,75.4,98.5,62.3,105.9C58.1,100.3,54.8,96.1,52.3,92.5z",fill:"black"})}),e.jsx("g",{transform:"translate(198, 180) scale(0.4)",children:e.jsx("path",{d:"M49.5,82.7c-1.3-3-2.5-5.9-3.4-9c-1.9-7-3.3-14.2-3.4-21.6c-0.1-4.6,0.3-9.2,1-13.6c0.9-5,2.3-9.9,4.4-14.4 c2.9-6,6.8-11.4,11.9-15.6c4.9-3.9,10.7-6.8,16.9-8.2c-4.9,7.2-7.4,15.5-7.1,23.9c0.3,8.7,3.2,17,8.5,23.8 c-8.3,0.9-16.2,3.3-23.4,7.4C56,70,52.3,76,49.5,82.7z",fill:"black"})})]})}),e.jsxs("section",{className:"text-center",children:[e.jsx("h2",{className:"text-5xl md:text-6xl font-black text-white drop-shadow-lg",children:t.title}),e.jsx("p",{className:"text-red-500 font-bold mt-2 text-lg md:text-xl tracking-tight",children:t.description})]})]}),e.jsx("footer",{className:"w-full max-w-2xl pt-4 md:pt-8",children:e.jsx("div",{className:"flex flex-col md:flex-row justify-around items-center gap-6",children:t.choices.map((s,a)=>e.jsx("button",{onClick:()=>n(s.nextScene),className:`w-full md:w-auto text-2xl md:text-3xl font-bold text-white rounded-lg px-12 py-4 md:px-16 md:py-5 transition-all duration-300 focus:outline-none 
              ${s.color==="red"?"bg-red-900/70 border-2 border-red-600 hover:bg-red-800/90 hover:shadow-[0_0_25px_rgba(239,68,68,0.7)] focus:ring-4 focus:ring-red-500/50":"bg-blue-900/70 border-2 border-blue-600 hover:bg-blue-800/90 hover:shadow-[0_0_25px_rgba(59,130,246,0.7)] focus:ring-4 focus:ring-blue-500/50"}`,children:s.text},a))})})]}),Ms=({scene:t,onChoice:n})=>e.jsxs(e.Fragment,{children:[e.jsxs("main",{className:"flex flex-col items-center space-y-8 w-full max-w-2xl bg-black/30 rounded-xl border border-gray-700 p-8 shadow-2xl",children:[t.isEnding&&e.jsx("h2",{className:"text-4xl font-black text-yellow-400 drop-shadow-lg",children:t.endingTitle}),t.character&&e.jsxs("p",{className:"text-2xl font-bold text-gray-300",children:[t.character,":"]}),e.jsxs("p",{className:"text-3xl text-center leading-relaxed",children:['"',t.dialogue,'"']}),t.description&&e.jsx("p",{className:"text-lg text-gray-400 text-center italic mt-4",children:t.description})]}),e.jsx("footer",{className:"w-full max-w-2xl pt-8",children:e.jsx("div",{className:"flex flex-col justify-around items-center gap-4",children:t.choices.map((s,a)=>e.jsx("button",{onClick:()=>n(s.nextScene),className:"w-full md:w-3/4 text-xl font-bold text-white bg-gray-800/70 border-2 border-gray-600 rounded-lg px-12 py-4 transition-all duration-300 hover:bg-gray-700/90 hover:border-gray-400 focus:outline-none focus:ring-4 focus:ring-gray-500/50",children:s.text},a))})})]}),As=()=>{const[t,n]=m.useState("start"),[s,a]=m.useState(!1),r=Es[t],i=o=>{a(!0),setTimeout(()=>{n(o),a(!1)},300)};return e.jsxs("div",{className:"bg-gradient-to-b from-black to-gray-900 min-h-screen text-white flex flex-col items-center justify-center p-4 space-y-6 md:space-y-8 font-['Noto_Sans_KR']",children:[e.jsxs("header",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-black tracking-wider",children:"DILEMMA SIMULATOR"}),e.jsx("p",{className:"text-gray-400 mt-2 text-md md:text-lg",children:"당신의 선택이 누군가의 마지막이 된다."})]}),e.jsx("div",{className:`w-full flex flex-col items-center space-y-6 md:space-y-8 transition-opacity duration-300 ${s?"opacity-0":"opacity-100"}`,children:r.isStart?e.jsx(Cs,{scene:r,onChoice:i}):e.jsx(Ms,{scene:r,onChoice:i})},t)]})},Is=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),Rs=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M6 17h3l2-4V7H5v6h3l-2 4zm8 0h3l2-4V7h-6v6h3l-2 4z"})}),Ls=({name:t,likes:n,motto:s,imageUrl:a})=>e.jsx("div",{className:"max-w-sm w-full bg-white rounded-2xl shadow-xl transform transition-all hover:scale-105 duration-300 ease-in-out",children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("img",{className:"w-32 h-32 rounded-full mx-auto shadow-lg border-4 border-slate-200",src:a,alt:`${t}의 프로필 사진`}),e.jsx("h1",{className:"mt-6 text-3xl font-bold text-slate-800",children:t}),e.jsx("hr",{className:"my-6 border-t border-slate-200"}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-700 flex items-center justify-center gap-2",children:[e.jsx(Is,{className:"w-6 h-6 text-red-500"}),"좋아하는 것"]}),e.jsx("div",{className:"mt-4 flex flex-wrap justify-center gap-2",children:n.map((r,i)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:r},i))})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-700 flex items-center justify-center gap-2",children:[e.jsx(Rs,{className:"w-6 h-6 text-green-500"}),"좌우명"]}),e.jsxs("blockquote",{className:"mt-4 text-slate-600 italic text-md leading-relaxed",children:['"',s,'"']})]})]})}),_s=()=>{const t={name:"Daniel",likes:["자동차","자전거","전자기기","잘 놀기"],motto:"흘러가는 대로 구르는 대로 부딪히는 대로 밀리는 대로",imageUrl:"/image.png"};return e.jsx("main",{className:"bg-slate-100 min-h-screen flex items-center justify-center p-4 font-sans",children:e.jsx(Ls,{name:t.name,likes:t.likes,motto:t.motto,imageUrl:t.imageUrl})})};var S=(t=>(t.N="N",t.R="R",t.SR="SR",t.SSR="SSR",t.Mythic="신화",t))(S||{}),ie=(t=>(t.Fire="불",t.Water="물",t.Wind="바람",t.Light="빛",t.Dark="어둠",t))(ie||{}),fe=(t=>(t.R="R",t.SR="SR",t.SSR="SSR",t.Mythic="신화",t))(fe||{}),be=(t=>(t.SINGLE_TARGET_DAMAGE="단일 대상 공격",t.AREA_OF_EFFECT_DAMAGE="광역 공격",t.HEAL_SELF="자가 치유",t.HEAL_TEAM="팀 치유",t))(be||{}),Te=(t=>(t.ENEMY_SINGLE="적 단일",t.ENEMY_ALL="적 전체",t.ALLY_SELF="자신",t.ALLY_ALL="아군 전체",t))(Te||{}),J=(t=>(t.HOME="HOME",t.STUDY="STUDY",t.TEST="TEST",t.RESULT="RESULT",t.WRONG_REVIEW="WRONG_REVIEW",t))(J||{}),Pe=(t=>(t.BEST_FRIEND="베스트 프렌드",t.SCHOOL="학교 친구",t.WORK="직장 동료",t.HOBBY="취미 활동",t.OTHER="기타",t))(Pe||{}),Ee=(t=>(t.EASY="쉬움",t.MEDIUM="보통",t.HARD="어려움",t))(Ee||{}),st=(t=>(t.BEGINNER="Beginner",t.INTERMEDIATE="Intermediate",t.ADVANCED="Advanced",t.EXPERT="Expert",t))(st||{});const Le=[{id:1,name:"기본 일격",description:"적 하나에게 기본 피해를 줍니다.",rarity:fe.R,level:1,effectType:be.SINGLE_TARGET_DAMAGE,power:1.5,targetType:Te.ENEMY_SINGLE},{id:2,name:"치유의 빛",description:"자신을 약간 회복시킵니다.",rarity:fe.R,level:1,effectType:be.HEAL_SELF,power:500,targetType:Te.ALLY_SELF},{id:3,name:"파이어볼",description:"적 하나에게 강력한 화염 피해를 줍니다.",rarity:fe.SR,level:1,effectType:be.SINGLE_TARGET_DAMAGE,power:2.5,targetType:Te.ENEMY_SINGLE},{id:4,name:"대지 가르기",description:"모든 적에게 피해를 줍니다.",rarity:fe.SR,level:1,effectType:be.AREA_OF_EFFECT_DAMAGE,power:1.2,targetType:Te.ENEMY_ALL},{id:5,name:"대천사의 축복",description:"모든 아군을 회복시킵니다.",rarity:fe.SSR,level:1,effectType:be.HEAL_TEAM,power:1e3,targetType:Te.ALLY_ALL},{id:6,name:"천벌",description:"적 하나에게 압도적인 신성 피해를 줍니다.",rarity:fe.SSR,level:1,effectType:be.SINGLE_TARGET_DAMAGE,power:5,targetType:Te.ENEMY_SINGLE},{id:7,name:"아마겟돈",description:"모든 적에게 파괴적인 피해를 입힙니다.",rarity:fe.Mythic,level:1,effectType:be.AREA_OF_EFFECT_DAMAGE,power:3.5,targetType:Te.ENEMY_ALL}],Ue=[{id:101,name:"훈련용 목검",rarity:S.N,level:1,cards:0,baseStats:{attack:10,hp:0,speed:0},specialEffect:"기본 공격력 증가",description:"초보자가 쓰기 좋은 목검."},{id:102,name:"낡은 가죽 갑옷",rarity:S.N,level:1,cards:0,baseStats:{attack:0,hp:50,speed:0},specialEffect:"기본 체력 증가",description:"최소한의 보호를 제공하는 갑옷."},{id:103,name:"강철 검",rarity:S.R,level:1,cards:0,baseStats:{attack:30,hp:0,speed:2},specialEffect:"공격력 소폭 증가",description:"잘 제련된 강철 검."},{id:104,name:"사냥꾼의 장화",rarity:S.R,level:1,cards:0,baseStats:{attack:5,hp:20,speed:10},specialEffect:"속도 소폭 증가",description:"가볍고 튼튼한 장화."},{id:105,name:"화염의 지팡이",rarity:S.SR,level:1,cards:0,baseStats:{attack:80,hp:0,speed:0},specialEffect:"화염 속성 공격력 강화",description:"불타오르는 마력이 깃든 지팡이."},{id:106,name:"미스릴 갑옷",rarity:S.SR,level:1,cards:0,baseStats:{attack:0,hp:300,speed:-5},specialEffect:"체력 대폭 증가",description:"가볍지만 매우 단단한 미스릴로 만든 갑옷."},{id:107,name:"엑스칼리버",rarity:S.SSR,level:1,cards:0,baseStats:{attack:250,hp:100,speed:5},specialEffect:"성스러운 힘으로 적을 압도",description:"전설 속의 왕이 사용하던 검."},{id:108,name:"드래곤 하트 목걸이",rarity:S.SSR,level:1,cards:0,baseStats:{attack:50,hp:800,speed:0},specialEffect:"생명력 재생",description:"용의 심장 조각으로 만든 목걸이."},{id:109,name:"신 살해자의 창",rarity:S.Mythic,level:1,cards:0,baseStats:{attack:800,hp:0,speed:20},specialEffect:"신에게도 상처를 입히는 힘",description:"신화를 끝내는 창."},{id:110,name:"아이기스",rarity:S.Mythic,level:1,cards:0,baseStats:{attack:0,hp:2500,speed:0},specialEffect:"모든 상태이상 저항",description:"신의 가호가 깃든 절대 방패."}],me=[{id:1,name:"블레이즈 나이트",rarity:S.N,attribute:ie.Fire,imageUrl:"https://picsum.photos/seed/1/200",level:1,cards:0,description:"작은 불꽃을 다루는 초보 기사.",equippedUltimateId:1},{id:2,name:"아쿠아 스프라이트",rarity:S.N,attribute:ie.Water,imageUrl:"https://picsum.photos/seed/2/200",level:1,cards:0,description:"장난기 많은 물의 정령.",equippedUltimateId:1},{id:3,name:"게일 아처",rarity:S.R,attribute:ie.Wind,imageUrl:"https://picsum.photos/seed/3/200",level:1,cards:0,description:"바람을 다루는 명사수.",equippedUltimateId:1},{id:4,name:"태양의 사제",rarity:S.R,attribute:ie.Light,imageUrl:"https://picsum.photos/seed/4/200",level:1,cards:0,description:"성스러운 빛을 사용하는 사제.",equippedUltimateId:2},{id:5,name:"그림자 시노비",rarity:S.R,attribute:ie.Dark,imageUrl:"https://picsum.photos/seed/5/200",level:1,cards:0,description:"그림자 속에 숨어드는 닌자.",equippedUltimateId:1},{id:6,name:"인페르노 소서러",rarity:S.SR,attribute:ie.Fire,imageUrl:"https://picsum.photos/seed/6/200",level:1,cards:0,description:"폭발적인 화염을 다루는 강력한 마법사.",equippedUltimateId:3},{id:7,name:"타이달 가디언",rarity:S.SR,attribute:ie.Water,imageUrl:"https://picsum.photos/seed/7/200",level:1,cards:0,description:"깊은 바다의 수호자.",equippedUltimateId:4},{id:8,name:"스톰 드라군",rarity:S.SR,attribute:ie.Wind,imageUrl:"https://picsum.photos/seed/8/200",level:1,cards:0,description:"폭풍을 타고 나는 용기사.",equippedUltimateId:1},{id:9,name:"천상의 발키리",rarity:S.SSR,attribute:ie.Light,imageUrl:"https://picsum.photos/seed/9/200",level:1,cards:0,description:"천상에서 내려온 신성한 전사.",equippedUltimateId:5},{id:10,name:"심연의 군주",rarity:S.SSR,attribute:ie.Dark,imageUrl:"https://picsum.photos/seed/10/200",level:1,cards:0,description:"어두운 심연의 절대 지배자.",equippedUltimateId:6},{id:11,name:"불사조",rarity:S.SSR,attribute:ie.Fire,imageUrl:"https://picsum.photos/seed/11/200",level:1,cards:0,description:"부활과 불의 불멸의 존재.",equippedUltimateId:6},{id:12,name:"리바이어던 현자",rarity:S.SSR,attribute:ie.Water,imageUrl:"https://picsum.photos/seed/12/200",level:1,cards:0,description:"바다를 다스리는 고대의 현자.",equippedUltimateId:5},{id:13,name:"템페스트 윙",rarity:S.SSR,attribute:ie.Wind,imageUrl:"https://picsum.photos/seed/13/200",level:1,cards:0,description:"태풍의 눈에서 태어난 날카로운 바람.",equippedUltimateId:4},{id:14,name:"나이트메어 팬텀",rarity:S.SSR,attribute:ie.Dark,imageUrl:"https://picsum.photos/seed/14/200",level:1,cards:0,description:"악몽을 현실로 만드는 공포의 현신.",equippedUltimateId:6},{id:15,name:"창세의 아크엔젤",rarity:S.Mythic,attribute:ie.Light,imageUrl:"https://picsum.photos/seed/15/200",level:1,cards:0,description:"세계를 창조한 빛의 대리인.",equippedUltimateId:7},{id:16,name:"종말의 이프리트",rarity:S.Mythic,attribute:ie.Fire,imageUrl:"https://picsum.photos/seed/16/200",level:1,cards:0,description:"모든 것을 재로 돌리는 파괴의 화신.",equippedUltimateId:7},{id:17,name:"세계수 위그드라실",rarity:S.Mythic,attribute:ie.Water,imageUrl:"https://picsum.photos/seed/17/200",level:1,cards:0,description:"생명의 근원, 세계를 품은 거대한 나무 정령.",equippedUltimateId:5}],Be={[S.N]:.5,[S.R]:.34,[S.SR]:.12,[S.SSR]:.03,[S.Mythic]:.01},dt={[fe.R]:.6,[fe.SR]:.3,[fe.SSR]:.08,[fe.Mythic]:.02},Gs={name:"기본 팀",characters:[me[0],me[1],null,null]},We={name:"타락한 거신",imageUrl:"https://picsum.photos/seed/raidboss/400",hp:5e7,maxHp:5e7,reward:25e3},Oe={currency:1e3,characters:[{...me[0],cards:0},{...me[1],cards:0},{...me[2],cards:0}],teams:[Gs],achievements:[{id:1,name:"일일 로그인",description:"오늘 로그인하세요.",progress:1,target:1,reward:"보석 100개"},{id:2,name:"주간 가챠",description:"이번 주에 가챠를 10번 뽑으세요.",progress:3,target:10,reward:"가챠 티켓 1장"},{id:3,name:"불의 힘",description:"불 속성 캐릭터 2명으로 팀을 구성하세요.",progress:1,target:2,reward:"보석 50개",requiredCharacterAttribute:ie.Fire}],friends:[{id:1,name:"AcePlayer",team:{name:"Vanguard",characters:[me[8],me[9],me[10],me[6]]},lastActive:"5분 전",lastRarePull:me[11]},{id:2,name:"ShadowCat",team:{name:"Abyss",characters:[me[4],me[7],me[9],me[5]]},lastActive:"1시간 전"}],ultimateSkills:[{...Le[0]},{...Le[1]}],inventory:[{...Ue[0],id:1,cards:0},{...Ue[1],id:2,cards:0}],guildId:null},Os=({onLogin:t})=>{const[n,s]=m.useState(""),a=r=>{r.preventDefault(),n.trim()&&t(n.trim())};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 text-white p-4",children:e.jsxs("div",{className:"w-full max-w-sm text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-cyan-300 mb-2",children:"가챠 너지"}),e.jsx("p",{className:"text-gray-400 mb-8",children:"새 게임을 시작하거나 기존 데이터를 불러오세요."}),e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsx("input",{type:"text",value:n,onChange:r=>s(r.target.value),placeholder:"사용자 이름을 입력하세요",className:"w-full px-4 py-3 bg-gray-800 border-2 border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500 transition-colors",maxLength:20}),e.jsx("button",{type:"submit",disabled:!n.trim(),className:"w-full p-3 rounded-lg bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold text-lg shadow-lg hover:scale-105 transition-transform disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:"로그인 / 시작하기"})]})]})})},Ds={[S.N]:{border:"border-gray-500",text:"text-gray-300",shadow:"shadow-gray-500/50"},[S.R]:{border:"border-green-500",text:"text-green-400",shadow:"shadow-green-500/50"},[S.SR]:{border:"border-blue-500",text:"text-blue-400",shadow:"shadow-blue-500/50"},[S.SSR]:{border:"border-yellow-400",text:"text-yellow-400",shadow:"shadow-yellow-400/50"},[S.Mythic]:{border:"border-fuchsia-500",text:"text-fuchsia-400",shadow:"shadow-fuchsia-500/50"}},Ae=({character:t,onClick:n,isSelected:s})=>{const a=Ds[t.rarity];return e.jsxs("div",{className:`relative aspect-square rounded-lg overflow-hidden border-2 ${a.border} shadow-lg ${a.shadow} transition-transform hover:scale-105 ${n?"cursor-pointer":""} ${s?"ring-4 ring-cyan-400":""}`,onClick:n,children:[e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"}),e.jsx("div",{className:`absolute top-1 left-1 bg-black/60 px-2 py-0.5 rounded-full text-xs font-bold ${a.text}`,children:t.rarity}),e.jsxs("div",{className:"absolute top-1 right-1 bg-black/60 px-2 py-0.5 rounded-full text-xs font-bold text-white",children:["Lv.",t.level]}),e.jsx("div",{className:"absolute bottom-1 left-0 right-0 px-2 text-center",children:e.jsx("p",{className:"text-white text-xs font-bold truncate drop-shadow-md",children:t.name})})]})},Ps=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.362 5.214A8.252 8.252 0 0 1 12 21 8.25 8.25 0 0 1 6.038 7.047 8.287 8.287 0 0 0 9 9.601a8.983 8.983 0 0 1 3.361-6.867 8.21 8.21 0 0 0 3 2.48Z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18a3.75 3.75 0 0 0 .495-7.468 3.75 3.75 0 0 0-1.993-2.303A3.75 3.75 0 0 0 8.25 6.75a3.75 3.75 0 0 0-1.483 2.805 3.75 3.75 0 0 0-1.993 2.303A3.75 3.75 0 0 0 6 18a3.75 3.75 0 0 0 .495-7.468 3.75 3.75 0 0 0 5.01 0A3.75 3.75 0 0 0 12 18Z"})]}),Ge=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),Bs=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})}),$s=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"})}),Hs=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5"})}),Us=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"})}),Fs=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.042 21.672 13.684 16.6m0 0-2.51 2.225.569-9.47 5.227 7.917-3.286-.672ZM21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Mt=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 21v-7.5a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 .75.75V21m-4.5 0H2.25a.75.75 0 0 1-.75-.75v-12a.75.75 0 0 1 .75-.75h19.5a.75.75 0 0 1 .75.75v12a.75.75 0 0 1-.75.75h-4.5m-4.5 0h-3.75m3.75 0V11.25m5.25 2.25V11.25m0 0V9.75M18.75 11.25v-1.5m-16.5 0a3 3 0 0 1 3-3h10.5a3 3 0 0 1 3 3m-16.5 0c0 1.657 1.343 3 3 3h10.5c1.657 0 3-1.343 3-3m-12.75 0h9"})}),qs=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m-7.5-2.962c.51.056 1.02.086 1.5.086 1.032 0 2.033-.146 3-.418m-9.379-3.323c.345-.184.71-.343 1.086-.483A8.931 8.931 0 0 1 15 4.5c1.43 0 2.793.324 4.024.893m-15.024 4.885A4.5 4.5 0 0 0 7.5 10.5c1.196 0 2.285.42 3.12 1.121m-4.59 2.508A4.492 4.492 0 0 1 7.5 15c2.023 0 3.841.996 5.032 2.572M12 3v18"})}),Vs=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 7.5l3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0021 18V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v12a2.25 2.25 0 002.25 2.25z"})}),Ws=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-4.598m-1.5-6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Z"})}),Ys=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"})}),zs=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})}),mt=({playerState:t,currentUser:n,onLogout:s,onNavigate:a})=>{const r=t.teams[0],i=o=>t.characters.filter(d=>d.attribute===o).length;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("header",{className:"text-center relative",children:[e.jsxs("div",{className:"absolute top-0 right-0 flex items-center space-x-2 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:n}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",title:"로그아웃",children:e.jsx(Us,{className:"w-5 h-5"})})]}),e.jsx("h1",{className:"text-3xl font-bold text-cyan-300",children:"가챠 너지"}),e.jsx("p",{className:"text-gray-400",children:"최고가 되기 위한 여정이 여기서 시작됩니다."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"나의 메인 팀"}),e.jsx("div",{onClick:()=>a("team"),className:"grid grid-cols-4 gap-3 p-4 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition-colors",children:r.characters.map((o,d)=>o?e.jsx(Ae,{character:o},d):e.jsx("div",{className:"aspect-square bg-gray-700 rounded-lg flex items-center justify-center text-gray-500 text-3xl",children:"+"},d))})]}),e.jsx("section",{children:e.jsx("button",{onClick:()=>a("gacha"),className:"w-full p-4 rounded-lg bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold text-lg shadow-lg hover:scale-105 transition-transform duration-300 animate-pulse hover:animate-none",children:"✨ 추천 가챠 등장! ✨"})}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"일일 & 주간 업적"}),e.jsx("div",{className:"space-y-3",children:t.achievements.map(o=>{const d=o.requiredCharacterAttribute&&i(o.requiredCharacterAttribute)<o.target;return e.jsxs("div",{className:`p-3 bg-gray-800 rounded-lg ${d?"border border-dashed border-yellow-500 animate-pulse":""}`,children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[e.jsxs("p",{className:"font-semibold",children:[o.name," ",d&&e.jsxs("span",{className:"text-yellow-400 text-xs",children:[" (",o.requiredCharacterAttribute," 속성 캐릭터 부족!)"]})]}),e.jsxs("p",{className:"text-gray-400",children:[o.progress,"/",o.target]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:"bg-cyan-500 h-2.5 rounded-full",style:{width:`${o.progress/o.target*100}%`}})})]},o.id)})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"친구 활동"}),e.jsx("div",{className:"space-y-4",children:t.friends.map(o=>{var d;return e.jsxs("div",{className:"p-3 bg-gray-800/50 rounded-lg flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex-shrink-0",children:e.jsx("img",{src:(d=o.team.characters[0])==null?void 0:d.imageUrl,alt:o.name,className:"w-full h-full object-cover rounded-full"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"font-bold",children:o.name}),o.lastRarePull&&e.jsxs("p",{className:"text-xs text-yellow-400 truncate",children:["방금 ",e.jsx("span",{className:"font-bold",children:"SSR"})," ",o.lastRarePull.name," 획득!"]}),e.jsxs("p",{className:"text-xs text-gray-400",children:["활동: ",o.lastActive]})]}),e.jsx("button",{onClick:()=>a("social"),className:"bg-indigo-600 px-3 py-1 text-sm rounded-md hover:bg-indigo-500 transition-colors",children:"보기"})]},o.id)})})]})]})};function xt(t){return 10+t*2}function At(t,n){const s=t.level||1;let a=(t.cards||0)+n,r=s;for(;a>=xt(r);)a-=xt(r),r+=1;return{level:r,cards:a}}const Ks=({results:t,onClose:n})=>e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 animate-fade-in",onClick:n,children:e.jsxs("div",{className:"relative w-full max-w-2xl bg-gray-900/80 backdrop-blur-sm rounded-lg border-2 border-yellow-400 shadow-2xl p-6 space-y-4",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{className:"text-3xl font-bold text-center text-yellow-300 drop-shadow-lg",children:"소환 결과"}),e.jsx("div",{className:`grid gap-3 ${t.length>1?"grid-cols-5":"grid-cols-1 place-items-center"}`,children:t.map((s,a)=>e.jsx("div",{className:"animate-reveal",style:{animationDelay:`${a*100}ms`},children:e.jsx(Ae,{character:s})},a))}),e.jsx("button",{onClick:n,className:"w-full mt-4 p-3 rounded-lg bg-cyan-600 text-white font-bold text-lg hover:bg-cyan-500 transition-colors",children:"확인"})]})}),Js=[S.Mythic,S.SSR,S.SR,S.R,S.N],Xs={[S.N]:"text-gray-300",[S.R]:"text-green-400",[S.SR]:"text-blue-400",[S.SSR]:"text-yellow-400",[S.Mythic]:"text-fuchsia-400"},Zs=({onClose:t})=>e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 animate-fade-in",onClick:t,children:e.jsxs("div",{className:"relative w-full max-w-sm bg-gray-800 rounded-lg border border-gray-700 shadow-2xl p-6 space-y-4",onClick:n=>n.stopPropagation(),children:[e.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:e.jsx(Ge,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-2xl font-bold text-center text-cyan-300",children:"소환 확률"}),e.jsx("div",{className:"space-y-2",children:Js.map(n=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-900/50 rounded-md",children:[e.jsx("span",{className:`font-bold ${Xs[n]}`,children:n}),e.jsxs("span",{className:"text-white font-mono",children:[(Be[n]*100).toFixed(2),"%"]})]},n))}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"각 등급 내 캐릭터는 동일한 확률로 등장합니다."})]})}),Ye=30,ze=300,Ke=3e3,Je=5e4,Xe=5e5,Qs=()=>{const t=Math.random();let n=0;const s={};me.forEach(a=>{s[a.rarity]||(s[a.rarity]=[]),s[a.rarity].push(a)});for(const a of Object.keys(Be))if(n+=Be[a],t<n){const r=s[a];if(r&&r.length>0)return{...r[Math.floor(Math.random()*r.length)],id:Date.now()+Math.random(),cards:0}}return{...s[S.N][0],id:Date.now()+Math.random(),cards:0}},ea=({playerState:t,setPlayerState:n})=>{const[s,a]=m.useState(null),[r,i]=m.useState(!1),[o,d]=m.useState(!1),c=(u,g)=>{if(!t||t.currency<g||o)return;d(!0);let h=Array.from({length:u},Qs);if(u===10){if(!h.some(j=>[S.SR,S.SSR,S.Mythic].includes(j.rarity))){const j=me.filter(A=>[S.SR,S.SSR,S.Mythic].includes(A.rarity));if(j.length>0){const A=j[Math.floor(Math.random()*j.length)];h[0]={...A,id:Date.now()+Math.random(),cards:0}}}}else if(u===100){if(!h.some(j=>[S.SSR,S.Mythic].includes(j.rarity))){const j=me.filter(A=>[S.SSR,S.Mythic].includes(A.rarity));if(j.length>0){const A=j[Math.floor(Math.random()*j.length)];h[0]={...A,id:Date.now()+Math.random(),cards:0}}}}else if(u===1e3){if(!h.some(j=>j.rarity===S.Mythic)){const j=me.filter(A=>A.rarity===S.Mythic);if(j.length>0){const A=j[Math.floor(Math.random()*j.length)];h[0]={...A,id:Date.now()+Math.random(),cards:0}}}}else if(u===1e4){const N=me.filter(j=>j.rarity===S.Mythic);if(N.length>0){for(let j=0;j<10;j++){const A=N[Math.floor(Math.random()*N.length)];h[j]={...A,id:Date.now()+Math.random()+j,cards:0}}for(let j=h.length-1;j>0;j--){const A=Math.floor(Math.random()*(j+1));[h[j],h[A]]=[h[A],h[j]]}}}setTimeout(()=>{n(N=>{if(!N)return null;const j=new Map;N.characters.forEach(v=>j.set(v.name,{...v})),h.forEach(v=>{if(j.has(v.name)){const M=j.get(v.name),{level:H,cards:P}=At(M,1);M.level=H,M.cards=P}else j.set(v.name,{...v,level:1,cards:0})});const A=Array.from(j.values());return{...N,currency:N.currency-g,characters:A}}),a(h),d(!1)},1e3)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-cyan-300",children:"소환"}),e.jsx("p",{className:"text-gray-400",children:"새로운 동료를 만나 운명을 개척하세요."})]}),e.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg flex justify-between items-center sticky top-4 z-10",children:[e.jsx("span",{className:"font-semibold text-lg",children:"보유 보석"}),e.jsx("span",{className:"font-bold text-2xl text-yellow-300",children:t==null?void 0:t.currency.toLocaleString()}),e.jsxs("button",{onClick:()=>i(!0),className:"text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:[e.jsx(Fs,{className:"w-4 h-4"}),"소환 확률"]})]}),e.jsxs("div",{className:"relative aspect-video w-full max-w-lg mx-auto flex items-center justify-center rounded-lg overflow-hidden bg-black",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-purple-900/50 via-black to-indigo-900/50 opacity-70"}),e.jsx("div",{className:"absolute w-full h-full animate-spin-slow",style:{background:"radial-gradient(circle, rgba(167, 139, 250, 0.3) 10%, transparent 70%)"}}),e.jsx("p",{className:"text-2xl font-bold text-white z-10 drop-shadow-lg",children:"소환진"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>c(1,Ye),disabled:!t||t.currency<Ye||o,className:"w-full p-3 rounded-lg bg-gradient-to-r from-gray-600 to-gray-700 text-white font-bold shadow-lg hover:from-gray-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("p",{className:"text-lg",children:"1회 소환"}),e.jsxs("p",{className:"text-sm font-normal",children:["보석 ",Ye]})]}),e.jsxs("button",{onClick:()=>c(10,ze),disabled:!t||t.currency<ze||o,className:"w-full p-3 rounded-lg bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold shadow-lg hover:from-purple-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("p",{className:"text-lg",children:"10회 소환"}),e.jsxs("p",{className:"text-sm font-normal",children:["보석 ",ze]})]}),e.jsxs("button",{onClick:()=>c(100,Ke),disabled:!t||t.currency<Ke||o,className:"col-span-2 w-full p-3 rounded-lg bg-gradient-to-r from-cyan-600 to-blue-600 text-white font-bold shadow-lg hover:from-cyan-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("p",{className:"text-lg",children:"100회 소환 (SSR+ 1명 확정)"}),e.jsxs("p",{className:"text-sm font-normal",children:["보석 ",Ke]})]}),e.jsxs("button",{onClick:()=>c(1e3,Je),disabled:!t||t.currency<Je||o,className:"col-span-2 w-full p-3 rounded-lg bg-gradient-to-r from-yellow-500 to-red-500 text-white font-bold shadow-lg hover:from-yellow-400 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("p",{className:"text-lg",children:"1000회 소환 (신화 1명 확정)"}),e.jsxs("p",{className:"text-sm font-normal",children:["보석 ",Je]})]}),e.jsxs("button",{onClick:()=>c(1e4,Xe),disabled:!t||t.currency<Xe||o,className:"col-span-2 w-full p-3 rounded-lg bg-gradient-to-r from-fuchsia-600 to-yellow-500 text-white font-bold shadow-lg hover:from-fuchsia-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("p",{className:"text-lg",children:"10000회 소환 (신화 10명 확정)"}),e.jsxs("p",{className:"text-sm font-normal",children:["보석 ",Xe.toLocaleString()]})]})]}),s&&e.jsx(Ks,{results:s,onClose:()=>a(null)}),r&&e.jsx(Zs,{onClose:()=>i(!1)})]})};function It(t){if(!t)return{attack:0,hp:0,speed:0};const n=1+t.level*.05,s=1+t.cards*.01,a=n*s,r=Math.round(t.baseStats.attack*a),i=Math.round(t.baseStats.hp*a),o=Math.round(t.baseStats.speed*a);return{attack:r,hp:i,speed:o}}function rt(t,n){const a={[S.N]:1,[S.R]:1.15,[S.SR]:1.35,[S.SSR]:1.6,[S.Mythic]:2}[t.rarity]??1,r=Math.round((t.level*4+10)*a),i=Math.round((t.level*20+100)*a),o=Math.round(10+t.level*.4+(t.level>50?2:0));let d={attack:0,hp:0,speed:0};return n&&(d=It(n)),{attack:r+d.attack,hp:i+d.hp,speed:Math.max(1,o+d.speed)}}const ta={[S.N]:{border:"border-gray-500",text:"text-gray-300",bg:"bg-gray-700"},[S.R]:{border:"border-green-500",text:"text-green-400",bg:"bg-green-600"},[S.SR]:{border:"border-blue-500",text:"text-blue-400",bg:"bg-blue-600"},[S.SSR]:{border:"border-yellow-400",text:"text-yellow-400",bg:"bg-yellow-500"},[S.Mythic]:{border:"border-fuchsia-500",text:"text-fuchsia-400",bg:"bg-fuchsia-600"}},sa={[ie.Fire]:"text-red-400",[ie.Water]:"text-blue-400",[ie.Wind]:"text-green-400",[ie.Light]:"text-yellow-300",[ie.Dark]:"text-purple-400"},Ze=({label:t,value:n})=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 p-2 rounded-md text-sm",children:[e.jsx("span",{className:"text-gray-400",children:t}),e.jsx("span",{className:"font-bold text-white",children:n})]}),aa=({character:t,equippedUltimate:n,equippedEquipment:s,isCharacterInTeam:a,onAddToTeam:r,onRemoveFromTeam:i,onChangeUltimate:o,onChangeEquipment:d,onClose:c})=>{const u=rt(t,s),g=ta[t.rarity],h=sa[t.attribute],N=Math.floor((t.level-1)/10)+1;return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 animate-fade-in",onClick:c,children:e.jsxs("div",{className:`relative w-full max-w-sm bg-gray-800 rounded-lg border-2 ${g.border} shadow-2xl p-6 space-y-4 max-h-[90vh] overflow-y-auto`,onClick:j=>j.stopPropagation(),children:[e.jsx("button",{onClick:c,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:e.jsx(Ge,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-24 h-24 rounded-lg overflow-hidden border-2 ${g.border} flex-shrink-0`,children:e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-lg font-bold ${g.text}`,children:t.rarity}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:t.name}),e.jsxs("p",{className:"text-sm font-semibold",children:["Level ",t.level," ",e.jsxs("span",{className:h,children:[t.attribute," 속성"]})]})]})]}),e.jsxs("p",{className:"text-gray-300 text-sm italic",children:['"',t.description,'"']}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-cyan-400",children:"레벨업 진행도"}),e.jsxs("div",{className:"w-full bg-gray-700 rounded-full h-4 relative overflow-hidden",children:[e.jsx("div",{className:"bg-yellow-400 h-4 rounded-full transition-all duration-500",style:{width:`${t.cards/N*100}%`}}),e.jsxs("span",{className:"absolute inset-0 text-center text-xs font-bold text-black flex items-center justify-center",children:[t.cards," / ",N]})]}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-1",children:"다음 레벨까지 필요한 카드"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-cyan-400",children:"능력치 (장비 포함)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ze,{label:"HP",value:u.hp}),e.jsx(Ze,{label:"공격력",value:u.attack}),e.jsx(Ze,{label:"속도",value:u.speed})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-md",children:[e.jsx("h3",{className:"text-sm font-semibold mb-2 text-purple-400",children:"궁극기"}),n?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold text-white text-sm",children:n.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Lv.",n.level]})]}):e.jsx("p",{className:"text-gray-400 text-xs",children:"없음"}),e.jsx("button",{onClick:o,className:"w-full mt-2 p-1 rounded-md text-xs bg-gray-700 hover:bg-gray-600 transition-colors",children:"변경"})]}),e.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-md",children:[e.jsx("h3",{className:"text-sm font-semibold mb-2 text-green-400",children:"장비"}),s?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold text-white text-sm",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Lv.",s.level," ",s.rarity]}),e.jsx("p",{className:"text-[10px] text-cyan-300 mt-1",children:s.specialEffect})]}):e.jsx("p",{className:"text-gray-400 text-xs",children:"없음"}),e.jsx("button",{onClick:d,className:"w-full mt-2 p-1 rounded-md text-xs bg-gray-700 hover:bg-gray-600 transition-colors",children:"변경"})]})]}),a?e.jsx("button",{onClick:i,className:"w-full p-2 rounded-lg bg-red-600 text-white font-semibold hover:bg-red-500 transition-colors",children:"팀에서 제거"}):e.jsx("button",{onClick:r,className:"w-full p-2 rounded-lg bg-cyan-600 text-white font-semibold hover:bg-cyan-500 transition-colors",children:"팀에 추가"})]})})},ra=async t=>{try{const n=new _e({apiKey:"AIzaSyD24laq21PKbAI-8TvBOlvM-FP6kV-NmY4"}),a=`
      당신은 뛰어난 RPG 전략가입니다. 아래의 보유 캐릭터 목록을 보고, 균형 잡히고 강력한 4인 팀을 추천해 주세요.
      선택된 캐릭터들 간의 전략과 시너지에 대해 설명해 주세요. 응답은 마크다운 형식으로 작성해 주세요.

      보유 캐릭터 목록:
      ${t.map(i=>`- ${i.name} (${i.rarity}, ${i.attribute})`).join(`
`)}
    `;return(await n.models.generateContent({model:"gemini-2.5-flash",contents:a})).text}catch(n){return console.error("Error calling Gemini API:",n),"죄송합니다, 지금은 조언을 받을 수 없습니다. 잠시 후 다시 시도해 주세요."}},ht={[fe.R]:{border:"border-green-500",text:"text-green-400"},[fe.SR]:{border:"border-blue-500",text:"text-blue-400"},[fe.SSR]:{border:"border-yellow-400",text:"text-yellow-400"},[fe.Mythic]:{border:"border-fuchsia-500",text:"text-fuchsia-400"}},na=({ownedUltimates:t,onSelect:n,onClose:s})=>{const a=r=>{const i=(r.level-1)*.25+1,o=(r.power*i).toFixed(1);switch(r.effectType){case be.SINGLE_TARGET_DAMAGE:case be.AREA_OF_EFFECT_DAMAGE:return`공격력의 ${o}배 피해`;case be.HEAL_SELF:case be.HEAL_TEAM:return`기본 회복량 ${(r.power*i).toFixed(0)}`;default:return""}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 animate-fade-in",onClick:s,children:e.jsxs("div",{className:"relative w-full max-w-lg bg-gray-800 rounded-lg border border-gray-700 shadow-2xl p-6",onClick:r=>r.stopPropagation(),children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:e.jsx(Ge,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-2xl font-bold text-center text-cyan-300 mb-4",children:"궁극기 선택"}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto space-y-3 pr-2",children:t.map(r=>e.jsxs("div",{onClick:()=>n(r.id),className:`p-3 bg-gray-900/50 rounded-lg border-2 ${ht[r.rarity].border} cursor-pointer hover:bg-gray-700 transition-colors`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:`font-bold text-lg ${ht[r.rarity].text}`,children:r.name}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:["Lv.",r.level]})]}),e.jsx("p",{className:"text-sm text-yellow-300 font-semibold",children:a(r)}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:r.description})]},r.id))})]})})},ut={[S.N]:{border:"border-gray-500",text:"text-gray-300"},[S.R]:{border:"border-green-500",text:"text-green-400"},[S.SR]:{border:"border-blue-500",text:"text-blue-400"},[S.SSR]:{border:"border-yellow-400",text:"text-yellow-400"},[S.Mythic]:{border:"border-fuchsia-500",text:"text-fuchsia-400"}},la=({inventory:t,onSelect:n,onClose:s})=>e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 animate-fade-in",onClick:s,children:e.jsxs("div",{className:"relative w-full max-w-lg bg-gray-800 rounded-lg border border-gray-700 shadow-2xl p-6",onClick:a=>a.stopPropagation(),children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:e.jsx(Ge,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-2xl font-bold text-center text-cyan-300 mb-4",children:"장비 선택"}),t.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"장비가 없습니다. 상점에서 획득하세요."}):e.jsx("div",{className:"max-h-[60vh] overflow-y-auto space-y-3 pr-2",children:t.map(a=>{const r=It(a);return e.jsxs("div",{onClick:()=>n(a.id),className:`p-3 bg-gray-900/50 rounded-lg border-2 ${ut[a.rarity].border} cursor-pointer hover:bg-gray-700 transition-colors`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`font-bold text-lg ${ut[a.rarity].text}`,children:a.name}),e.jsxs("p",{className:"text-sm font-semibold text-white",children:["Lv.",a.level," ",e.jsxs("span",{className:"text-xs text-gray-400",children:["(",a.cards," 강화)"]})]})]}),e.jsxs("div",{className:"text-right text-xs text-gray-300",children:[r.attack>0&&e.jsxs("p",{children:["공격 +",r.attack.toLocaleString()]}),r.hp>0&&e.jsxs("p",{children:["체력 +",r.hp.toLocaleString()]}),r.speed>0&&e.jsxs("p",{children:["속도 +",r.speed.toLocaleString()]})]})]}),e.jsx("p",{className:"text-xs text-cyan-400 mt-1 font-bold",children:a.specialEffect}),e.jsx("p",{className:"text-xs text-gray-500",children:a.description})]},a.id)})})]})}),ia=({playerState:t,setPlayerState:n,onEquipUltimate:s,onEquipEquipment:a})=>{const[r,i]=m.useState(null),[o,d]=m.useState(!1),[c,u]=m.useState(!1),[g,h]=m.useState(""),[N,j]=m.useState(!1),A=t.teams[0],v=new Set(A.characters.filter(Boolean).map(f=>f.id)),M=new Map(Le.map(f=>[f.id,f])),H=new Map(t.ultimateSkills.map(f=>[f.id,f])),P=f=>H.get(f)||M.get(f),I=f=>f?t.inventory.find(T=>T.id===f):void 0,k=f=>{i(f)},p=()=>{i(null),d(!1),u(!1)},E=f=>{const T=A.characters.findIndex(B=>B===null);if(T!==-1&&!v.has(f.id)){const B=[...A.characters];B[T]=f,n(F=>F?{...F,teams:[{...F.teams[0],characters:B}]}:null)}p()},_=f=>{const T=A.characters.map(B=>B&&B.id===f?null:B);n(B=>B?{...B,teams:[{...B.teams[0],characters:T}]}:null),p()},O=async()=>{j(!0),h("");const f=await ra(t.characters);h(f),j(!1)},D=f=>{r&&s(r.id,f),d(!1),i(null)},y=f=>{r&&a(r.id,f),u(!1),i(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-cyan-300",children:"캐릭터 관리"}),e.jsx("p",{className:"text-gray-400",children:"보유 캐릭터를 확인하고 최강의 팀을 구성하세요."})]}),e.jsxs("section",{className:"p-4 bg-gray-800 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"메인 팀"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:A.characters.map((f,T)=>e.jsx("div",{className:"relative",children:f?e.jsx(Ae,{character:f,onClick:()=>k(f)}):e.jsx("div",{className:"aspect-square w-full h-full bg-gray-700/50 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center text-gray-500 text-4xl",children:"+"})},T))})]}),e.jsxs("section",{children:[e.jsxs("button",{onClick:O,disabled:N,className:"w-full p-3 rounded-lg bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold text-lg shadow-lg hover:scale-105 transition-transform disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(Vs,{className:"w-6 h-6"}),N?"분석 중...":"AI 팀 조합 추천받기"]}),g&&e.jsx("div",{className:"prose prose-invert mt-4 p-4 bg-gray-800/50 rounded-lg max-w-none",dangerouslySetInnerHTML:{__html:g.replace(/\n/g,"<br />")}})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"보유 캐릭터 목록"}),e.jsx("div",{className:"grid grid-cols-4 md:grid-cols-5 gap-3",children:t.characters.map(f=>e.jsx(Ae,{character:f,onClick:()=>k(f)},f.id))})]}),r&&!o&&!c&&e.jsx(aa,{character:r,equippedUltimate:P(r.equippedUltimateId),equippedEquipment:I(r.equippedEquipmentId),isCharacterInTeam:v.has(r.id),onAddToTeam:()=>E(r),onRemoveFromTeam:()=>_(r.id),onChangeUltimate:()=>d(!0),onChangeEquipment:()=>u(!0),onClose:p}),o&&r&&e.jsx(na,{ownedUltimates:t.ultimateSkills,onSelect:D,onClose:()=>d(!1)}),c&&r&&e.jsx(la,{inventory:t.inventory,onSelect:y,onClose:()=>u(!1)})]})},oa={very_easy:{count:1,rarities:[S.N],levelRange:[1,3]},easy:{count:2,rarities:[S.N,S.R],levelRange:[3,8]},normal:{count:3,rarities:[S.R,S.SR],levelRange:[10,15]},hard:{count:4,rarities:[S.SR,S.SSR],levelRange:[20,25]},very_hard:{count:4,rarities:[S.SR,S.SSR],levelRange:[30,40]},hell:{count:4,rarities:[S.SSR,S.Mythic],levelRange:[45,55]},hardcore:{count:4,rarities:[S.Mythic],levelRange:[60,70]},boss:{count:1,rarities:[S.Mythic],levelRange:[100,100]}};let ca=-1;const da=t=>{const n=oa[t],s=[],a=me.filter(r=>n.rarities.includes(r.rarity));if(a.length===0){console.error(`No characters available for rarities: ${n.rarities.join(", ")}`);const r=me.filter(i=>i.rarity===S.N);if(r.length>0)a.push(...r);else return[]}for(let r=0;r<n.count;r++){const i=a[Math.floor(Math.random()*a.length)],o=Math.floor(Math.random()*(n.levelRange[1]-n.levelRange[0]+1))+n.levelRange[0],d={...i,id:ca--,level:o,name:`${i.name} (적)`};s.push(d)}return s},Qe={very_easy:{label:"매우 쉬움",color:"bg-teal-700 hover:bg-teal-600"},easy:{label:"쉬움",color:"bg-green-600 hover:bg-green-500"},normal:{label:"보통",color:"bg-yellow-600 hover:bg-yellow-500"},hard:{label:"어려움",color:"bg-orange-600 hover:bg-orange-500"},very_hard:{label:"매우 어려움",color:"bg-red-600 hover:bg-red-500"},hell:{label:"지옥",color:"bg-purple-700 hover:bg-purple-600"},hardcore:{label:"하드코어",color:"bg-gray-700 hover:bg-gray-600"},boss:{label:"보스",color:"bg-black border border-red-500 hover:bg-gray-900"}},ma=({playerState:t,onStartCombat:n})=>{var d;const s=(d=t.teams[0])==null?void 0:d.characters.filter(c=>c!==null),[a,r]=m.useState("normal"),[i,o]=m.useState([]);return m.useEffect(()=>{o(da(a))},[a]),e.jsxs("div",{className:"space-y-6 text-center",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-3xl font-bold text-cyan-300",children:"전투 준비"}),e.jsx("p",{className:"text-gray-400",children:"도전할 난이도를 선택하세요."})]}),e.jsxs("div",{className:"p-3 bg-gray-800/50 rounded-lg",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"난이도 선택"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:Object.keys(Qe).map(c=>e.jsx("button",{onClick:()=>r(c),className:`px-3 py-2 rounded-md font-bold transition-all text-sm ${a===c?`${Qe[c].color} text-white ring-2 ring-white shadow-lg`:"bg-gray-700 text-gray-400 hover:bg-gray-600"}`,children:Qe[c].label},c))})]}),e.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-red-400",children:"적 팀 (미리보기)"}),i.length>0?e.jsx("div",{className:"flex justify-center gap-4",children:i.map((c,u)=>e.jsx("div",{className:"w-24",children:e.jsx(Ae,{character:c})},u))}):e.jsx("p",{className:"text-gray-500",children:"난이도를 선택하여 적을 생성하세요."})]}),e.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-green-400",children:"나의 팀"}),e.jsx("div",{className:"flex justify-center gap-4",children:s.map((c,u)=>e.jsx("div",{className:"w-24",children:e.jsx(Ae,{character:c})},u))})]}),e.jsx("button",{onClick:()=>n(i,a),disabled:s.length===0||i.length===0,className:"w-full p-4 rounded-lg bg-gradient-to-r from-red-600 to-orange-600 text-white font-bold text-lg shadow-lg hover:scale-105 transition-transform disabled:opacity-50 disabled:cursor-not-allowed",children:"전투 시작!"})]})},xa=({friends:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-cyan-300",children:"커뮤니티"}),e.jsx("p",{className:"text-gray-400",children:"친구 및 라이벌과 교류하세요."})]}),e.jsxs("section",{className:"p-4 bg-gradient-to-br from-green-900 to-teal-900 rounded-lg border-2 border-green-500 shadow-lg text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-green-300",children:"협동 레이드 가능!"}),e.jsx("p",{className:"text-sm text-gray-200 mt-1 mb-3",children:"친구와 팀을 이루어 월드 보스를 물리치고 두 배의 보상을 획득하세요!"}),e.jsx("button",{className:"px-6 py-2 rounded-lg bg-green-600 text-white font-bold hover:bg-green-500 transition-colors",children:"파티 찾기"})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"친구 목록"}),e.jsx("div",{className:"space-y-4",children:t.map(n=>e.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold",children:n.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:["활동: ",n.lastActive]})]}),n.lastRarePull&&e.jsxs("div",{className:"text-right text-xs bg-yellow-900/50 border border-yellow-600 p-2 rounded-md",children:[e.jsx("p",{className:"text-yellow-300",children:"최근 획득:"}),e.jsxs("p",{className:"font-semibold",children:[n.lastRarePull.rarity," ",n.lastRarePull.name]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-semibold mb-2",children:[n.name,"의 팀"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:n.team.characters.map((s,a)=>s?e.jsx(Ae,{character:s},a):e.jsx("div",{className:"aspect-square bg-gray-700 rounded-lg"},a))})]})]},n.id))})]})]}),ha=({pack:t,onConfirm:n,onClose:s})=>{const[a,r]=m.useState("idle"),i=()=>{r("processing"),setTimeout(()=>{r("success"),setTimeout(()=>{n()},1e3)},1500)};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 animate-fade-in",onClick:s,children:e.jsxs("div",{className:"relative w-full max-w-md bg-gray-800 rounded-lg border border-gray-700 shadow-2xl p-6 space-y-4",onClick:o=>o.stopPropagation(),children:[a==="idle"&&e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:e.jsx(Ge,{className:"w-6 h-6"})}),e.jsxs("div",{className:"text-center",children:[e.jsx(Bs,{className:"w-12 h-12 mx-auto text-cyan-400 mb-2"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"구매 확인"})]}),a==="idle"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"상품"}),e.jsxs("span",{className:"font-semibold text-white",children:[t.name," (",t.amount.toLocaleString()," 보석)"]})]}),e.jsxs("div",{className:"flex justify-between items-center text-lg",children:[e.jsx("span",{className:"text-gray-400",children:"총 결제 금액"}),e.jsx("span",{className:"font-bold text-cyan-300",children:t.price})]})]}),e.jsx("div",{className:"text-center p-3 bg-yellow-900/50 border border-yellow-700 rounded-md",children:e.jsxs("p",{className:"text-xs text-yellow-300",children:["이것은 시뮬레이션입니다.",e.jsx("br",{}),"실제 결제가 이루어지지 않으며, 정보를 입력할 필요가 없습니다."]})}),e.jsx("button",{onClick:i,className:"w-full mt-4 p-3 rounded-lg bg-cyan-600 text-white font-bold text-lg hover:bg-cyan-500 transition-colors",children:"결제 확정"})]}),a==="processing"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-t-cyan-400 border-gray-600 rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:"결제 처리 중..."})]}),a==="success"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-green-400 font-bold text-xl",children:"구매 성공!"}),e.jsxs("p",{className:"text-gray-300",children:[t.amount.toLocaleString(),"개의 보석이 지급되었습니다."]})]})]})})},ua=({onConfirm:t,onClose:n})=>{const[s,a]=m.useState(""),[r,i]=m.useState(""),o=d=>{d.preventDefault(),t(s)||(i("비밀번호가 틀렸습니다."),a(""))};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 animate-fade-in",onClick:n,children:e.jsxs("div",{className:"relative w-full max-w-sm bg-gray-800 rounded-lg border border-gray-700 shadow-2xl p-6 space-y-4",onClick:d=>d.stopPropagation(),children:[e.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:e.jsx(Ge,{className:"w-6 h-6"})}),e.jsxs("div",{className:"text-center",children:[e.jsx(zs,{className:"w-12 h-12 mx-auto text-cyan-400 mb-2"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"비밀번호 확인"}),e.jsx("p",{className:"text-sm text-gray-400",children:"구매를 계속하려면 비밀번호를 입력하세요."})]}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsx("input",{type:"password",value:s,onChange:d=>{a(d.target.value),i("")},placeholder:"비밀번호",className:`w-full px-4 py-3 bg-gray-700 border-2 rounded-lg text-white placeholder-gray-500 focus:outline-none transition-colors ${r?"border-red-500":"border-gray-600 focus:border-cyan-500"}`,autoFocus:!0}),r&&e.jsx("p",{className:"text-red-400 text-sm text-center",children:r}),e.jsx("button",{type:"submit",disabled:!s,className:"w-full p-3 rounded-lg bg-cyan-600 text-white font-bold text-lg hover:bg-cyan-500 transition-colors disabled:opacity-50",children:"확인"})]})]})})},pa=[{name:"스타터 팩",amount:500,price:"₩1,200",color:"from-green-500 to-teal-500"},{name:"가성비 팩",amount:1200,price:"₩2,500",color:"from-blue-500 to-cyan-500"},{name:"프로 팩",amount:3e3,price:"₩5,900",color:"from-purple-500 to-indigo-500"},{name:"고래 팩",amount:1e4,price:"₩15,000",color:"from-yellow-500 to-orange-500"},{name:"지배자 팩",amount:5e4,price:"₩55,000",color:"from-red-500 to-rose-500"},{name:"신들의 축복",amount:1e7,price:"₩119,000",color:"from-fuchsia-600 via-purple-600 to-indigo-700",bestValue:!0}],fa=()=>{const t=Math.random();let n=0;const s={};Le.forEach(a=>{s[a.rarity]||(s[a.rarity]=[]),s[a.rarity].push(a)});for(const a of Object.keys(dt))if(n+=dt[a],t<n){const r=s[a];if(r&&r.length>0)return{...r[Math.floor(Math.random()*r.length)]}}return{...s[fe.R][0]}},pt=()=>{const t=Math.random();let n=0;const s={};Ue.forEach(a=>{s[a.rarity]||(s[a.rarity]=[]),s[a.rarity].push(a)});for(const a of Object.keys(Be))if(n+=Be[a],t<n){const r=s[a];if(r&&r.length>0)return{...r[Math.floor(Math.random()*r.length)],cards:0}}return{...s[S.N][0],cards:0}},ga=({playerState:t,setPlayerState:n})=>{const[s,a]=m.useState(null),[r,i]=m.useState(null),[o,d]=m.useState(!1),[c,u]=m.useState(null),[g,h]=m.useState(null),N=150,j=100,A=1e6,v=p=>{i(p),d(!0)},M=p=>p.trim()==="12121212"?(d(!1),a(r),i(null),!0):!1,H=p=>{n(E=>E?{...E,currency:E.currency+p}:null),a(null)},P=p=>{const E=N*p;if(!t||t.currency<E)return;const _=Array.from({length:p},fa);n(O=>{if(!O)return null;const D=new Map;return O.ultimateSkills.forEach(y=>D.set(y.id,{...y})),_.forEach(y=>{if(D.has(y.id)){const f=D.get(y.id);f.level+=1}else D.set(y.id,{...y,level:1})}),{...O,currency:O.currency-E,ultimateSkills:Array.from(D.values())}}),u(_)},I=p=>{let E=j*p;if(p===1e4&&(E=A),!t||t.currency<E)return;let _=[];if(p===1e4){const O=Ue.filter(D=>D.rarity===S.Mythic);if(O.length>0)for(let D=0;D<10;D++){const y=O[Math.floor(Math.random()*O.length)];_.push({...y,cards:0})}for(let D=_.length;D<p;D++)_.push(pt());for(let D=_.length-1;D>0;D--){const y=Math.floor(Math.random()*(D+1));[_[D],_[y]]=[_[y],_[D]]}}else _=Array.from({length:p},pt);n(O=>{if(!O)return null;const D=new Map;return O.inventory.forEach(y=>D.set(y.id,{...y})),_.forEach(y=>{if(D.has(y.id)){const f=D.get(y.id),{level:T,cards:B}=At(f,1);f.level=T,f.cards=B}else D.set(y.id,{...y,level:1,cards:0})}),{...O,currency:O.currency-E,inventory:Array.from(D.values())}}),h(_)},k=()=>g?[...g].sort((E,_)=>{const O={[S.Mythic]:5,[S.SSR]:4,[S.SR]:3,[S.R]:2,[S.N]:1};return(O[_.rarity]||0)-(O[E.rarity]||0)}).slice(0,60):[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-cyan-300",children:"상점"}),e.jsx("p",{className:"text-gray-400",children:"보석을 구매하여 모험을 계속하세요."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("section",{className:"p-4 bg-gray-800/50 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3 text-purple-400",children:"궁극기 뽑기"}),e.jsxs("div",{className:"flex justify-around items-center gap-2",children:[e.jsxs("button",{onClick:()=>P(1),disabled:!t||t.currency<N,className:"flex-1 px-4 py-2 rounded-lg bg-purple-600 text-white font-bold hover:bg-purple-500 transition-colors disabled:opacity-50 text-sm",children:["1회 (",N,")"]}),e.jsxs("button",{onClick:()=>P(10),disabled:!t||t.currency<N*10,className:"flex-1 px-4 py-2 rounded-lg bg-indigo-600 text-white font-bold hover:bg-indigo-500 transition-colors disabled:opacity-50 text-sm",children:["10회 (",N*10,")"]})]})]}),e.jsxs("section",{className:"p-4 bg-gray-800/50 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3 text-green-400",children:"장비 뽑기"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>I(1),disabled:!t||t.currency<j,className:"px-4 py-2 rounded-lg bg-green-600 text-white font-bold hover:bg-green-500 transition-colors disabled:opacity-50 text-sm",children:["1회 (",j,")"]}),e.jsxs("button",{onClick:()=>I(10),disabled:!t||t.currency<j*10,className:"px-4 py-2 rounded-lg bg-teal-600 text-white font-bold hover:bg-teal-500 transition-colors disabled:opacity-50 text-sm",children:["10회 (",j*10,")"]}),e.jsx("button",{onClick:()=>I(1e4),disabled:!t||t.currency<A,className:"col-span-2 px-4 py-2 rounded-lg bg-gradient-to-r from-emerald-600 to-green-700 text-white font-bold hover:from-emerald-500 transition-colors disabled:opacity-50 text-sm border border-green-400",children:"10000회 (신화 10개 확정)"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"보석 팩"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:pa.map(p=>e.jsxs("div",{className:`relative p-4 rounded-lg bg-gradient-to-br ${p.color} text-white shadow-lg text-center flex flex-col justify-between`,children:[p.bestValue&&e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-yellow-400 text-black px-3 py-1 rounded-full text-xs font-bold shadow-lg",children:"BEST VALUE"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:p.name}),e.jsxs("p",{className:"text-2xl font-extrabold my-2",children:[p.amount.toLocaleString()," 보석"]}),e.jsx("p",{className:"text-sm font-semibold",children:p.price})]}),e.jsxs("button",{onClick:()=>v(p),className:"mt-3 w-full p-2 rounded-md bg-white/20 font-semibold hover:bg-white/30 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Mt,{className:"w-5 h-5"})," 구매"]})]},p.amount))})]}),o&&e.jsx(ua,{onConfirm:M,onClose:()=>d(!1)}),s&&e.jsx(ha,{pack:s,onConfirm:()=>H(s.amount),onClose:()=>a(null)}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>u(null),children:e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg max-w-lg w-full",onClick:p=>p.stopPropagation(),children:[e.jsx("h2",{className:"text-2xl text-center font-bold mb-4 text-purple-300",children:"궁극기 획득!"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:c.map((p,E)=>e.jsxs("div",{className:"bg-gray-900 p-2 rounded border border-gray-700",children:[e.jsx("p",{className:"font-bold text-sm",children:p.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[p.rarity," 등급"]})]},E))}),e.jsx("button",{onClick:()=>u(null),className:"w-full mt-4 p-2 bg-cyan-600 rounded",children:"확인"})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>h(null),children:e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg max-w-lg w-full max-h-[80vh] overflow-y-auto",onClick:p=>p.stopPropagation(),children:[e.jsx("h2",{className:"text-2xl text-center font-bold mb-4 text-green-300",children:"장비 획득!"}),e.jsxs("div",{className:"text-center text-gray-400 mb-2",children:[g.length,"개의 장비를 획득했습니다."]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:k().map((p,E)=>e.jsxs("div",{className:`bg-gray-900 p-2 rounded border ${p.rarity===S.Mythic?"border-fuchsia-500":p.rarity===S.SSR?"border-yellow-400":"border-gray-700"}`,children:[e.jsx("p",{className:"font-bold text-sm truncate",children:p.name}),e.jsx("p",{className:`text-xs ${p.rarity===S.Mythic?"text-fuchsia-400":p.rarity===S.SSR?"text-yellow-400":"text-gray-400"}`,children:p.rarity})]},E))}),g.length>60&&e.jsxs("p",{className:"text-center text-gray-500 mt-2 italic",children:["...및 기타 ",g.length-60,"개 아이템 (인벤토리로 지급됨)"]}),e.jsx("button",{onClick:()=>h(null),className:"w-full mt-4 p-2 bg-cyan-600 rounded",children:"확인"})]})})]})},ba=({guilds:t,onCreateGuild:n,onJoinGuild:s})=>{const[a,r]=m.useState(""),i=o=>{o.preventDefault(),a.trim()&&(n(a.trim()),r(""))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-cyan-300",children:"길드 찾기"}),e.jsx("p",{className:"text-gray-400",children:"동료들과 함께하기 위한 여정을 시작하세요."})]}),e.jsxs("section",{className:"p-4 bg-gray-800/50 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"길드 생성"}),e.jsxs("form",{onSubmit:i,className:"flex gap-2",children:[e.jsx("input",{type:"text",value:a,onChange:o=>r(o.target.value),placeholder:"새 길드 이름",className:"flex-grow px-3 py-2 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:border-cyan-500",maxLength:20}),e.jsx("button",{type:"submit",disabled:!a.trim(),className:"px-4 py-2 bg-indigo-600 font-semibold rounded-md hover:bg-indigo-500 disabled:opacity-50",children:"생성"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"길드 목록"}),e.jsx("div",{className:"space-y-3 max-h-[50vh] overflow-y-auto pr-2",children:t.length>0?t.map(o=>e.jsxs("div",{className:"p-3 bg-gray-800 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:o.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:["길드장: ",o.creator," | 멤버: ",o.members.length,"명"]})]}),e.jsx("button",{onClick:()=>s(o.id),className:"px-4 py-2 bg-cyan-600 font-semibold rounded-md hover:bg-cyan-500",children:"가입"})]},o.id)):e.jsx("p",{className:"text-center text-gray-500",children:"생성된 길드가 없습니다. 첫 길드를 만들어 보세요!"})})]})]})},ya=({guild:t,currentUser:n,playerState:s,onLeaveGuild:a,onSendMessage:r,onAttackRaid:i})=>{const[o,d]=m.useState(""),c=m.useRef(null);m.useEffect(()=>{var h;(h=c.current)==null||h.scrollIntoView({behavior:"smooth"})},[t.chat]);const u=h=>{h.preventDefault(),o.trim()&&(r(o.trim()),d(""))},g=t.raidBoss.hp/t.raidBoss.maxHp*100;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"text-center relative",children:[e.jsx("h1",{className:"text-3xl font-bold text-cyan-300",children:t.name}),e.jsxs("p",{className:"text-gray-400",children:["길드장: ",t.creator]}),e.jsx("button",{onClick:a,className:"absolute top-0 right-0 text-sm bg-red-600 px-3 py-1 rounded-md hover:bg-red-500",children:"길드 탈퇴"})]}),e.jsxs("section",{className:"p-4 bg-gray-800/50 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3 text-center text-red-400",children:"길드 레이드"}),e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:t.raidBoss.imageUrl,alt:t.raidBoss.name,className:"w-48 h-48 mx-auto rounded-lg object-cover border-4 border-red-800"}),e.jsx("h3",{className:"text-2xl font-bold mt-2",children:t.raidBoss.name}),e.jsxs("p",{className:"text-sm text-gray-400",children:["최근 공격자: ",t.raidBoss.lastAttackedBy||"없음"]}),e.jsxs("div",{className:"w-full bg-gray-700 rounded-full h-6 mt-4 relative overflow-hidden border-2 border-black/50",children:[e.jsx("div",{className:"bg-red-600 h-full transition-all duration-500",style:{width:`${g}%`}}),e.jsxs("span",{className:"absolute inset-0 text-center text-sm font-bold text-white flex items-center justify-center",children:[t.raidBoss.hp.toLocaleString()," / ",t.raidBoss.maxHp.toLocaleString()]})]}),e.jsx("button",{onClick:i,disabled:t.raidBoss.hp<=0,className:"mt-4 px-8 py-3 rounded-lg bg-gradient-to-r from-red-600 to-orange-500 text-white font-bold text-lg shadow-lg hover:scale-105 transition-transform disabled:opacity-50 disabled:cursor-not-allowed",children:t.raidBoss.hp>0?"공격!":"보스 처치 완료"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 p-4 bg-gray-800/50 rounded-lg flex flex-col",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"길드 채팅"}),e.jsxs("div",{className:"flex-grow bg-gray-900/50 p-2 rounded-md h-64 overflow-y-auto",children:[t.chat.map((h,N)=>e.jsx("div",{className:"mb-2 text-sm",children:h.username==="System"?e.jsxs("p",{className:"text-cyan-400 italic",children:["-- ",h.message," --"]}):e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",style:{color:h.username===n?"#FBBF24":"white"},children:[h.username,":"]})," ",h.message]})},N)),e.jsx("div",{ref:c})]}),e.jsxs("form",{onSubmit:u,className:"flex gap-2 mt-3",children:[e.jsx("input",{type:"text",value:o,onChange:h=>d(h.target.value),placeholder:"메시지 입력...",className:"flex-grow px-3 py-2 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:border-cyan-500"}),e.jsx("button",{type:"submit",className:"p-2 bg-cyan-600 rounded-md hover:bg-cyan-500",children:e.jsx(Ys,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-3",children:["길드원 (",t.members.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:t.members.map(h=>e.jsx("div",{className:"p-2 bg-gray-700/50 rounded",children:e.jsx("p",{className:"font-semibold",children:h.username})},h.username))})]})]})]})},ja=t=>{const{playerState:n,allGuilds:s,currentUser:a}=t,r=s.find(i=>i.id===n.guildId);return r?e.jsx(ya,{guild:r,currentUser:a,...t}):e.jsx(ba,{guilds:s,...t})},ft=({character:t,onClick:n,canAct:s,isAttacker:a,isTargetable:r})=>{const i=t.currentHp/t.hp*100,o=t.ultimateGauge/t.maxUltimateGauge*100,d=t.currentHp<=0,c=a?"ring-4 ring-yellow-400 scale-110":r?"ring-4 ring-red-500 cursor-pointer hover:ring-red-400":s?"ring-4 ring-green-500 cursor-pointer hover:ring-green-400":"";return e.jsxs("div",{className:`relative transition-all duration-300 ${a?"z-10":""}`,onClick:n,children:[e.jsx("div",{className:`${c} rounded-lg ${d?"opacity-50 grayscale":""}`,children:e.jsx(Ae,{character:t})}),e.jsxs("div",{className:`absolute -bottom-7 left-1 right-1 transition-opacity ${d?"opacity-50":""}`,children:[e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3 border-2 border-black/50 overflow-hidden",children:e.jsx("div",{className:"bg-green-500 h-full",style:{width:`${i}%`}})}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 border border-black/50 mt-1 overflow-hidden",children:e.jsx("div",{className:"bg-purple-500 h-full",style:{width:`${o}%`}})})]})]})},wa=({playerTeam:t,enemyTeam:n,onCombatEnd:s,difficulty:a,ultimateSkills:r,inventory:i,reward:o})=>{const[d,c]=m.useState([]),[u,g]=m.useState("INITIALIZING"),[h,N]=m.useState("SELECT_ATTACKER"),[j,A]=m.useState(null),[v,M]=m.useState(new Set),[H,P]=m.useState([]),[I,k]=m.useState("전투를 준비 중입니다..."),[p,E]=m.useState(null),_=new Map(Le.map(G=>[G.id,G])),O=new Map(r.map(G=>[G.id,G]));m.useEffect(()=>{const G=(x,w)=>{const b=w&&x.equippedEquipmentId?i.find(R=>R.id===x.equippedEquipmentId):void 0,C=rt(x,b),L=w?O.get(x.equippedUltimateId)||_.get(x.equippedUltimateId)||_.get(1):_.get(x.equippedUltimateId)||_.get(1);return{...x,...C,currentHp:C.hp,isPlayer:w,uniqueId:`${x.id}-${Math.random()}`,ultimateGauge:0,maxUltimateGauge:100,ultimateSkill:L}},Y=t.map(x=>G(x,!0)),U=n.map(x=>G(x,!1)),ae=Y.reduce((x,w)=>x+w.speed,0),l=U.reduce((x,w)=>x+w.speed,0);c([...Y,...U]),ae>=l?(g("player"),k("당신의 턴입니다! 행동할 아군을 선택하세요.")):(g("enemy"),k("적의 턴입니다...")),P(["전투 시작!"])},[t,n,r,i]);const D=G=>{P(Y=>[G,...Y.slice(0,4)])},y=(G,Y)=>{let U=!1;return c(ae=>ae.map(l=>{if(l.uniqueId===G){const x=Math.max(0,l.currentHp-Y);return x===0&&(U=!0),{...l,currentHp:x,ultimateGauge:Math.min(l.maxUltimateGauge,l.ultimateGauge+30)}}return l})),U},f=G=>{const Y=new Set(v).add(G.uniqueId);M(Y),A(null),d.filter(ae=>ae.isPlayer&&ae.currentHp>0&&!Y.has(ae.uniqueId)).length===0?(g("enemy"),k("적의 턴입니다..."),M(new Set)):(N("SELECT_ATTACKER"),k("행동할 다른 아군을 선택하세요."))},T=m.useCallback((G,Y)=>{const U=G.attack;D(`${G.name}이(가) ${Y.name}에게 ${U}의 피해를 입혔습니다!`),y(Y.uniqueId,U),c(ae=>ae.map(l=>l.uniqueId===G.uniqueId?{...l,ultimateGauge:Math.min(l.maxUltimateGauge,l.ultimateGauge+40)}:l)),f(G)},[d,v]),B=(G,Y)=>{const U=G.ultimateSkill;let ae=`${G.name}이(가) 궁극기 [${U.name}] (을)를 사용했습니다!`;D(ae);const l=(U.level-1)*.25+1;Y.forEach(x=>{switch(U.effectType){case be.SINGLE_TARGET_DAMAGE:case be.AREA_OF_EFFECT_DAMAGE:const w=Math.floor(G.attack*U.power*l);y(x.uniqueId,w);break;case be.HEAL_SELF:case be.HEAL_TEAM:c(b=>b.map(C=>{if(C.uniqueId===x.uniqueId){const L=Math.min(C.hp,C.currentHp+U.power*l);return{...C,currentHp:L}}return C}));break}}),c(x=>x.map(w=>w.uniqueId===G.uniqueId?{...w,ultimateGauge:0}:w)),f(G)};m.useEffect(()=>{const G=d.filter(U=>!U.isPlayer&&U.currentHp>0),Y=d.filter(U=>U.isPlayer&&U.currentHp>0);G.length===0&&d.length>0?(E("win"),k("승리!")):Y.length===0&&d.length>0&&(E("lose"),k("패배..."))},[d]),m.useEffect(()=>{if(u!=="enemy"||p)return;(async()=>{const Y=d.filter(U=>!U.isPlayer&&U.currentHp>0);for(const U of Y){if(await new Promise(w=>setTimeout(w,1200)),p)break;const ae=d.filter(w=>w.isPlayer&&w.currentHp>0);if(ae.length===0)break;const l=ae[Math.floor(Math.random()*ae.length)],x=U.attack;D(`${U.name}이(가) ${l.name}에게 ${x}의 피해를 입혔습니다!`),y(l.uniqueId,x),c(w=>w.map(b=>b.uniqueId===U.uniqueId?{...b,ultimateGauge:Math.min(b.maxUltimateGauge,b.ultimateGauge+40)}:b))}await new Promise(U=>setTimeout(U,1e3)),p||(g("player"),k("당신의 턴입니다! 행동할 아군을 선택하세요."),N("SELECT_ATTACKER"),M(new Set))})()},[u,p]);const F=G=>{u!=="player"||p||v.has(G.uniqueId)||(A(G.uniqueId),N("SELECT_ACTION"),k(`${G.name}의 행동을 선택하세요.`))},se=G=>{if(h!=="SELECT_TARGET"||!j||p||G.currentHp<=0)return;const Y=d.find(U=>U.uniqueId===j);Y&&T(Y,G)},xe=G=>{if(h!=="SELECT_ACTION"||!j)return;const Y=d.find(U=>U.uniqueId===j);if(G==="attack")N("SELECT_TARGET"),k(`${Y.name}(으)로 공격할 적을 선택하세요.`);else{const U=Y.ultimateSkill;let ae=[];switch(U.targetType){case Te.ENEMY_SINGLE:N("SELECT_TARGET"),k("궁극기로 공격할 적을 선택하세요.");return;case Te.ENEMY_ALL:ae=d.filter(l=>!l.isPlayer&&l.currentHp>0);break;case Te.ALLY_SELF:ae=[Y];break;case Te.ALLY_ALL:ae=d.filter(l=>l.isPlayer&&l.currentHp>0);break}B(Y,ae)}},Ce=()=>{window.confirm("정말 도망치시겠습니까? (패배로 처리됩니다)")&&s("lose")},ye=d.find(G=>G.uniqueId===j);return e.jsxs("div",{className:"min-h-screen bg-gray-900 flex flex-col items-center justify-center p-4 space-y-4 relative",children:[e.jsxs("button",{onClick:Ce,className:"absolute top-4 right-4 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg border border-gray-500 shadow-lg text-sm font-bold z-50 flex items-center gap-2",children:[e.jsx("span",{children:"🏃"})," 도망가기"]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h2",{className:"text-xl font-bold text-center text-red-400 mb-8",children:"적 팀"}),e.jsx("div",{className:"grid grid-cols-4 gap-x-4 gap-y-10 justify-items-center",children:d.filter(G=>!G.isPlayer).map(G=>e.jsx(ft,{character:G,isTargetable:h==="SELECT_TARGET"&&G.currentHp>0,onClick:G.currentHp>0?()=>{h==="SELECT_TARGET"&&ye&&(ye.ultimateSkill.targetType===Te.ENEMY_SINGLE&&ye.ultimateGauge===ye.maxUltimateGauge?B(ye,[G]):se(G))}:void 0},G.uniqueId))})]}),e.jsxs("div",{className:"w-full max-w-lg min-h-[14rem] bg-black/50 p-3 rounded-lg border border-gray-700 text-center flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-cyan-300 mb-2",children:I}),H.map((G,Y)=>e.jsx("p",{className:`transition-opacity duration-300 ${Y===0?"text-white":"text-gray-400 text-xs"}`,children:G},Y))]}),h==="SELECT_ACTION"&&ye&&e.jsxs("div",{className:"flex gap-4 justify-center mt-4",children:[e.jsx("button",{onClick:()=>xe("attack"),className:"px-4 py-2 bg-red-600 rounded hover:bg-red-500",children:"일반 공격"}),e.jsx("button",{onClick:()=>xe("ultimate"),disabled:ye.ultimateGauge<ye.maxUltimateGauge,className:"px-4 py-2 bg-purple-600 rounded hover:bg-purple-500 disabled:bg-gray-600 disabled:cursor-not-allowed",children:"궁극기 사용"})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h2",{className:"text-xl font-bold text-center text-green-400 mb-8",children:"나의 팀"}),e.jsx("div",{className:"grid grid-cols-4 gap-x-4 gap-y-10 justify-items-center",children:d.filter(G=>G.isPlayer).map(G=>e.jsx(ft,{character:G,canAct:u==="player"&&!v.has(G.uniqueId)&&h==="SELECT_ATTACKER"&&G.currentHp>0,isAttacker:j===G.uniqueId,onClick:G.currentHp>0?()=>F(G):void 0},G.uniqueId))})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 animate-fade-in",children:e.jsxs("div",{className:"bg-gray-800 p-8 rounded-lg text-center shadow-2xl border-2 border-cyan-400",children:[e.jsx("h1",{className:"text-5xl font-extrabold mb-4 text-yellow-400",children:p==="win"?"승리!":"패배..."}),e.jsx("p",{className:"text-gray-300 mb-6",children:p==="win"?`${o} 다이아 획득!`:"팀이 전멸했습니다."}),e.jsx("button",{onClick:()=>s(p),className:"px-8 py-3 rounded-lg bg-cyan-600 text-white font-bold text-lg hover:bg-cyan-500 transition-colors",children:"확인"})]})})]})};function va(t){const n=t.hp??t.maxHp??1e5,s=Math.max(100,Math.round(n*.02)),a=5+Math.round(n/1e5*10);return{name:t.name,imageUrl:t.imageUrl,hp:n,attack:s,speed:a,currentHp:n}}const gt=({character:t,isAttacker:n})=>{const s=t.currentHp/t.hp*100,a=t.currentHp<=0,r=n?"ring-4 ring-yellow-400 scale-110":"";return e.jsxs("div",{className:`relative transition-all duration-300 ${n?"z-10":""}`,children:[e.jsx("div",{className:`${r} rounded-lg ${a?"opacity-50 grayscale":""}`,children:e.jsx(Ae,{character:t})}),e.jsxs("div",{className:`absolute -bottom-5 left-1 right-1 transition-opacity ${a?"opacity-50":""}`,children:[e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3 border-2 border-black/50 overflow-hidden",children:e.jsx("div",{className:"bg-green-500 h-full",style:{width:`${s}%`}})}),"ultimateGauge"in t&&e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 border border-black/50 mt-1 overflow-hidden",children:e.jsx("div",{className:"bg-purple-500 h-full",style:{width:`${t.ultimateGauge/t.maxUltimateGauge*100}%`}})})]})]})},Na=({playerTeam:t,boss:n,ultimateSkills:s,inventory:a,onCombatEnd:r})=>{const[i,o]=m.useState([]),[d,c]=m.useState(null),[u,g]=m.useState(0),[h]=m.useState(10),[N,j]=m.useState([]),[A,v]=m.useState(!0),M=new Map(Le.map(k=>[k.id,k])),H=new Map(s.map(k=>[k.id,k]));m.useEffect(()=>{const k=p=>{const E=p.equippedEquipmentId?a.find(D=>D.id===p.equippedEquipmentId):void 0,_=rt(p,E),O=H.get(p.equippedUltimateId)||M.get(p.equippedUltimateId)||M.get(1);return{...p,..._,currentHp:_.hp,isPlayer:!0,uniqueId:`${p.id}-${Math.random()}`,ultimateGauge:0,maxUltimateGauge:100,ultimateSkill:O}};o(t.map(k)),c(va(n)),j(["레이드 보스 출현!"]),v(!1)},[t,n,s,a]);const P=k=>{j(p=>[k,...p.slice(0,4)])},I=()=>{if(!d)return;const k=n.hp-d.currentHp;P(`전투 종료! 총 ${k.toLocaleString()}의 피해를 입혔습니다.`),setTimeout(()=>{r(k)},2e3)};return m.useEffect(()=>{if(A||!d)return;const k=i.filter(O=>O.currentHp>0);if(u>=h||k.length===0||d.currentHp<=0){I();return}const _=setTimeout(async()=>{v(!0),g(O=>O+1);for(const O of k){if(d.currentHp<=0)break;if(await new Promise(D=>setTimeout(D,600)),O.ultimateGauge>=O.maxUltimateGauge){const D=O.ultimateSkill;P(`${O.name}이(가) 궁극기 [${D.name}] (을)를 사용!`);const y=(D.level-1)*.25+1,f=Math.floor(O.attack*D.power*y);c(T=>{if(!T)return null;const B=Math.max(0,T.currentHp-f);return{...T,currentHp:B}}),o(T=>T.map(B=>B.uniqueId===O.uniqueId?{...B,ultimateGauge:0}:B))}else{const D=O.attack;P(`${O.name}이(가) 보스를 공격! ${D} 피해!`),c(y=>{if(!y)return null;const f=Math.max(0,y.currentHp-D);return{...y,currentHp:f}}),o(y=>y.map(f=>f.uniqueId===O.uniqueId?{...f,ultimateGauge:Math.min(f.maxUltimateGauge,f.ultimateGauge+40)}:f))}}if(d.currentHp>0){await new Promise(D=>setTimeout(D,1e3));const O=i.filter(D=>D.currentHp>0);if(O.length>0){const D=O[Math.floor(Math.random()*O.length)],y=d.attack;P(`보스가 ${D.name}에게 ${y} 피해를 입혔습니다!`),o(f=>f.map(T=>{if(T.uniqueId===D.uniqueId){const B=Math.max(0,T.currentHp-y);return{...T,currentHp:B,ultimateGauge:Math.min(T.maxUltimateGauge,T.ultimateGauge+30)}}return T}))}}v(!1)},1e3);return()=>clearTimeout(_)},[u,A,d,i]),d?e.jsxs("div",{className:"min-h-screen bg-gray-900 flex flex-col items-center justify-center p-4 space-y-4",children:[e.jsxs("div",{className:"w-full text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-red-400 mb-8",children:"레이드 보스"}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-48",children:e.jsx(gt,{character:d})})})]}),e.jsx("div",{className:"w-full max-w-lg min-h-[14rem] bg-black/50 p-3 rounded-lg border border-gray-700 text-center flex flex-col justify-between",children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-xl font-bold text-cyan-300 mb-2",children:["Turn ",u," / ",h]}),N.map((k,p)=>e.jsx("p",{className:`transition-opacity duration-300 ${p===0?"text-white":"text-gray-400 text-xs"}`,children:k},p))]})}),e.jsxs("div",{className:"w-full",children:[e.jsx("h2",{className:"text-xl font-bold text-center text-green-400 mb-8",children:"나의 팀"}),e.jsx("div",{className:"grid grid-cols-4 gap-x-4 gap-y-10 justify-items-center",children:i.map(k=>e.jsx(gt,{character:k},k.uniqueId))})]})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."})},Sa=()=>{const[t,n]=m.useState(null),[s,a]=m.useState(null),[r,i]=m.useState("login"),[o,d]=m.useState(null),[c,u]=m.useState(null),[g,h]=m.useState([]);m.useEffect(()=>{t&&g.length===0&&h([{id:"guild-1",name:"최강용병단",creator:"AcePlayer",members:[{username:"AcePlayer",joinedAt:new Date().toISOString()}],chat:[{username:"System",message:"최강용병단 길드가 생성되었습니다.",timestamp:new Date().toISOString()}],raidBoss:{...We}},{id:"guild-2",name:"어둠의자손들",creator:"ShadowCat",members:[{username:"ShadowCat",joinedAt:new Date().toISOString()}],chat:[{username:"System",message:"어둠의자손들 길드가 생성되었습니다.",timestamp:new Date().toISOString()}],raidBoss:{...We,name:"심연의 감시자",hp:75e6,maxHp:75e6}}])},[t]),m.useEffect(()=>{if(t){const y=localStorage.getItem(`playerState_${t}`);if(y)try{const f=JSON.parse(y);a({...Oe,...f,inventory:f.inventory||Oe.inventory,ultimateSkills:f.ultimateSkills||Oe.ultimateSkills})}catch(f){console.error("Failed to parse save state",f),a(Oe)}else a(Oe)}else a(null),i("login")},[t]),m.useEffect(()=>{s&&t&&localStorage.setItem(`playerState_${t}`,JSON.stringify(s))},[s,t]);const N=y=>{n(y),i("main")},j=()=>{n(null)},A=y=>{i(y)},v=(y,f)=>{const B={very_easy:100,easy:300,normal:800,hard:2e3,very_hard:5e3,hell:15e3,hardcore:5e4,boss:1e5}[f];d({opponents:y,difficulty:f,reward:B})},M=y=>{y==="win"&&s&&o&&a({...s,currency:s.currency+o.reward}),d(null)},H=(y,f)=>{a(T=>{if(!T)return null;const B=T.characters.map(se=>se.id===y?{...se,equippedUltimateId:f}:se),F=T.teams.map(se=>({...se,characters:se.characters.map(xe=>xe&&xe.id===y?{...xe,equippedUltimateId:f}:xe)}));return{...T,characters:B,teams:F}})},P=(y,f)=>{a(T=>{if(!T)return null;const B=T.characters.map(se=>se.id===y?{...se,equippedEquipmentId:f}:se),F=T.teams.map(se=>({...se,characters:se.characters.map(xe=>xe&&xe.id===y?{...xe,equippedEquipmentId:f}:xe)}));return{...T,characters:B,teams:F}})},I=y=>{if(!t||!s||s.guildId)return;const f={id:`guild-${Date.now()}`,name:y,creator:t,members:[{username:t,joinedAt:new Date().toISOString()}],chat:[{username:"System",message:`${y} 길드가 생성되었습니다.`,timestamp:new Date().toISOString()}],raidBoss:{...We}};h(T=>[...T,f]),a(T=>T?{...T,guildId:f.id}:null)},k=y=>{!t||!s||s.guildId||(h(f=>f.map(T=>T.id===y?{...T,members:[...T.members,{username:t,joinedAt:new Date().toISOString()}],chat:[...T.chat,{username:"System",message:`${t}님이 가입했습니다.`,timestamp:new Date().toISOString()}]}:T)),a(f=>f?{...f,guildId:y}:null))},p=()=>{if(!t||!s||!s.guildId)return;const y=s.guildId;h(f=>f.map(T=>T.id===y?{...T,members:T.members.filter(B=>B.username!==t),chat:[...T.chat,{username:"System",message:`${t}님이 탈퇴했습니다.`,timestamp:new Date().toISOString()}]}:T)),a(f=>f?{...f,guildId:null}:null)},E=y=>{if(!t||!s||!s.guildId)return;const f=s.guildId,T={username:t,message:y,timestamp:new Date().toISOString()};h(B=>B.map(F=>F.id===f?{...F,chat:[...F.chat,T]}:F))},_=()=>{if(!s||!s.guildId)return;const y=g.find(f=>f.id===s.guildId);y&&y.raidBoss.hp>0&&u({raidBoss:y.raidBoss})},O=y=>{if(!t||!s||!s.guildId)return;const f=s.guildId;let T=!1;if(h(B=>B.map(F=>{if(F.id===f){const se=Math.max(0,F.raidBoss.hp-y);se===0&&F.raidBoss.hp>0&&(T=!0);const xe=T?[...F.chat,{username:"System",message:`${t}님이 레이드 보스에게 최후의 일격을 가했습니다!`,timestamp:new Date().toISOString()}]:F.chat;return{...F,raidBoss:{...F.raidBoss,hp:se,lastAttackedBy:t},chat:xe}}return F})),T){const B=g.find(F=>F.id===f);B&&a(F=>F?{...F,currency:F.currency+B.raidBoss.reward}:null)}u(null)},D=()=>{var y,f;if(!t||!s)return e.jsx(Os,{onLogin:N});if(o){const T=((y=s.teams[0])==null?void 0:y.characters.filter(B=>B!==null))||[];return e.jsx(wa,{playerTeam:T,enemyTeam:o.opponents,difficulty:o.difficulty,reward:o.reward,ultimateSkills:s.ultimateSkills||[],inventory:s.inventory||[],onCombatEnd:M})}if(c){const T=((f=s.teams[0])==null?void 0:f.characters.filter(B=>B!==null))||[];return e.jsx(Na,{playerTeam:T,boss:c.raidBoss,ultimateSkills:s.ultimateSkills||[],inventory:s.inventory||[],onCombatEnd:O})}switch(r){case"main":return e.jsx(mt,{playerState:s,currentUser:t,onLogout:j,onNavigate:A});case"gacha":return e.jsx(ea,{playerState:s,setPlayerState:a});case"team":return e.jsx(ia,{playerState:s,setPlayerState:a,onEquipUltimate:H,onEquipEquipment:P});case"battle":return e.jsx(ma,{playerState:s,onStartCombat:v});case"social":return e.jsx(xa,{friends:s.friends});case"shop":return e.jsx(ga,{playerState:s,setPlayerState:a});case"guild":return e.jsx(ja,{playerState:s,allGuilds:g,currentUser:t,onCreateGuild:I,onJoinGuild:k,onLeaveGuild:p,onSendMessage:E,onAttackRaid:_});default:return e.jsx(mt,{playerState:s,currentUser:t,onLogout:j,onNavigate:A})}};return e.jsx("div",{className:"min-h-screen bg-gray-900 text-white font-sans selection:bg-cyan-500 selection:text-white pb-20 md:pb-0",children:e.jsxs("div",{className:"max-w-2xl mx-auto min-h-screen bg-gray-900 shadow-2xl overflow-hidden relative",children:[e.jsx("main",{className:"p-4 pb-24",children:D()}),t&&!o&&!c&&e.jsxs("nav",{className:"fixed bottom-0 left-0 right-0 bg-gray-800 border-t border-gray-700 p-2 flex justify-around items-center max-w-2xl mx-auto z-50",children:[e.jsx("button",{onClick:()=>i("main"),className:`p-2 rounded-lg ${r==="main"?"text-cyan-400 bg-gray-700":"text-gray-400"}`,children:e.jsx(Hs,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>i("team"),className:`p-2 rounded-lg ${r==="team"?"text-cyan-400 bg-gray-700":"text-gray-400"}`,children:e.jsx(Ws,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>i("battle"),className:`p-2 rounded-lg ${r==="battle"?"text-cyan-400 bg-gray-700":"text-gray-400"}`,children:e.jsx(Ps,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>i("guild"),className:`p-2 rounded-lg ${r==="guild"?"text-cyan-400 bg-gray-700":"text-gray-400"}`,children:e.jsx($s,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>i("shop"),className:`p-2 rounded-lg ${r==="shop"?"text-cyan-400 bg-gray-700":"text-gray-400"}`,children:e.jsx(Mt,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>i("social"),className:`p-2 rounded-lg ${r==="social"?"text-cyan-400 bg-gray-700":"text-gray-400"}`,children:e.jsx(qs,{className:"w-6 h-6"})})]})]})})},X=40,et=10,bt=30,yt=3,ka=6,Ta=1.5,Ea=1,Ca=1.5,Ma=1.2,De=60*(Math.PI/180),Re=640,Aa=.0037,Ia=40,Ra=600,La=90,_a=Math.PI/2,Ga=.1,Oa=.3,Da=1,Pa=0,Ba=.6,$a=2e4,Ha=60,Ua=300,Fa=600,qa={MOVE_FORWARD:"KeyW",MOVE_BACKWARD:"KeyS",MOVE_LEFT:"KeyA",MOVE_RIGHT:"KeyD",RUN:"ShiftLeft",SNEAK:"ControlLeft",INTERACT:"KeyE",FLASHLIGHT:"KeyF"},te=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,9,0,4,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,5,5,0,0,0,0,0,0,1,8,8,8,8,8,8,8,8,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,10,10,10,2,1],[1,5,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,0,6,0,1,0,0,7,7,1,0,0,1,7,7,7,1,0,0,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1],[1,0,0,0,1,0,0,7,7,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1],[1,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,7,7,7,0,1,0,0,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,0,0,1],[1,0,7,7,7,0,0,0,0,1,7,7,1,0,0,1,10,0,1,1,0,0,1,10,10,1,1,0,0,1,10,10,1,1,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,7,7,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,1],[1,0,0,6,0,0,1,0,0,1,0,0,0,0,0,1,0,0,1,1,0,0,1,0,0,1,1,0,0,1,0,0,1,1,0,0,0,0,1],[1,1,1,1,1,1,1,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1],[1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,7,7,7,0,1,0,0,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1],[1,0,7,7,7,0,0,0,0,1,10,10,1,0,0,1,2,0,0,1,0,0,1,0,0,0,1,0,0,1,5,5,5,1,2,0,6,0,1],[1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,7,7,7,7,7,0,0,0,0,7,7,0,0,7,7,0,0,7,7,0,0,7,7,0,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,0,7,7,7,7,7,0,0,1,0,7,7,0,0,7,7,0,0,7,7,0,0,7,7,0,0,0,2,0,0,0,0,1,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,1],[1,5,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,1,1,0,1,0,0,0,0,0,0,1],[1,5,0,6,0,0,0,0,0,1,0,0,5,5,5,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,0,0,5,5,5,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,2,1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,0,0,5,5,5,0,0,0,0,0,0,1,0,1,1,1,1,0,0,1,0,1,0,0,0,0,0,0,1],[1,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1],[1,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,1,1,1,1,1,1,1,1,1,1]],Va=te[0].length*X,Wa=te.length*X;class Z{constructor(){this.ctx=null,this.masterGain=null,this.windNode=null,this.windGain=null,this.lastBreathTime=0}static getInstance(){return Z.instance||(Z.instance=new Z),Z.instance}init(){this.ctx||(this.ctx=new(window.AudioContext||window.webkitAudioContext),this.masterGain=this.ctx.createGain(),this.masterGain.gain.value=.5,this.masterGain.connect(this.ctx.destination)),this.ctx.state==="suspended"&&this.ctx.resume()}resume(){this.ctx&&this.ctx.state==="suspended"?this.ctx.resume():this.ctx||this.init()}createNoiseBuffer(){if(!this.ctx)throw new Error("AudioContext not initialized");const n=this.ctx.sampleRate*2,s=this.ctx.createBuffer(1,n,this.ctx.sampleRate),a=s.getChannelData(0);for(let r=0;r<n;r++)a[r]=Math.random()*2-1;return s}startWind(){if(!this.ctx||!this.masterGain||this.windNode)return;const n=this.createNoiseBuffer();this.windNode=this.ctx.createBufferSource(),this.windNode.buffer=n,this.windNode.loop=!0;const s=this.ctx.createBiquadFilter();s.type="lowpass",s.frequency.value=400,s.Q.value=1,this.windGain=this.ctx.createGain(),this.windGain.gain.value=.05;const a=this.ctx.createOscillator();a.frequency.value=.1;const r=this.ctx.createGain();r.gain.value=.02,a.connect(r),r.connect(this.windGain.gain),a.start(),this.windNode.connect(s),s.connect(this.windGain),this.windGain.connect(this.masterGain),this.windNode.start()}stopWind(){this.windNode&&(this.windNode.stop(),this.windNode=null)}playCrow(){if(!this.ctx||!this.masterGain)return;const n=this.ctx.currentTime,s=this.ctx.createOscillator();s.type="sawtooth",s.frequency.setValueAtTime(600,n),s.frequency.exponentialRampToValueAtTime(400,n+.4);const a=this.ctx.createGain();a.gain.setValueAtTime(0,n),a.gain.linearRampToValueAtTime(.1,n+.05),a.gain.exponentialRampToValueAtTime(.001,n+.5);const r=this.ctx.createOscillator();r.frequency.value=30;const i=this.ctx.createGain();i.gain.value=200,r.connect(i),i.connect(s.frequency),s.connect(a),a.connect(this.masterGain),s.start(n),r.start(n),s.stop(n+.6),r.stop(n+.6)}playCarCooling(){if(!this.ctx||!this.masterGain)return;const n=this.ctx.currentTime,s=3+Math.floor(Math.random()*3);for(let a=0;a<s;a++){const r=n+Math.random()*2,i=this.ctx.createOscillator();i.type="triangle",i.frequency.value=2e3+Math.random()*500;const o=this.ctx.createGain();o.gain.setValueAtTime(.05,r),o.gain.exponentialRampToValueAtTime(.001,r+.05),i.connect(o),o.connect(this.masterGain),i.start(r),i.stop(r+.1)}}playFlashlightRoll(){if(!this.ctx||!this.masterGain)return;const n=this.ctx.currentTime;[0,.2,.35,.45].forEach((a,r)=>{const i=n+a,o=this.createNoiseBuffer(),d=this.ctx.createBufferSource();d.buffer=o;const c=this.ctx.createBiquadFilter();c.type="lowpass",c.frequency.value=600-r*100;const u=this.ctx.createGain();u.gain.setValueAtTime(.2/(r+1),i),u.gain.exponentialRampToValueAtTime(.001,i+.1),d.connect(c),c.connect(u),u.connect(this.masterGain),d.start(i)}),setTimeout(()=>{if(!this.ctx||!this.masterGain)return;const a=this.ctx.currentTime,r=this.ctx.createOscillator();r.frequency.setValueAtTime(80,a),r.frequency.exponentialRampToValueAtTime(40,a+.1);const i=this.ctx.createGain();i.gain.setValueAtTime(.3,a),i.gain.exponentialRampToValueAtTime(.001,a+.2),r.connect(i),i.connect(this.masterGain),r.start(a),r.stop(a+.2)},600)}playBell(){if(!this.ctx||!this.masterGain)return;const n=this.ctx.currentTime;[220,440,660,880].forEach((s,a)=>{const r=this.ctx.createOscillator(),i=this.ctx.createGain();r.frequency.value=s,r.detune.value=Math.random()*20-10,i.gain.setValueAtTime(0,n),i.gain.linearRampToValueAtTime(.1/(a+1),n+.1),i.gain.exponentialRampToValueAtTime(.001,n+4),r.connect(i),i.connect(this.masterGain),r.start(n),r.stop(n+4)})}playBreathing(){if(!this.ctx||!this.masterGain)return;const n=Date.now();if(n-this.lastBreathTime<2500)return;this.lastBreathTime=n;const s=this.ctx.currentTime,a=this.createNoiseBuffer(),r=this.ctx.createBufferSource();r.buffer=a;const i=this.ctx.createBiquadFilter();i.type="lowpass",i.frequency.value=400;const o=this.ctx.createGain();o.gain.setValueAtTime(0,s),o.gain.linearRampToValueAtTime(.05,s+1),o.gain.linearRampToValueAtTime(0,s+2),r.connect(i),i.connect(o),o.connect(this.masterGain),r.start(s),r.stop(s+2.5)}playFootstep(n,s=1){if(!this.ctx||!this.masterGain)return;const a=this.ctx.currentTime,r=this.createNoiseBuffer(),i=this.ctx.createBufferSource();i.buffer=r;const o=this.ctx.createBiquadFilter();o.type="lowpass",n==="DIRT"?o.frequency.value=200:n==="WOOD"?o.frequency.value=800:n==="WATER"&&(o.frequency.value=1e3,o.Q.value=5);const d=this.ctx.createGain();d.gain.setValueAtTime(.15*s,a),d.gain.exponentialRampToValueAtTime(.001,a+.1),i.connect(o),o.connect(d),d.connect(this.masterGain),i.start(a),i.stop(a+.1)}playGhostFootstep(n){if(!this.ctx||!this.masterGain)return;const s=this.ctx.currentTime,a=this.createNoiseBuffer(),r=this.ctx.createBufferSource();r.buffer=a;const i=this.ctx.createBiquadFilter();i.type="lowpass";let o=.1,d=.1;if(n==="SOFT")i.frequency.value=150,o=.05;else if(n==="NORMAL")i.frequency.value=300,o=.15;else{i.frequency.value=500,o=.4,d=.15;const u=this.ctx.createOscillator();u.frequency.value=60;const g=this.ctx.createGain();g.gain.setValueAtTime(.2,s),g.gain.exponentialRampToValueAtTime(.001,s+d),u.connect(g),g.connect(this.masterGain),u.start(s),u.stop(s+d)}const c=this.ctx.createGain();c.gain.setValueAtTime(o,s),c.gain.exponentialRampToValueAtTime(.001,s+d),r.connect(i),i.connect(c),c.connect(this.masterGain),r.start(s),r.stop(s+d)}playJumpScare(){if(!this.ctx||!this.masterGain)return;const n=this.ctx.currentTime,s=this.ctx.createOscillator();s.type="sawtooth",s.frequency.setValueAtTime(1500,n),s.frequency.linearRampToValueAtTime(400,n+.3);const a=this.ctx.createGain();a.gain.setValueAtTime(.8,n),a.gain.exponentialRampToValueAtTime(.001,n+.4);const r=this.createNoiseBuffer(),i=this.ctx.createBufferSource();i.buffer=r;const o=this.ctx.createBiquadFilter();o.type="bandpass",o.frequency.value=2e3,o.Q.value=5;const d=this.ctx.createGain();d.gain.setValueAtTime(.8,n),d.gain.exponentialRampToValueAtTime(.001,n+.5),s.connect(a),a.connect(this.masterGain),i.connect(o),o.connect(d),d.connect(this.masterGain),s.start(n),s.stop(n+.4),i.start(n),i.stop(n+.5)}playClick(n){if(!this.ctx||!this.masterGain)return;const s=this.ctx.currentTime,a=this.ctx.createOscillator();a.type="square",a.frequency.setValueAtTime(n?1200:800,s);const r=this.ctx.createGain();r.gain.setValueAtTime(.1,s),r.gain.exponentialRampToValueAtTime(.001,s+.05),a.connect(r),r.connect(this.masterGain),a.start(s),a.stop(s+.05)}playBuzz(n=.5){if(!this.ctx||!this.masterGain)return;const s=this.ctx.currentTime,a=this.ctx.createOscillator();a.type="sawtooth",a.frequency.value=50+Math.random()*10;const r=this.createNoiseBuffer(),i=this.ctx.createBufferSource();i.buffer=r;const o=this.ctx.createBiquadFilter();o.type="highpass",o.frequency.value=2e3;const d=this.ctx.createGain();d.gain.value=.05;const c=this.ctx.createGain();c.gain.setValueAtTime(.05,s),c.gain.linearRampToValueAtTime(.08,s+n*.2),c.gain.linearRampToValueAtTime(.02,s+n*.5),c.gain.linearRampToValueAtTime(0,s+n),a.connect(c),i.connect(o),o.connect(d),d.connect(c),c.connect(this.masterGain),a.start(s),a.stop(s+n),i.start(s),i.stop(s+n)}playDrone(){if(!this.ctx||!this.masterGain)return;const n=this.ctx.currentTime,s=this.ctx.createOscillator();s.frequency.value=60;const a=this.ctx.createGain();a.gain.setValueAtTime(0,n),a.gain.linearRampToValueAtTime(.05,n+.5),a.gain.linearRampToValueAtTime(0,n+2),s.connect(a),a.connect(this.masterGain),s.start(n),s.stop(n+2)}playItemDrop(){if(!this.ctx||!this.masterGain)return;const n=this.ctx.currentTime,s=this.createNoiseBuffer(),a=this.ctx.createBufferSource();a.buffer=s;const r=this.ctx.createBiquadFilter();r.type="highpass",r.frequency.value=1e3;const i=this.ctx.createGain();i.gain.setValueAtTime(.2,n),i.gain.exponentialRampToValueAtTime(.001,n+.1),a.connect(r),r.connect(i),i.connect(this.masterGain),a.start(n)}playSwing(){if(!this.ctx||!this.masterGain)return;const n=this.ctx.currentTime,s=this.createNoiseBuffer(),a=this.ctx.createBufferSource();a.buffer=s;const r=this.ctx.createBiquadFilter();r.type="bandpass",r.frequency.setValueAtTime(300,n),r.frequency.linearRampToValueAtTime(1e3,n+.2);const i=this.ctx.createGain();i.gain.setValueAtTime(.2,n),i.gain.linearRampToValueAtTime(0,n+.2),a.connect(r),r.connect(i),i.connect(this.masterGain),a.start(n),a.stop(n+.2)}playHit(){if(!this.ctx||!this.masterGain)return;const n=this.ctx.currentTime,s=this.ctx.createOscillator();s.frequency.setValueAtTime(150,n),s.frequency.exponentialRampToValueAtTime(40,n+.1);const a=this.ctx.createGain();a.gain.setValueAtTime(.5,n),a.gain.exponentialRampToValueAtTime(.001,n+.15),s.connect(a),a.connect(this.masterGain),s.start(n),s.stop(n+.15)}}const jt=["NOTE 1: The camera is the only thing that works here. I don't know why, but seeing them through the lens keeps them at bay... for a while.","NOTE 2: The batteries drain so fast. It's like the darkness eats the power. If the camera dies, I die.","NOTE 3: I saw him in the viewfinder. He wasn't there when I looked with my own eyes. Trust the camera.","NOTE 4: The Janitor took the master keys to the basement boiler room. He said the heat keeps them away. I hope he's right.","NOTE 5: DO NOT LET THE CAMERA DIE. It's your only connection to the living world.","NOTE 6: Find the keys. Leave this cursed place. Do not look back.","NOTE 7: Static... so much static. It means he's getting closer."],Ya={bed:"https://m.media-amazon.com/images/I/71Wp3-gZlGL._AC_SL1500_.jpg",note:"https://i.stack.imgur.com/tL80j.jpg",ghost:"https://i.imgur.com/W2C2x2s.jpeg"},za=({gameState:t,setGameState:n,onStatsUpdate:s,keyBindings:a})=>{const r=m.useRef(null),i=m.useRef(0),[o,d]=m.useState(null),c=m.useRef({id:"player",type:"PLAYER",x:100,y:100,width:et,height:et,active:!0,speed:yt,battery:100,keys:0,noise:0,flashlightOn:!0,hasFlashlight:!0,direction:{x:1,y:0},isFlickering:!1,isCrouching:!1,yaw:-Math.PI/2,pitch:0,lastJumpScareTime:0,sanity:0,isHidden:!1,hasBat:!1,attackTimer:0,lastAttackTime:0}),u=m.useRef({id:"enemy",type:"ENEMY",x:600,y:300,width:bt,height:bt,active:!0,state:"IDLE",speed:Ea,lastKnownPlayerPos:null,patrolPoints:[],currentPatrolIndex:0,invisible:!1,stareTimer:0,footstepTimer:0,teleportCooldown:0}),g=m.useRef([]),h=m.useRef({}),N=m.useRef(0),j=m.useRef({}),A=m.useRef([]),v=m.useRef(0),M=m.useRef(!1),H=m.useRef(0),P=m.useRef(0),I=m.useRef(0),k=m.useRef({active:!1,timer:0}),p=m.useRef({active:!1,startTime:0}),E=m.useRef(new Array(Re).fill(0)),_=m.useCallback(()=>{g.current=[],M.current=!1,H.current=0,P.current=0,k.current={active:!1,timer:0},p.current={active:!1,startTime:0},c.current.battery=100;const l=Z.getInstance();l.startWind(),l.playCrow(),Object.entries(Ya).forEach(([b,C])=>{const L=new Image;L.crossOrigin="Anonymous",L.src=C,j.current[b]=L}),A.current=Array.from({length:150},()=>({x:Math.random()*1280,y:Math.random()*720,length:10+Math.random()*20,speed:15+Math.random()*10}));let x=[],w=0;for(let b=0;b<te.length;b++)for(let C=0;C<te[0].length;C++){const L=te[b][C],R=C*X+X/2,$=b*X+X/2;if(L===9)c.current.x=R,c.current.y=$,c.current.keys=0,c.current.noise=0,c.current.hasFlashlight=!0,c.current.flashlightOn=!0,c.current.isFlickering=!1,c.current.yaw=-Math.PI/2,c.current.pitch=0,c.current.lastJumpScareTime=0,c.current.isHidden=!1,c.current.hasBat=!1,c.current.attackTimer=0;else if(L===2)g.current.push({id:`key_${b}_${C}`,type:"KEY",x:R,y:$,width:20,height:20,active:!0});else if(L===4)g.current.push({id:`car_${b}_${C}`,type:"CAR",x:R,y:$,width:60,height:40,active:!0});else if(L===5){const ne={id:`locker_${b}_${C}`,type:"LOCKER",x:R,y:$,width:30,height:30,active:!0,isOpen:!1,content:"EMPTY"};x.push(ne),g.current.push(ne)}else L===10?g.current.push({id:`bed_${b}_${C}`,type:"BED",x:R,y:$,width:32,height:38,active:!0}):L===6&&(g.current.push({id:`note_${b}_${C}`,type:"NOTE",x:R,y:$,width:25,height:25,active:!0,text:jt[w%jt.length]}),w++)}if(g.current.push({id:"weapon_bat",type:"BAT",x:200,y:100,width:30,height:8,active:!0}),x.length>0){const b=Math.floor(Math.random()*x.length);let C=Math.floor(Math.random()*x.length);for(;C===b;)C=Math.floor(Math.random()*x.length);x[b].content="KEY",x[C].content="KEY",x.forEach((L,R)=>{R!==b&&R!==C&&Math.random()<.6&&(L.content="BATTERY")})}u.current.x=Va-200,u.current.y=Wa-200,u.current.state="IDLE",u.current.active=!1,u.current.invisible=!1,u.current.stareTimer=0,h.current={}},[]);m.useEffect(()=>{t==="PLAYING"?_():(Z.getInstance().stopWind(),document.pointerLockElement===r.current&&document.exitPointerLock())},[t,_]);const O=()=>{const l=Date.now();l-c.current.lastJumpScareTime>$a&&(k.current={active:!0,timer:l},c.current.lastJumpScareTime=l,c.current.noise=1,Z.getInstance().playJumpScare(),c.current.isHidden&&(c.current.isHidden=!1))};m.useEffect(()=>{const l=L=>{h.current[L.code]=!0,L.code===a.INTERACT&&y(),(L.code==="Escape"||L.code===a.INTERACT)&&o&&d(null)},x=L=>{h.current[L.code]=!1},w=L=>{document.pointerLockElement===r.current&&!k.current.active&&!p.current.active&&(c.current.yaw+=L.movementX*.002,c.current.pitch-=L.movementY*.002,c.current.pitch=Math.max(-.5,Math.min(.5,c.current.pitch)),c.current.direction={x:Math.cos(c.current.yaw),y:Math.sin(c.current.yaw)})},b=L=>{var R;t==="PLAYING"&&!p.current.active&&(!o&&document.pointerLockElement!==r.current?(R=r.current)==null||R.requestPointerLock():c.current.hasBat&&!c.current.isHidden&&L.button===0&&D())};window.addEventListener("keydown",l),window.addEventListener("keyup",x),document.addEventListener("mousemove",w);const C=r.current;return C&&C.addEventListener("mousedown",b),()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",x),document.removeEventListener("mousemove",w),C&&C.removeEventListener("mousedown",b)}},[t,o,a]);const D=()=>{const l=c.current,x=Date.now();if(x-l.lastAttackTime<Ra)return;l.attackTimer=200,l.lastAttackTime=x,Z.getInstance().playSwing();const w=u.current;if(w.active&&Math.hypot(w.x-l.x,w.y-l.y)<La){let L=Math.atan2(w.y-l.y,w.x-l.x)-l.yaw;for(;L>Math.PI;)L-=2*Math.PI;for(;L<-Math.PI;)L+=2*Math.PI;Math.abs(L)<_a/2&&(Z.getInstance().playHit(),s(R=>({...R,message:"BANISHED!"})),w.state="IDLE",w.x=-2e3,w.y=-2e3,w.teleportCooldown=500,w.invisible=!0)}},y=()=>{if(o){d(null);return}const l=c.current;if(l.isHidden){l.isHidden=!1,s(b=>({...b,message:""}));return}let x=null,w=70;if(g.current.forEach(b=>{if(!b.active)return;const C=Math.hypot(b.x-l.x,b.y-l.y);C<w&&(x=b,w=C)}),x){const b=x;b.type==="CAR"&&!l.hasFlashlight?(l.hasFlashlight=!0,l.flashlightOn=!0,l.battery=100,Z.getInstance().playClick(!0),Z.getInstance().playBuzz(.5),Z.getInstance().playDrone(),I.current=Date.now(),s(C=>({...C,message:"BATTERY RECHARGED"}))):b.type==="BAT"?(l.hasBat=!0,b.active=!1,Z.getInstance().playItemDrop(),s(C=>({...C,message:"BASEBALL BAT ACQUIRED"}))):b.type==="NOTE"?(d(b.text||"..."),b.active=!1,Z.getInstance().playClick(!0),s(C=>({...C,message:"STORY NOTE FOUND"}))):b.type==="BED"?(l.isHidden=!0,l.hidingType="BED",Z.getInstance().playItemDrop(),s(C=>({...C,message:"HIDING UNDER BED..."}))):b.type==="LOCKER"&&(b.isOpen?(l.isHidden=!0,l.hidingType="LOCKER",s(C=>({...C,message:"HIDING IN LOCKER..."}))):(b.isOpen=!0,l.noise=1,Z.getInstance().playItemDrop(),Math.random()<.2&&O(),b.content==="BATTERY"?(l.battery=Math.min(100,l.battery+Ia),s(C=>({...C,message:"REPLACED BATTERY"})),b.content="EMPTY"):b.content==="KEY"?(l.keys++,s(C=>({...C,message:"FOUND KEY"})),b.content="EMPTY"):s(C=>({...C,message:"EMPTY"}))))}},f=(l,x,w,b=!1)=>{const C=Math.floor((l-w/2)/X),L=Math.floor((l+w/2)/X),R=Math.floor((x-w/2)/X),$=Math.floor((x+w/2)/X);if(C<0||L>=te[0].length||R<0||$>=te.length||te[R][C]===1||te[R][C]===7||te[R][L]===1||te[R][L]===7||te[$][C]===1||te[$][C]===7||te[$][L]===1||te[$][L]===7)return!0;const ne=["CAR","LOCKER","BED"];for(const z of g.current)if(z.active&&ne.includes(z.type)&&Math.hypot(l-z.x,x-z.y)<w/2+z.width/2)return!0;return!b&&(te[R][C]===3||te[R][L]===3||te[$][C]===3||te[$][L]===3)?c.current.keys>=12?(n("VICTORY"),!1):(s(W=>({...W,message:"NEED 12 KEYS"})),!0):!1},T=()=>{const l=c.current;if(l.battery=Math.max(0,l.battery-Aa),l.battery<=0){n("GAME_OVER");return}if(l.battery<20&&Math.random()<.05?(l.isFlickering=!0,Z.getInstance().playBuzz(.1)):Date.now()-I.current<200?l.isFlickering=Math.random()<.5:l.isFlickering=!1,Math.random()<.001&&l.noise>.1&&!l.isHidden){const w=l.x-Math.cos(l.yaw)*60,b=l.y-Math.sin(l.yaw)*60;g.current.push({id:`ghost_${Date.now()}`,type:"SHADOW",x:w,y:b,width:30,height:60,active:!0}),setTimeout(()=>{const C=g.current.findIndex(L=>L.type==="SHADOW"&&L.id.startsWith("ghost"));C!==-1&&g.current.splice(C,1)},200)}},B=()=>{const l=c.current;if(l.attackTimer>0&&(l.attackTimer-=1e3/60),P.current<2||k.current.active)return;if(l.isHidden){l.noise=0;return}const x=l.yaw,w=Math.cos(x),b=Math.sin(x),C=Math.cos(x+Math.PI/2),L=Math.sin(x+Math.PI/2);let R=0,$=0;const ne=h.current[a.RUN],z=h.current[a.SNEAK];l.isCrouching=!!z;let W=yt;ne&&(W=ka),z&&(W=Ta),(h.current[a.MOVE_FORWARD]||h.current.ArrowUp)&&(R+=w*W,$+=b*W),(h.current[a.MOVE_BACKWARD]||h.current.ArrowDown)&&(R-=w*W,$-=b*W),(h.current[a.MOVE_LEFT]||h.current.ArrowLeft)&&(R-=C*W,$-=L*W),(h.current[a.MOVE_RIGHT]||h.current.ArrowRight)&&(R+=C*W,$+=L*W),f(l.x+R,l.y,l.width)||(l.x+=R),f(l.x,l.y+$,l.width)||(l.y+=$);const ue=Math.abs(R)+Math.abs($)>.1;let Q=0;if(ue&&(ne?Q=Da:z?Q=Pa:Q=Oa),l.noise=Math.max(0,l.noise-Ga),l.noise=Math.max(l.noise,Q),ue){z&&Z.getInstance().playBreathing();const q=ne?300:z?700:500;if(Date.now()-N.current>q){let je=l.y>360?"WOOD":"DIRT";je==="DIRT"&&Math.random()<.3&&(je="WATER");const ce=z?.2:1;Z.getInstance().playFootstep(je,ce),N.current=Date.now()}}!M.current&&l.y>340&&l.y<450&&(M.current=!0,g.current.push({id:"shadow_event",type:"SHADOW",x:350,y:380,width:30,height:60,active:!0}),u.current.active=!0,u.current.x=800,u.current.y=800,u.current.state="IDLE"),g.current.forEach(q=>{q.active&&q.type==="KEY"&&Math.hypot(q.x-l.x,q.y-l.y)<et+q.width&&(q.active=!1,l.keys++,Z.getInstance().playItemDrop(),s(ce=>({...ce,message:"KEY FOUND"})))})},F=()=>{const l=u.current;if(!l.active||k.current.active||p.current.active)return;if(c.current.isHidden){l.state="IDLE";return}const x=c.current,w=Math.hypot(x.x-l.x,x.y-l.y),b=Z.getInstance();l.footstepTimer++;const C=l.x-x.x,L=l.y-x.y;let $=Math.atan2(L,C)-x.yaw;for(;$>Math.PI;)$-=2*Math.PI;for(;$<-Math.PI;)$+=2*Math.PI;const ne=Math.abs($)<De/1.5;if(x.flashlightOn&&ne&&w<400){if(l.stareTimer++,l.stareTimer>Ha&&l.state==="STALKING"){l.state="IDLE",l.x=-1e3,l.y=-1e3,l.invisible=!0,l.stareTimer=0,s(q=>({...q,message:"IT FLED"}));return}}else l.stareTimer=Math.max(0,l.stareTimer-1);let W=l.x,ue=l.y,Q=0;if(l.state==="IDLE")Math.random()<.01&&(l.state="STALKING"),x.noise>Ba&&w<600&&(l.state="HUNTING",l.invisible=!1);else if(l.state==="STALKING"){if(l.invisible=!0,l.teleportCooldown--,l.teleportCooldown<=0&&!ne&&w>Fa){const je=x.yaw+Math.PI+(Math.random()-.5),ce=Ua+Math.random()*100;l.x=x.x+Math.cos(je)*ce,l.y=x.y+Math.sin(je)*ce,l.teleportCooldown=200,b.playDrone()}Q=Ma;const q=Math.atan2(x.y-l.y,x.x-l.x);W=l.x+Math.cos(q)*Q,ue=l.y+Math.sin(q)*Q,w<200?(l.footstepTimer>60&&(b.playGhostFootstep("SOFT"),l.footstepTimer=0),Math.random()<.02&&(l.state="HUNTING",l.invisible=!1)):w<400&&l.footstepTimer>100&&(b.playGhostFootstep("SOFT"),l.footstepTimer=0)}else if(l.state==="HUNTING"){l.invisible=!1,Q=Ca;const q=Math.atan2(x.y-l.y,x.x-l.x);W=l.x+Math.cos(q)*Q,ue=l.y+Math.sin(q)*Q,l.footstepTimer>25&&(b.playGhostFootstep("HEAVY"),l.footstepTimer=0),w>700&&(l.state="IDLE")}if(Q>0){if(!f(W,l.y,l.width,!0))l.x=W;else{const q=l.y+(x.y>l.y?Q:-Q);f(l.x,q,l.width,!0)||(l.y=q)}if(!f(l.x,ue,l.width,!0))l.y=ue;else{const q=l.x+(x.x>l.x?Q:-Q);f(q,l.y,l.width,!0)||(l.x=q)}}!l.invisible&&w<25&&(p.current.active||(p.current={active:!0,startTime:Date.now()},Z.getInstance().playJumpScare()))},se=()=>{H.current++,P.current===0&&H.current>120&&(P.current=1,Z.getInstance().playBell()),P.current===1&&H.current>180&&(P.current=2,Z.getInstance().playCarCooling(),Z.getInstance().playFlashlightRoll()),P.current===3&&v.current%300===0&&Math.random()<.3&&Z.getInstance().playCarCooling();const l=g.current.findIndex(x=>x.type==="SHADOW"&&x.id==="shadow_event");if(l!==-1){const x=g.current[l];x.x+=12,x.x>800&&(x.active=!1,g.current.splice(l,1))}k.current.active&&Date.now()-k.current.timer>500&&(k.current.active=!1)},xe=()=>{A.current.forEach(l=>{l.y+=l.speed,l.y>720&&(l.y=-20,l.x=Math.random()*1280)})},Ce=l=>!!(l&&l.complete&&l.naturalWidth>0),ye=(l,x,w,b,C,L)=>{if(l.save(),L){const ne=(Math.random()-.5)*20,z=(Math.random()-.5)*20;l.translate(ne,z)}l.fillStyle="#111",l.beginPath(),l.ellipse(x+b/2,w+C/2,b/2,C/1.5,0,0,Math.PI*2),l.fill();const R=b/5,$=b/4;l.fillStyle="#ff0000",l.shadowBlur=L?50:10,l.shadowColor="red",l.beginPath(),l.ellipse(x+b/2-$,w+C/3,R,R*.7,Math.PI/6,0,Math.PI*2),l.fill(),l.beginPath(),l.ellipse(x+b/2+$,w+C/3,R,R*.7,-Math.PI/6,0,Math.PI*2),l.fill(),l.fillStyle="#300",l.shadowBlur=0,l.beginPath(),l.moveTo(x+b/2-R,w+C*.65),l.quadraticCurveTo(x+b/2,w+C*.85,x+b/2+R,w+C*.65),l.quadraticCurveTo(x+b/2,w+C*.55,x+b/2-R,w+C*.65),l.fill(),l.restore()},G=(l,x,w,b)=>{l.fillStyle="#111",l.fillRect(0,0,w,b/2+x.pitch*b);const C=l.createLinearGradient(0,b/2+x.pitch*b,0,b);C.addColorStop(0,"#0a0a0a"),C.addColorStop(1,"#2a2a2a"),l.fillStyle=C,l.fillRect(0,b/2+x.pitch*b,w,b/2-x.pitch*b);for(let L=0;L<Re;L++){const R=2*L/Re-1,$=Math.cos(x.yaw)+Math.cos(x.yaw+Math.PI/2)*Math.tan(De/2)*R,ne=Math.sin(x.yaw)+Math.sin(x.yaw+Math.PI/2)*Math.tan(De/2)*R;let z=Math.floor(x.x/X),W=Math.floor(x.y/X),ue,Q;const q=Math.abs(1/$),je=Math.abs(1/ne);let ce,Me,re,V=0,de=0;$<0?(Me=-1,ue=(x.x/X-z)*q):(Me=1,ue=(z+1-x.x/X)*q),ne<0?(re=-1,Q=(x.y/X-W)*je):(re=1,Q=(W+1-x.y/X)*je);let ee=0;for(;V===0;)ue<Q?(ue+=q,z+=Me,de=0):(Q+=je,W+=re,de=1),W>=0&&W<te.length&&z>=0&&z<te[0].length?(te[W][z]===1||te[W][z]===7)&&(V=1,ee=te[W][z]):V=1;de===0?ce=(z-x.x/X+(1-Me)/2)/$:ce=(W-x.y/X+(1-re)/2)/ne,E.current[L]=ce;const oe=Math.floor(b*2/ce),ve=b/2+x.pitch*b,Ne=-oe/2+ve,le=oe/2+ve;let ge=150;ee===7&&(ge=100),de===1&&(ge*=.75);const Ve=Math.min(1,4/ce),Bt=Math.floor(ge*Ve),$t=Math.floor(ge*Ve),Ht=Math.floor(ge*Ve),nt=Math.ceil(w/Re),Ut=L*nt;l.fillStyle=`rgb(${Bt},${$t},${Ht})`,l.fillRect(Ut,Ne,nt,le-Ne+1)}},Y=(l,x,w,b)=>{const C=g.current.filter(R=>R.active).map(R=>({...R,dist:Math.hypot(x.x-R.x,x.y-R.y)})).sort((R,$)=>$.dist-R.dist),L=u.current;L.active&&(!L.invisible||L.invisible&&L.state==="STALKING"&&Math.random()<.2)&&(C.push({...L,dist:Math.hypot(x.x-L.x,x.y-L.y)}),C.sort((R,$)=>$.dist-R.dist)),C.forEach(R=>{const $=R.x-x.x,ne=R.y-x.y,z=Math.cos(x.yaw+Math.PI/2)*Math.tan(De/2),W=Math.sin(x.yaw+Math.PI/2)*Math.tan(De/2),ue=Math.cos(x.yaw),Q=Math.sin(x.yaw),q=1/(z*Q-ue*W),je=q*(Q*$-ue*ne),ce=q*(-W*$+z*ne);if(ce<=0)return;const Me=Math.floor(w/2*(1+je/ce));let re=Math.abs(Math.floor(b/(ce/X)));const V=Math.abs(Math.floor(b/(ce/X)));R.type==="ENEMY"&&(re*=1.6);const de=b/2+x.pitch*b,ee=-re/2+de,we=Math.ceil(w/Re),oe=Math.floor(-V/2+Me),ve=Math.floor(Me/we);if(ve>=0&&ve<Re){const Ne=E.current[ve];if(ce/X<Ne){const le=Math.min(1,5/(ce/X));if(l.save(),l.globalAlpha=le,R.type==="ENEMY"){const ge=j.current.ghost;Ce(ge)?(l.globalAlpha=L.invisible?.1:le,l.drawImage(ge,oe,ee,V,re)):(l.fillStyle=L.invisible?"rgba(0,0,0,0.1)":`rgba(0,0,0,${le})`,ye(l,oe,ee,V,re,!1))}else if(R.type==="KEY")l.fillStyle=`rgb(${255*le},${215*le},0)`,l.beginPath(),l.arc(Me,ee+re/2,V/3,0,Math.PI*2),l.fill();else if(R.type==="BAT")l.fillStyle=`rgb(${150*le},${150*le},${150*le})`,l.fillRect(oe,ee,V,re),l.fillStyle=`rgb(${100*le},${50*le},0)`,l.fillRect(oe,ee+re*.7,V,re*.3);else if(R.type==="LOCKER"){const ge=R;l.fillStyle=ge.isOpen?"#444":"#666",l.fillRect(oe,ee-re/2,V,re*1.5)}else if(R.type==="BED"){const ge=j.current.bed;Ce(ge)?l.drawImage(ge,oe,ee+re/2,V,re/2):(l.fillStyle="#ccc",l.fillRect(oe,ee+re/2,V,re/2))}else if(R.type==="CAR")l.fillStyle="#557",l.fillRect(oe-V,ee,V*3,re/2);else if(R.type==="NOTE"){const ge=j.current.note;Ce(ge)?l.drawImage(ge,oe,ee+re*.8,V/2,re/4):(l.fillStyle="#fff",l.fillRect(oe,ee+re*.8,V/2,re/4))}l.restore()}}})},U=l=>{const x=l.canvas.width,w=l.canvas.height,b=c.current;if(p.current.active){l.fillStyle="#000",l.fillRect(0,0,x,w);const V=(Math.random()-.5)*50,de=(Math.random()-.5)*50,ee=1+Math.sin(Date.now()/50)*.05;l.save(),l.translate(x/2+V,w/2+de),l.scale(ee,ee);const we=j.current.ghost;if(Ce(we)){const oe=we.width/we.height,ve=x/w;let Ne,le;ve>oe?(Ne=x,le=x/oe):(le=w,Ne=w*oe),l.drawImage(we,-Ne/2,-le/2,Ne,le)}else ye(l,-x/2,-w/2,x,w,!0);l.restore(),Math.random()>.7&&(l.fillStyle="rgba(255, 0, 0, 0.2)",l.fillRect(0,0,x,w));return}G(l,b,x,w),Y(l,b,x,w);const C=Math.max(.2,b.battery/100),L=b.battery<20||b.isFlickering?Math.random()*.2:0,R=l.createRadialGradient(x/2,w/2,w/4*C,x/2,w/2,w*(.8+L));if(R.addColorStop(0,"rgba(0,0,0,0)"),R.addColorStop(.5,"rgba(0,0,0,0.3)"),R.addColorStop(1,"rgba(0,0,0,0.95)"),l.fillStyle=R,l.fillRect(0,0,x,w),b.hasBat&&!b.isHidden){l.save();const V=b.attackTimer>0?Math.sin(b.attackTimer/200*Math.PI)*200:0,de=b.attackTimer>0?-Math.PI/4:0;l.translate(x*.7+V,w),l.rotate(-Math.PI/6+de),l.fillStyle="#5d4037",l.fillRect(-20,-200,40,200),l.fillStyle="#9ca3af",l.fillRect(-25,-500,50,300),l.restore()}const $=150,ne=.15,z=30,W=150;l.save(),l.translate(z,W),l.fillStyle="rgba(0, 0, 0, 0.5)",l.fillRect(0,0,$,$),l.strokeStyle="rgba(255, 255, 255, 0.3)",l.lineWidth=2,l.strokeRect(0,0,$,$),l.beginPath(),l.rect(0,0,$,$),l.clip();const ue=$/2,Q=$/2,q=$/2/ne,je=Math.max(0,Math.floor((b.y-q)/X)),ce=Math.min(te.length,Math.ceil((b.y+q)/X)),Me=Math.max(0,Math.floor((b.x-q)/X)),re=Math.min(te[0].length,Math.ceil((b.x+q)/X));for(let V=je;V<ce;V++)for(let de=Me;de<re;de++){const ee=te[V][de];if(ee===0)continue;const we=de*X,oe=V*X,ve=ue+(we-b.x)*ne,Ne=Q+(oe-b.y)*ne,le=Math.max(1,X*ne);ee===1||ee===7?(l.fillStyle="#94a3b8",l.fillRect(ve,Ne,le,le)):ee===3?(l.fillStyle="#ef4444",l.fillRect(ve,Ne,le,le)):ee===4&&(l.fillStyle="#f59e0b",l.fillRect(ve,Ne,le,le))}if(l.save(),l.translate(ue,Q),l.rotate(b.yaw),l.fillStyle="#22c55e",l.beginPath(),l.moveTo(5,0),l.lineTo(-4,-4),l.lineTo(-4,4),l.fill(),l.restore(),l.restore(),b.isHidden&&(l.fillStyle="rgba(0,0,0,0.95)",l.fillRect(0,0,x,w),l.fillStyle="#fff",l.font="20px monospace",l.textAlign="center",l.fillText(b.hidingType==="BED"?"UNDER BED":"IN LOCKER",x/2,w/2)),k.current.active){const V=(Date.now()-k.current.timer)/200;V<1&&(l.fillStyle="black",l.fillRect(0,0,x,w),l.save(),l.translate(x/2+(Math.random()-.5)*20,w/2+(Math.random()-.5)*20),l.scale(2+V,2+V),l.fillStyle="#1a0000",l.beginPath(),l.ellipse(0,0,100,140,0,0,Math.PI*2),l.fill(),l.fillStyle="white",l.beginPath(),l.arc(-40,-20,15,0,Math.PI*2),l.arc(40,-20,15,0,Math.PI*2),l.fill(),l.fillStyle="black",l.beginPath(),l.arc(-40,-20,5,0,Math.PI*2),l.arc(40,-20,5,0,Math.PI*2),l.fill(),l.restore())}if(o){l.fillStyle="rgba(0,0,0,0.8)",l.fillRect(0,0,x,w),l.fillStyle="#fef3c7",l.fillRect(x/2-200,w/2-150,400,300),l.fillStyle="#000",l.font='20px "Special Elite", monospace',l.textAlign="center",l.textBaseline="middle";const V=o.split(" ");let de="",ee=w/2-100;for(let we=0;we<V.length;we++){const oe=de+V[we]+" ";l.measureText(oe).width>360&&we>0?(l.fillText(de,x/2,ee),de=V[we]+" ",ee+=30):de=oe}l.fillText(de,x/2,ee),l.font="14px monospace",l.fillStyle="#666",l.fillText("[PRESS E or ESC TO CLOSE]",x/2,w/2+130)}},ae=m.useCallback(()=>{if(t!=="PLAYING")return;if(o){const x=r.current;if(x){const w=x.getContext("2d");w&&U(w)}i.current=requestAnimationFrame(ae);return}if(p.current.active){if(Date.now()-p.current.startTime>3e3){n("GAME_OVER"),p.current.active=!1;return}const w=r.current;if(w){const b=w.getContext("2d");b&&U(b)}i.current=requestAnimationFrame(ae);return}se(),B(),F(),xe(),T();const l=r.current;if(l){const x=l.getContext("2d");x.imageSmoothingEnabled=!1,x&&U(x)}s({battery:c.current.battery,keysFound:c.current.keys,totalKeys:12,soundLevel:c.current.noise,message:""}),i.current=requestAnimationFrame(ae)},[t,o,a]);return m.useEffect(()=>(t==="PLAYING"&&(i.current=requestAnimationFrame(ae)),()=>cancelAnimationFrame(i.current)),[ae,t]),e.jsx("canvas",{ref:r,width:1280,height:720,className:"block w-full h-full bg-black cursor-none"})},Ka={MOVE_FORWARD:"Move Forward",MOVE_BACKWARD:"Move Backward",MOVE_LEFT:"Move Left",MOVE_RIGHT:"Move Right",RUN:"Sprint",SNEAK:"Sneak",INTERACT:"Interact",FLASHLIGHT:"Toggle Camera Light"},Ja=({gameState:t,stats:n,onStart:s,onRestart:a,keyBindings:r,setKeyBindings:i})=>{const[o,d]=m.useState(!1),[c,u]=m.useState(null),[g,h]=m.useState(0);m.useEffect(()=>{let v;return t==="PLAYING"&&(v=setInterval(()=>{h(M=>M+1)},1e3)),()=>clearInterval(v)},[t]);const N=v=>{const M=Math.floor(v/3600).toString().padStart(2,"0"),H=Math.floor(v%3600/60).toString().padStart(2,"0"),P=(v%60).toString().padStart(2,"0");return`${M}:${H}:${P}`},j=()=>{Z.getInstance().resume(),s()};m.useEffect(()=>{if(!c)return;const v=M=>{if(M.preventDefault(),M.stopPropagation(),M.key==="Escape"){u(null);return}i({...r,[c]:M.code}),u(null)};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[c,r,i]);const A=v=>v.replace("Key","").replace("Left","").replace("Right","").replace("Control","Ctrl");return t==="MENU"?o?e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/95 text-slate-100 z-[100] p-8 pointer-events-auto",children:e.jsxs("div",{className:"w-full max-w-2xl bg-slate-900 border border-slate-700 rounded-lg p-6 shadow-2xl relative",children:[e.jsx("button",{onClick:()=>{d(!1),u(null)},className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:e.jsx(zt,{size:32})}),e.jsxs("h2",{className:"text-3xl font-bold mb-6 flex items-center gap-3 text-red-500",style:{fontFamily:"Special Elite"},children:[e.jsx(Kt,{size:32})," CONTROLS"]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.keys(r).map(v=>e.jsxs("div",{className:"flex items-center justify-between bg-black/50 p-3 rounded border border-slate-800",children:[e.jsx("span",{className:"text-slate-300 font-mono text-sm uppercase",children:Ka[v]}),e.jsx("button",{onClick:()=>u(v),className:`px-4 py-1 rounded font-bold min-w-[100px] text-center transition-colors border ${c===v?"bg-red-600 border-red-400 text-white animate-pulse":"bg-slate-800 border-slate-600 text-slate-200 hover:bg-slate-700"}`,children:c===v?"PRESS KEY...":A(r[v])})]},v))}),e.jsx("div",{className:"mt-8 text-center text-slate-500 text-sm",children:"Click a button to rebind. Press ESC to cancel."})]})}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/90 text-slate-100 z-[100] pointer-events-auto",children:[e.jsx("h1",{className:"text-8xl font-bold tracking-widest text-red-600 mb-4 animate-pulse",style:{fontFamily:"Special Elite"},children:"LAST LIGHT"}),e.jsx("p",{className:"text-xl mb-8 max-w-md text-center text-slate-400",children:"Find 12 keys to escape. Keep your flashlight charged. Don't look at it."}),e.jsxs("div",{className:"flex flex-col gap-4 w-64",children:[e.jsx("button",{onClick:j,className:"bg-red-900/50 border-2 border-red-600 hover:bg-red-800 text-white py-3 rounded text-xl font-bold transition-all hover:scale-105",children:"ENTER DARKNESS"}),e.jsxs("button",{onClick:()=>d(!0),className:"bg-slate-800 border border-slate-600 hover:bg-slate-700 text-slate-300 py-2 rounded flex items-center justify-center gap-2",children:[e.jsx(St,{size:18})," CONTROLS"]})]})]}):t==="GAME_OVER"?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black z-[100] pointer-events-auto animate-in fade-in duration-1000",children:[e.jsx("div",{className:"scale-150 mb-12",children:e.jsx("h1",{className:"text-9xl font-serif text-red-900 tracking-widest opacity-80",style:{textShadow:"0 0 20px rgba(255,0,0,0.5)"},children:"YOU DIED"})}),e.jsx("button",{onClick:a,className:"mt-8 text-slate-400 hover:text-white border-b border-transparent hover:border-white transition-colors text-xl",children:"TRY AGAIN"})]}):t==="VICTORY"?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-white text-black z-[100] pointer-events-auto animate-in fade-in duration-[3000ms]",children:[e.jsx("h1",{className:"text-6xl font-bold mb-4",children:"ESCAPED"}),e.jsx("p",{className:"text-2xl mb-8",children:"You found the light."}),e.jsx("button",{onClick:a,className:"bg-black text-white px-8 py-3 rounded hover:scale-105 transition-transform",children:"PLAY AGAIN"})]}):e.jsxs("div",{className:"absolute inset-0 pointer-events-none p-6 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-500 text-2xl drop-shadow-md",children:[e.jsx(Jt,{size:32}),e.jsxs("span",{className:"font-mono font-bold",children:[Math.ceil(n.battery),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-yellow-500 text-2xl drop-shadow-md",children:[e.jsx(Xt,{size:32}),e.jsxs("span",{className:"font-mono font-bold",children:[n.keysFound,"/",n.totalKeys]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx("div",{className:"text-slate-500 font-mono text-xl",children:N(g)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{size:20,className:n.soundLevel>.5?"text-red-500":"text-slate-600"}),e.jsx("div",{className:"w-32 h-2 bg-slate-900 border border-slate-700",children:e.jsx("div",{className:"h-full bg-slate-200 transition-all duration-100",style:{width:`${Math.min(100,n.soundLevel*100)}%`}})})]})]})]}),n.message&&e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center",children:e.jsx("div",{className:"text-white font-mono text-xl bg-black/50 px-4 py-2 rounded border border-slate-700 animate-pulse",children:n.message})}),e.jsxs("div",{className:"text-slate-600 font-mono text-sm opacity-50",children:[A(r.FLASHLIGHT),": LIGHT | ",A(r.INTERACT),": INTERACT"]})]})};function Xa(){const[t,n]=m.useState("MENU"),[s,a]=m.useState(()=>{const c=localStorage.getItem("last_light_keys");return c?JSON.parse(c):qa});m.useEffect(()=>{localStorage.setItem("last_light_keys",JSON.stringify(s))},[s]);const[r,i]=m.useState({battery:100,keysFound:0,totalKeys:12,soundLevel:0,message:""}),o=()=>n("PLAYING"),d=()=>n("PLAYING");return e.jsxs("div",{className:"relative w-screen h-screen bg-slate-950 flex items-center justify-center overflow-hidden select-none",children:[e.jsx("div",{className:"scanlines mix-blend-overlay opacity-20 pointer-events-none w-full h-full absolute inset-0 z-50"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_transparent_0%,_#000000_100%)] pointer-events-none z-40"}),e.jsxs("div",{className:"relative w-full max-w-[1280px] aspect-video bg-black shadow-2xl border border-slate-900 overflow-hidden",children:[e.jsx(za,{gameState:t,setGameState:n,onStatsUpdate:i,keyBindings:s}),e.jsx(Ja,{gameState:t,stats:r,onStart:o,onRestart:d,keyBindings:s,setKeyBindings:a})]})]})}const Za=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[e.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),e.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),Qa=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),er=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[e.jsx("path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.75-2-2-2H4c-1.25 0-2 .75-2 2v6c0 7 4 8 7 8z"}),e.jsx("path",{d:"M14 21c3 0 7-1 7-8V5c0-1.25-.75-2-2-2h-4c-1.25 0-2 .75-2 2v6c0 7 4 8 7 8z"})]}),tr=({name:t,status:n,age:s,motto:a})=>e.jsxs("div",{className:"w-96 h-60 bg-white rounded-2xl shadow-lg p-8 flex flex-col justify-between transition-all duration-300 hover:shadow-2xl hover:-translate-y-1",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:t}),e.jsx("div",{className:"w-20 h-1 bg-slate-400 my-4 rounded-full"}),e.jsx("p",{className:"text-lg text-slate-600",children:n})]}),e.jsxs("div",{className:"flex items-center space-x-3 text-slate-500",children:[e.jsx(er,{className:"w-5 h-5 text-slate-400 flex-shrink-0"}),e.jsxs("p",{className:"text-sm italic",children:['"',a,'"']})]}),e.jsxs("footer",{className:"flex items-center space-x-6 text-slate-500",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qa,{className:"w-5 h-5 text-slate-400"}),e.jsxs("span",{className:"text-sm font-medium",children:[s," Years Old"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Za,{className:"w-5 h-5 text-slate-400"}),e.jsx("span",{className:"text-sm font-medium",children:"Student"})]})]})]}),sr=()=>{const t={name:"Derek Jang",status:"Student at WMS",age:15,motto:"오늘도 내일처럼 내일도 오늘처럼"};return e.jsx("main",{className:"min-h-screen bg-slate-100 flex items-center justify-center font-sans p-4",children:e.jsx(tr,{name:t.name,status:t.status,age:t.age,motto:t.motto})})};let ke=null;const ar=()=>{ke||(ke=new(window.AudioContext||window.webkitAudioContext)),ke.state==="suspended"&&ke.resume()},Ie=(t,n,s)=>{if(ar(),!ke)return;const a=ke.createOscillator(),r=ke.createGain();a.type=n,a.frequency.setValueAtTime(t,ke.currentTime),r.gain.setValueAtTime(0,ke.currentTime),r.gain.linearRampToValueAtTime(.1,ke.currentTime+.01),r.gain.exponentialRampToValueAtTime(.001,ke.currentTime+s),a.connect(r),r.connect(ke.destination),a.start(),a.stop(ke.currentTime+s)},pe={playSuccess:()=>{setTimeout(()=>Ie(523.25,"sine",.15),0),setTimeout(()=>Ie(659.25,"sine",.15),80),setTimeout(()=>Ie(783.99,"sine",.3),160)},playError:()=>{Ie(150,"sawtooth",.3),setTimeout(()=>Ie(140,"sawtooth",.3),50)},playClick:()=>{Ie(800,"triangle",.05)},playTick:()=>{Ie(1200,"sine",.03)},speak:(t,n=1)=>{if("speechSynthesis"in window){window.speechSynthesis.cancel();const s=new SpeechSynthesisUtterance(t);s.lang="en-US",s.rate=n;const r=window.speechSynthesis.getVoices().find(i=>i.name.includes("Google US English")||i.lang==="en-US"&&i.name.includes("Samantha"));r&&(s.voice=r),window.speechSynthesis.speak(s)}}},rr=()=>{const t="AIzaSyD24laq21PKbAI-8TvBOlvM-FP6kV-NmY4";return new _e({apiKey:t})},nr=async()=>{const t=rr(),n="Generate a list of 10 English vocabulary words for a middle school student. For each word, provide: 1. The English term. 2. A Korean definition. 3. A short, simple English example sentence. 4. A 'mnemonic' (story) in Korean that helps memorize the word using pronunciation associations or logic (e.g. 'Stalactite' -> 'C' for Ceiling -> 천장에 붙은 종유석).";try{const s=await t.models.generateContent({model:"gemini-2.5-flash",contents:n,config:{responseMimeType:"application/json",responseSchema:{type:K.ARRAY,items:{type:K.OBJECT,properties:{term:{type:K.STRING},definition:{type:K.STRING},example:{type:K.STRING},mnemonic:{type:K.STRING}},required:["term","definition","example","mnemonic"]}}}});return JSON.parse(s.text||"[]").map((r,i)=>({id:`gen-${Date.now()}-${i}`,term:r.term,definition:r.definition,example:r.example,mnemonic:r.mnemonic,status:"new"}))}catch(s){return console.error("Error generating words:",s),[]}},lr=({onWordsLoaded:t,onStartWrongReview:n,wrongWordsCount:s,isReverse:a,onToggleReverse:r})=>{const[i,o]=m.useState(!1),[d,c]=m.useState(!1),[u,g]=m.useState(""),h=()=>{const M="AIzaSyD24laq21PKbAI-8TvBOlvM-FP6kV-NmY4";return new _e({apiKey:M})},N=async M=>{const H=h();if(!H)return M.map(I=>({...I,definition:"???"}));const P=`Translate these English words to Korean definitions. Return JSON array of strings. Words: ${M.map(I=>I.term).join(", ")}`;try{const I=await H.models.generateContent({model:"gemini-2.5-flash",contents:P,config:{responseMimeType:"application/json",responseSchema:{type:K.ARRAY,items:{type:K.STRING}}}}),k=JSON.parse(I.text||"[]");return M.map((p,E)=>({term:p.term,definition:k[E]||"뜻 검색 실패"}))}catch(I){return console.error(I),M.map(k=>({...k,definition:"자동 번역 실패"}))}},j=async M=>{const H=M.split(`
`);let P=[];if(H.forEach(k=>{let p=k.trim();if(!p||(p=p.replace(/^\d+[\.\)\s]+\s*/,""),!p))return;let E=[],_=!1,O="",D=!1;for(let f=0;f<p.length;f++){const T=p[f];if(T==='"'){_=!_;continue}!_&&(T===","||T==="	"||T==="|"||T===":"&&!O.match(/^\d/))||!_&&(T==="-"||T==="=")&&E.length===0&&O.length>0?(E.push(O.trim()),O="",D=!0):O+=T}if(E.push(O.trim()),E=E.filter(f=>f!==""),!D&&E.length===1){const T=E[0].match(/^([a-zA-Z0-9\s\-\(\)\?]+)\s+([가-힣].*)$/);T&&(E=[T[1].trim(),T[2].trim()])}if(E.length===0)return;const y=E[0];y&&(E.length>=2?P.push({term:y,definition:E[1],mnemonic:E[2]||void 0,example:E[3]||void 0}):P.push({term:y}))}),P.length===0){pe.playError(),alert("유효한 단어를 찾지 못했습니다.");return}const I=P.filter(k=>!k.definition);if(I.length>0&&I.length===P.length){c(!0);try{const p=(await N(I)).map((E,_)=>({id:`uploaded-${_}-${Date.now()}`,term:E.term,definition:E.definition||"???",status:"new"}));pe.playSuccess(),t(p)}catch{alert("단어 뜻을 가져오는데 실패했습니다.")}finally{c(!1)}}else{const k=P.map((p,E)=>({id:`uploaded-${E}-${Date.now()}`,term:p.term,definition:p.definition||"???",mnemonic:p.mnemonic,example:p.example,status:"new"}));pe.playSuccess(),t(k)}},A=M=>{var P;const H=(P=M.target.files)==null?void 0:P[0];if(H){const I=new FileReader;I.onload=k=>{var E;const p=(E=k.target)==null?void 0:E.result;j(p)},I.readAsText(H)}},v=async()=>{c(!0),pe.playClick();try{const M=await nr();M.length>0&&(pe.playSuccess(),t(M))}catch{pe.playError(),alert("AI 생성 중 오류가 발생했습니다.")}finally{c(!1)}};return e.jsxs("div",{className:"max-w-2xl mx-auto p-6 space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 tracking-tighter filter drop-shadow-sm",children:"WORD SPARK"}),e.jsx("p",{className:"text-slate-500 font-medium",children:"뇌공학적 원리로 단어를 각인시키세요"})]}),s>0&&e.jsxs("button",{onClick:n,className:"w-full bg-gradient-to-r from-red-50 to-orange-50 border-2 border-red-100 p-5 rounded-2xl flex items-center justify-between hover:shadow-md hover:border-red-200 transition group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-red-500"}),e.jsxs("div",{className:"flex items-center gap-4 z-10",children:[e.jsx("div",{className:"bg-white p-3 rounded-full shadow-sm text-red-500 animate-pulse ring-2 ring-red-100",children:e.jsx(kt,{size:24,fill:"currentColor"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:"오답 감옥 (Prison)"}),e.jsxs("p",{className:"text-sm text-slate-500",children:[e.jsx("span",{className:"font-bold text-red-600 text-lg",children:s}),"개의 단어가 탈출을 기다립니다."]})]})]}),e.jsx("div",{className:"bg-white text-red-500 px-5 py-2 rounded-xl font-bold text-sm shadow-sm group-hover:scale-105 transition z-10 border border-red-100",children:"구출하기 →"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:()=>{pe.playClick(),r()},className:`flex items-center gap-3 px-8 py-3 rounded-full text-sm font-bold transition-all shadow-sm active:scale-95 ${a?"bg-purple-600 text-white ring-4 ring-purple-100 scale-105":"bg-white text-slate-600 border border-slate-200 hover:border-indigo-300 hover:bg-indigo-50"}`,children:[e.jsx(Zt,{size:16}),a?"모드: 뜻 보고 영어 말하기 (Hard)":"모드: 영어 보고 뜻 말하기 (Normal)"]})}),e.jsxs("div",{className:`relative border-4 border-dashed rounded-3xl p-10 text-center transition-all duration-300 cursor-pointer group ${i?"border-indigo-500 bg-indigo-50 scale-[1.02]":"border-slate-200 hover:border-indigo-300 hover:bg-slate-50"}`,onDragOver:M=>{M.preventDefault(),o(!0)},onDragLeave:()=>o(!1),onDrop:M=>{M.preventDefault(),o(!1);const H=M.dataTransfer.files[0];if(H){const P=new FileReader;P.onload=I=>{var k;return j((k=I.target)==null?void 0:k.result)},P.readAsText(H)}},children:[e.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20",accept:".txt,.csv",onChange:A}),e.jsxs("div",{className:"flex flex-col items-center gap-4 relative z-10 pointer-events-none",children:[e.jsx("div",{className:"bg-indigo-100 p-5 rounded-full text-indigo-600 group-hover:scale-110 transition-transform duration-300",children:e.jsx(Tt,{size:40})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-700",children:"파일 업로드"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:".txt, .csv, 엑셀 파일 등"}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 justify-center",children:[e.jsx("span",{className:"text-xs bg-slate-100 text-slate-500 px-2 py-1 rounded border border-slate-200",children:"1. apple 사과"}),e.jsx("span",{className:"text-xs bg-slate-100 text-slate-500 px-2 py-1 rounded border border-slate-200",children:"apple, 사과"}),e.jsx("span",{className:"text-xs bg-purple-50 text-purple-600 px-2 py-1 rounded border border-purple-100 font-medium",children:"1. apple (자동번역)"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-sm font-bold text-slate-600 flex items-center gap-2",children:[e.jsx(Qt,{size:16})," 직접 입력 / 붙여넣기"]}),e.jsxs("button",{onClick:v,disabled:d,className:"flex items-center gap-2 text-xs bg-gradient-to-r from-purple-500 to-pink-500 text-white px-4 py-2 rounded-full hover:opacity-90 transition shadow-md active:scale-95 disabled:opacity-50",children:[d?e.jsx("span",{className:"animate-spin",children:"⏳"}):e.jsx(Et,{size:14}),d?"AI가 생각 중...":"AI 자동 생성"]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("textarea",{className:"w-full h-40 p-5 rounded-2xl border border-slate-700 bg-slate-800 text-white placeholder:text-slate-500 focus:ring-4 focus:ring-indigo-500/30 focus:border-indigo-500 focus:outline-none resize-none text-base font-mono leading-relaxed transition-all shadow-inner",placeholder:`1. apple 사과
2. banana 바나나
3. spark
(복사 붙여넣기만 하면 알아서 정리해드립니다)`,value:u,onChange:M=>g(M.target.value)}),d&&e.jsx("div",{className:"absolute inset-0 bg-slate-900/50 rounded-2xl flex items-center justify-center backdrop-blur-sm",children:e.jsxs("div",{className:"text-white font-bold animate-pulse flex items-center gap-2",children:[e.jsx(lt,{className:"text-yellow-400"})," 단어 분석 및 생성 중..."]})})]}),e.jsxs("button",{onClick:()=>{pe.playClick(),j(u)},disabled:d,className:"w-full py-4 bg-slate-900 text-white rounded-2xl font-bold text-lg hover:bg-slate-800 transition active:scale-[0.98] shadow-lg hover:shadow-xl flex items-center justify-center gap-2 disabled:opacity-50",children:[e.jsx(lt,{size:20,className:"text-yellow-400"})," 학습 시작하기"]})]})]})},ir=({words:t,onComplete:n,isReverse:s,startIndex:a})=>{const[r,i]=m.useState(0),[o,d]=m.useState(!1),c=t[r],u=r/t.length*100,g=a+r,h=()=>{pe.playClick(),d(!o)},N=()=>{pe.playClick(),r<t.length-1?(d(!1),setTimeout(()=>i(M=>M+1),200)):n()},j=M=>{M.stopPropagation(),pe.speak(c.term)},A=s?c.definition:c.term,v=s?c.term:c.definition;return e.jsxs("div",{className:"flex flex-col h-full pt-6 pb-6 px-6 max-w-md mx-auto w-full",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold text-slate-400 mb-2",children:[e.jsx("span",{children:"PROGRESS"}),e.jsxs("span",{children:[r+1," / ",t.length]})]}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-500 ease-out",style:{width:`${u}%`}})})]}),e.jsx("div",{className:"flex-1 relative perspective-1000 mb-6 group cursor-pointer",onClick:h,children:e.jsxs("div",{className:`relative w-full h-full transition-all duration-500 transform-style-3d ${o?"rotate-y-180":""}`,children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full bg-white rounded-[2rem] shadow-[0_20px_60px_-15px_rgba(0,0,0,0.1)] border border-slate-100 backface-hidden flex flex-col items-center justify-center p-8",children:[e.jsxs("div",{className:"text-center w-full",children:[e.jsxs("div",{className:"inline-block bg-slate-100 text-slate-500 font-black text-sm px-3 py-1 rounded-full mb-6",children:["#",g]}),e.jsx("h2",{className:"text-4xl md:text-5xl font-black text-slate-900 mb-4 tracking-tight break-words leading-tight",children:A}),!s&&e.jsx("button",{onClick:j,className:"mt-2 p-4 bg-indigo-50 rounded-full text-indigo-600 hover:bg-indigo-100 transition-colors inline-flex items-center justify-center group-hover:scale-110 transform duration-300",children:e.jsx($e,{size:28})})]}),e.jsxs("div",{className:"absolute bottom-8 text-slate-400 text-sm font-bold flex items-center gap-2 animate-pulse",children:[e.jsx(Ct,{size:16})," 탭해서 뜻 보기"]})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-slate-900 text-white rounded-[2rem] shadow-[0_20px_60px_-15px_rgba(0,0,0,0.25)] backface-hidden rotate-y-180 flex flex-col items-center justify-center p-8",children:e.jsxs("div",{className:"text-center w-full",children:[e.jsx("div",{className:"inline-block bg-white/10 text-white/60 font-bold text-xs px-3 py-1 rounded-full mb-6 uppercase tracking-widest",children:"Answer"}),e.jsx("h2",{className:"text-3xl font-bold mb-6 break-words leading-snug",children:v}),s&&e.jsx("button",{onClick:j,className:"mb-6 p-3 bg-white/10 rounded-full text-white hover:bg-white/20 transition-colors inline-flex items-center justify-center",children:e.jsx($e,{size:24})}),e.jsxs("div",{className:"w-full bg-white/10 rounded-xl p-4 backdrop-blur-sm text-left mt-2",children:[c.mnemonic&&e.jsxs("div",{className:"mb-3 pb-3 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 text-xs font-bold mb-1",children:[e.jsx(es,{size:14})," MEMORY STORY"]}),e.jsx("p",{className:"text-sm leading-relaxed opacity-90 font-medium",children:c.mnemonic})]}),c.example?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 font-bold mb-1",children:"EXAMPLE"}),e.jsxs("p",{className:"text-sm italic opacity-80 leading-relaxed",children:['"',c.example,'"']})]}):e.jsx("div",{className:"text-center text-xs text-slate-500 py-1",children:"No example available"})]})]})})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:M=>{M.stopPropagation(),N()},className:"w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold text-lg shadow-lg hover:bg-indigo-700 transition-transform active:scale-95 flex items-center justify-center gap-2",children:["다음 카드 ",e.jsx(ts,{size:20})]})})]})},or=({words:t,onFinish:n,isReverse:s,startIndex:a})=>{const[r,i]=m.useState(0),[o,d]=m.useState(3),[c,u]=m.useState("ready"),[g,h]=m.useState([]),[N,j]=m.useState([]),A=m.useRef(null),v=t[r],M=a+r;m.useEffect(()=>(c==="playing"&&(d(3),A.current=setInterval(()=>{d(_=>_<=1?(A.current&&clearInterval(A.current),H(),0):(pe.playTick(),_-1))},1e3)),()=>{A.current&&clearInterval(A.current)}),[r,c]);const H=()=>{u("revealed"),pe.playError()},P=_=>{A.current&&clearInterval(A.current),_?(pe.playSuccess(),h([...g,v]),k()):(pe.playError(),u("revealed"))},I=()=>{j([...N,v]),k()},k=()=>{r<t.length-1?(u("playing"),i(_=>_+1)):n({correct:g,wrong:N})},p=s?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("span",{className:"text-slate-400 font-bold text-xl mb-4",children:["#",M]}),e.jsx("h2",{className:"text-4xl font-bold text-slate-800 mb-6 tracking-tight leading-tight text-center",children:v.definition})]}):e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("span",{className:"text-slate-400 font-bold text-xl mb-4",children:["#",M]}),e.jsx("h2",{className:"text-5xl font-black text-slate-800 mb-6 tracking-tight leading-tight text-center",children:v.term})]}),E=s?e.jsxs("div",{className:"animate-fade-in-up text-center",children:[e.jsx("div",{className:"h-px w-12 bg-slate-200 mx-auto mb-6"}),e.jsx("p",{className:"text-3xl font-black text-indigo-600",children:v.term})]}):e.jsxs("div",{className:"animate-fade-in-up text-center",children:[e.jsx("div",{className:"h-px w-12 bg-slate-200 mx-auto mb-6"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:v.definition}),v.mnemonic&&e.jsxs("p",{className:"text-slate-500 mt-2 text-sm",children:['"',v.mnemonic,'"']})]});return c==="ready"?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[e.jsx("div",{className:"mb-6 bg-indigo-100 p-6 rounded-full text-indigo-600 animate-bounce",children:e.jsx(it,{size:48})}),e.jsx("h2",{className:"text-3xl font-black text-slate-800 mb-4",children:"3초 회상 테스트"}),e.jsx("p",{className:"text-slate-500 mb-2",children:s?"뜻을 보고 3초 안에 영단어를 떠올리세요!":"영단어를 보고 3초 안에 뜻을 떠올리세요!"}),e.jsx("button",{onClick:()=>{pe.playClick(),u("playing")},className:"w-full mt-6 py-4 bg-indigo-600 text-white rounded-2xl font-bold text-lg shadow-lg hover:bg-indigo-700 transition",children:"START!"})]}):e.jsxs("div",{className:"flex flex-col h-full pt-10 pb-6 px-6 max-w-md mx-auto w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10",children:[e.jsxs("div",{className:"text-slate-400 font-medium text-sm",children:[r+1," / ",t.length]}),e.jsxs("div",{className:`flex items-center gap-2 font-mono font-bold text-xl ${o<=1?"text-red-500":"text-slate-700"}`,children:[e.jsx(it,{size:20})," ",o,"s"]})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center",children:e.jsxs("div",{className:"w-full px-4",children:[p,c==="revealed"&&E]})}),e.jsx("div",{className:"mt-10 grid grid-cols-2 gap-4",children:c==="playing"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>P(!1),className:"bg-slate-100 text-slate-600 py-4 rounded-2xl font-bold hover:bg-slate-200 transition active:scale-95",children:"모르겠어요"}),e.jsx("button",{onClick:()=>P(!0),className:"bg-indigo-600 text-white py-4 rounded-2xl font-bold shadow-lg hover:bg-indigo-700 transition active:scale-95",children:"알아요!"})]}):e.jsxs("button",{onClick:I,className:"col-span-2 bg-slate-900 text-white py-4 rounded-2xl font-bold hover:bg-slate-800 transition flex items-center justify-center gap-2",children:["오답 확인하고 계속하기 ",e.jsx(ss,{size:18})]})})]})},wt=10,cr=()=>{const[t,n]=m.useState([]),[s,a]=m.useState(0),[r,i]=m.useState(J.HOME),[o,d]=m.useState(null),[c,u]=m.useState([]),[g,h]=m.useState(!1),N=p=>{const E=[];for(let _=0;_<p.length;_+=wt)E.push({id:_,words:p.slice(_,_+wt),isUnlocked:_===0});n(E),a(0),i(J.STUDY)},j=()=>{if(c.length===0)return;const p={id:999,words:[...c],isUnlocked:!0};n([p]),a(0),i(J.WRONG_REVIEW)},A=()=>{i(J.TEST)},v=p=>{d(p),u(E=>{const _=[...E,...p.wrong];return Array.from(new Map(_.map(O=>[O.id,O])).values())}),(r===J.WRONG_REVIEW||r===J.TEST)&&p.correct.length>0&&u(E=>E.filter(_=>!p.correct.some(O=>O.id===_.id))),pe.playSuccess(),i(J.RESULT)},M=()=>{const p=s+1;if(p<t.length){const E=[...t];E[p].isUnlocked=!0,n(E),a(p),d(null),i(J.STUDY)}else alert("모든 단어 학습을 완료했습니다! 훌륭해요!"),i(J.HOME)},H=()=>{if(o&&o.wrong.length>0){const p={id:(I==null?void 0:I.id)||0,words:o.wrong,isUnlocked:!0};n([p]),a(0),pe.playClick(),i(J.STUDY)}},P=()=>{confirm("홈으로 돌아가시겠습니까? 현재 진행 상황이 초기화될 수 있습니다.")&&i(J.HOME)},I=t[s],k=(I==null?void 0:I.id)===999?1:((I==null?void 0:I.id)||0)+1;return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center font-sans",children:e.jsxs("div",{className:"w-full max-w-lg h-screen md:h-[850px] bg-white md:rounded-[2.5rem] shadow-2xl overflow-hidden relative flex flex-col",children:[r!==J.HOME&&e.jsxs("div",{className:"bg-white/80 backdrop-blur-md z-10 p-4 flex justify-between items-center border-b border-slate-100",children:[e.jsx("button",{onClick:P,className:"p-2 text-slate-400 hover:text-slate-600",children:e.jsx(as,{size:20})}),e.jsx("span",{className:"font-bold text-indigo-600 flex items-center gap-1",children:r===J.WRONG_REVIEW?e.jsxs(e.Fragment,{children:[e.jsx(kt,{size:18})," PRISON BREAK"]}):e.jsxs(e.Fragment,{children:[e.jsx(Et,{size:18})," SET ",s+1]})}),e.jsx("div",{className:"text-xs font-medium text-slate-400 bg-slate-100 px-2 py-1 rounded-full",children:r===J.STUDY||r===J.WRONG_REVIEW?"LEARNING":r===J.TEST?"TESTING":"RESULT"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[r===J.HOME&&e.jsx(lr,{onWordsLoaded:N,onStartWrongReview:j,wrongWordsCount:c.length,isReverse:g,onToggleReverse:()=>h(!g)}),(r===J.STUDY||r===J.WRONG_REVIEW)&&I&&e.jsx(ir,{words:I.words,onComplete:A,isReverse:g,startIndex:k}),r===J.TEST&&I&&e.jsx(or,{words:I.words,onFinish:v,isReverse:g,startIndex:k}),r===J.RESULT&&o&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center animate-fade-in",children:[e.jsx("div",{className:"bg-yellow-100 p-6 rounded-full text-yellow-500 mb-6 animate-bounce",children:e.jsx(rs,{size:64})}),e.jsx("h2",{className:"text-3xl font-black text-slate-800 mb-2",children:"학습 완료!"}),e.jsxs("p",{className:"text-slate-500 mb-8",children:[o.correct.length,"개 기억함 / ",o.wrong.length,"개 놓침"]}),e.jsxs("div",{className:"w-full space-y-3",children:[o.wrong.length>0?e.jsxs("button",{onClick:H,className:"w-full py-4 bg-red-50 text-red-600 rounded-2xl font-bold text-lg hover:bg-red-100 transition flex items-center justify-center gap-2",children:[e.jsx(ns,{size:20})," 틀린 단어 바로 재시험"]}):e.jsx("div",{className:"text-indigo-600 font-bold py-2",children:"완벽해요! 스파크가 튀었네요! 🎉"}),r!==J.WRONG_REVIEW&&s<t.length-1&&e.jsxs("button",{onClick:M,className:"w-full py-4 bg-slate-900 text-white rounded-2xl font-bold text-lg shadow-lg hover:bg-slate-800 transition",children:["다음 세트 열기 (",s+2," SET)"]}),e.jsx("button",{onClick:()=>i(J.HOME),className:"w-full py-4 text-slate-400 font-bold hover:text-slate-600 transition",children:"홈으로 돌아가기"})]})]})]}),e.jsx("div",{className:"h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"})]})})},he=new(window.AudioContext||window.webkitAudioContext),Fe=()=>{he.state==="suspended"&&he.resume();const t=he.createOscillator(),n=he.createGain();t.type="sine",t.frequency.setValueAtTime(800,he.currentTime),t.frequency.exponentialRampToValueAtTime(400,he.currentTime+.1),n.gain.setValueAtTime(.1,he.currentTime),n.gain.exponentialRampToValueAtTime(.01,he.currentTime+.1),t.connect(n),n.connect(he.destination),t.start(),t.stop(he.currentTime+.1)},dr=()=>{he.state==="suspended"&&he.resume();const t=he.createOscillator(),n=he.createGain();t.type="triangle",t.frequency.setValueAtTime(300,he.currentTime),n.gain.setValueAtTime(.05,he.currentTime),n.gain.linearRampToValueAtTime(0,he.currentTime+.15),t.connect(n),n.connect(he.destination),t.start(),t.stop(he.currentTime+.15)},mr=t=>{if("speechSynthesis"in window){window.speechSynthesis.cancel();const n=new SpeechSynthesisUtterance(t);n.lang="en-US",n.rate=.9,window.speechSynthesis.speak(n)}},xr=({onWordsLoaded:t})=>{const n=m.useCallback(s=>{var i;Fe();const a=(i=s.target.files)==null?void 0:i[0];if(!a)return;const r=new FileReader;r.onload=o=>{var g;let d=(g=o.target)==null?void 0:g.result;d.charCodeAt(0)===65279&&(d=d.slice(1));const c=d.split(/\r?\n/),u=[];c.forEach((h,N)=>{if(!h.trim())return;const j=h.replace(/"/g,"");let A=[];j.includes("	")?A=j.split("	"):j.includes(",")?A=j.split(","):A=j.split(";"),A=A.map(I=>I.trim());let v="",M="";const H=/^[0-9]+[\.]?$/.test(A[0]);A.length>=3&&H?(v=A[1],M=A[2]):A.length>=2&&(v=A[0],M=A[1]);const P=["word","term","english","no","number","단어","순서","뜻","의미","meaning"].includes(v.toLowerCase());v&&M&&!P&&u.push({id:`word-${Date.now()}-${N}`,term:v,definition:M,isMemorized:!1,status:"new"})}),u.length>0?t(u):alert(`단어를 인식할 수 없습니다. 파일 형식을 확인해주세요.
(예시: apple, 사과  또는  1, apple, 사과)`)},r.readAsText(a)},[t]);return e.jsx("div",{className:"w-full max-w-md p-8 bg-white rounded-3xl shadow-sm border-2 border-dashed border-blue-200 text-center hover:border-blue-400 transition-colors cursor-pointer group",children:e.jsxs("label",{className:"cursor-pointer flex flex-col items-center",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-full mb-4 group-hover:bg-blue-100 transition-colors",children:e.jsx(Tt,{className:"w-8 h-8 text-blue-500"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-700 mb-2",children:"단어장 파일 업로드"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"CSV, 엑셀(csv저장) 파일"}),e.jsx("input",{type:"file",accept:".csv, .txt",onChange:n,className:"hidden"}),e.jsxs("div",{className:"flex flex-col gap-2 text-xs text-slate-400 bg-slate-50 px-4 py-3 rounded-xl text-left w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium text-slate-500 mb-1",children:[e.jsx(ls,{size:12}),e.jsx("span",{children:"지원 형식"})]}),e.jsx("div",{children:"1. apple, 사과"}),e.jsx("div",{children:"2. 1, apple, 사과 (번호 자동 제외)"})]})]})})},hr=({block:t,onStart:n})=>{const s=t.status==="locked",a=t.status==="completed",r=()=>{s||(Fe(),n(t.id))};return e.jsxs("div",{onClick:r,className:`
        relative overflow-hidden rounded-2xl p-6 transition-all duration-300
        ${s?"bg-slate-100 opacity-70 cursor-not-allowed":"bg-white cursor-pointer hover:shadow-lg hover:-translate-y-1"}
        ${t.status==="in-progress"?"ring-2 ring-blue-400":""}
      `,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:`
          w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold
          ${a?"bg-green-100 text-green-600":"bg-blue-50 text-blue-600"}
        `,children:t.id}),s&&e.jsx(is,{className:"text-slate-400",size:20}),a&&e.jsx(os,{className:"text-green-500",size:24}),!s&&!a&&e.jsx(cs,{className:"text-blue-400",size:24})]}),e.jsxs("h3",{className:"text-slate-800 font-bold text-lg mb-1",children:["Block ",t.id]}),e.jsxs("p",{className:"text-slate-500 text-sm",children:[t.words.length," Words"]}),t.status==="in-progress"&&e.jsx("div",{className:"mt-4 h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-400 w-1/3"})})]})},ur=({block:t,onComplete:n,onBack:s})=>{const[a,r]=m.useState(0),[i,o]=m.useState(!1),d=t.words[a],c=(a+1)/t.words.length*100;m.useEffect(()=>{o(!1)},[a]);const u=()=>{dr(),o(!i)},g=N=>{N==null||N.stopPropagation(),Fe(),a<t.words.length-1?r(j=>j+1):n()},h=N=>{N.stopPropagation(),Fe(),mr(d.term)};return e.jsxs("div",{className:"flex flex-col items-center w-full max-w-md mx-auto h-full",children:[e.jsxs("div",{className:"w-full flex items-center justify-between mb-6 px-4",children:[e.jsx("button",{onClick:s,className:"text-slate-400 hover:text-slate-600 p-2",children:e.jsx(ds,{size:24})}),e.jsx("div",{className:"flex-1 mx-4 h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-500 ease-out",style:{width:`${c}%`}})}),e.jsxs("span",{className:"text-sm font-bold text-slate-500 w-10 text-right",children:[a+1,"/",t.words.length]})]}),e.jsx("div",{className:"w-full px-4 mb-8 perspective-1000 flex-1 flex items-center justify-center",children:e.jsx("div",{onClick:u,className:`
            relative w-full aspect-[4/5] max-h-[500px] cursor-pointer card-flip
            ${i?"flipped":""}
          `,children:e.jsxs("div",{className:"card-inner w-full h-full relative shadow-xl rounded-3xl transition-all duration-500",children:[e.jsxs("div",{className:"card-front absolute w-full h-full bg-white rounded-3xl flex flex-col items-center justify-center p-8 border border-slate-100",children:[e.jsx("span",{className:"text-xs font-bold text-blue-500 uppercase tracking-wider mb-8",children:"English Term"}),e.jsx("h2",{className:`font-bold text-slate-800 text-center mb-8 break-words w-full leading-tight ${d.term.length>12?"text-3xl":"text-4xl"}`,children:d.term}),e.jsx("button",{onClick:h,className:"w-16 h-16 rounded-full bg-blue-50 text-blue-500 hover:bg-blue-100 hover:scale-110 transition-all flex items-center justify-center shadow-sm",children:e.jsx($e,{size:32})}),e.jsxs("div",{className:"absolute bottom-8 text-slate-300 text-sm flex items-center gap-2",children:[e.jsx(Ct,{size:14}),e.jsx("span",{children:"Tap to flip"})]})]}),e.jsxs("div",{className:"card-back absolute w-full h-full bg-slate-800 rounded-3xl flex flex-col items-center justify-center p-8 text-white border border-slate-700",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-6",children:"Definition"}),e.jsx("h2",{className:"text-3xl font-bold text-center break-words leading-relaxed",children:d.definition})]})]})})}),e.jsx("div",{className:"w-full px-4 mb-6",children:e.jsxs("button",{onClick:g,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 rounded-2xl shadow-lg shadow-blue-200 active:scale-95 transition-all flex items-center justify-center gap-2",children:[e.jsx("span",{children:a===t.words.length-1?"Finish Block":"Next Word"}),e.jsx(ms,{size:20})]})})]})},tt=10,pr=t=>{const n=[];for(let s=0;s<t.length;s+=tt)n.push({id:Math.floor(s/tt)+1,words:t.slice(s,s+tt),status:s===0?"ready":"locked"});return n},fr=()=>{const[t,n]=m.useState([]),[s,a]=m.useState([]),[r,i]=m.useState(J.HOME),[o,d]=m.useState(null),c=h=>{n(h);const N=pr(h);a(N)},u=h=>{a(N=>N.map(j=>j.id===h?{...j,status:"in-progress"}:j)),d(h),i(J.STUDY)},g=()=>{o&&(a(h=>h.map(N=>N.id===o?{...N,status:"completed"}:N.id===o+1?{...N,status:"ready"}:N)),i(J.HOME),d(null))};return e.jsxs("div",{className:"min-h-screen flex flex-col max-w-md mx-auto bg-[#F0F4F8] relative shadow-2xl",children:[e.jsxs("header",{className:"bg-white/80 backdrop-blur-md sticky top-0 z-10 px-6 py-4 flex justify-between items-center border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(xs,{size:20})}),e.jsx("h1",{className:"font-bold text-lg tracking-tight",children:"TEN BLOCK"})]}),e.jsx("button",{className:"text-slate-400 hover:text-slate-600",children:e.jsx(St,{size:20})})]}),e.jsxs("main",{className:"flex-1 p-6 flex flex-col",children:[r===J.HOME&&e.jsx(e.Fragment,{children:t.length===0?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center gap-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"시작해볼까요?"}),e.jsx("p",{className:"text-slate-500",children:"10개씩 쪼개서 외우면 금방 외워요!"})]}),e.jsx(xr,{onWordsLoaded:c})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"나의 단어장"}),e.jsxs("p",{className:"text-slate-500 text-sm",children:[s.filter(h=>h.status==="completed").length," / ",s.length," Blocks 완료"]})]}),e.jsx("button",{onClick:()=>n([]),className:"text-xs text-blue-500 underline",children:"파일 변경"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:s.map(h=>e.jsx(hr,{block:h,onStart:u},h.id))})]})}),r===J.STUDY&&o&&e.jsx(ur,{block:s.find(h=>h.id===o),onComplete:g,onBack:()=>i(J.HOME)})]})]})},Rt=[{name:"USA",code:"US"},{name:"China",code:"CN"},{name:"India",code:"IN"},{name:"Brazil",code:"BR"},{name:"Russia",code:"RU"},{name:"Japan",code:"JP"},{name:"Germany",code:"DE"},{name:"United Kingdom",code:"GB"},{name:"France",code:"FR"},{name:"South Korea",code:"KR"},{name:"Canada",code:"CA"},{name:"Australia",code:"AU"}],gr=1440*60*1e3,at=[{id:"slow",name:"Standard",clicksPerSecond:5,price:"$0.99",intervalMs:200},{id:"fast",name:"Supercharged",clicksPerSecond:10,price:"$1.99",intervalMs:100},{id:"ludicrous",name:"Ludicrous Speed",clicksPerSecond:20,price:"$4.99",intervalMs:50}],br=10,Lt=523,vt={USA:{button:"bg-blue-600 hover:bg-blue-500",text:"text-white"},China:{button:"bg-red-600 hover:bg-red-500",text:"text-yellow-300"},India:{button:"bg-orange-500 hover:bg-orange-400",text:"text-white"},Brazil:{button:"bg-green-600 hover:bg-green-500",text:"text-yellow-300"},Russia:{button:"bg-red-600 hover:bg-red-500",text:"text-white"},Japan:{button:"bg-red-600 hover:bg-red-500",text:"text-white"},Germany:{button:"bg-yellow-500 hover:bg-yellow-400",text:"text-black"},"United Kingdom":{button:"bg-blue-700 hover:bg-blue-600",text:"text-white"},France:{button:"bg-blue-700 hover:bg-blue-600",text:"text-white"},"South Korea":{button:"bg-blue-500 hover:bg-blue-400",text:"text-red-500"},Canada:{button:"bg-red-600 hover:bg-red-500",text:"text-white"},Australia:{button:"bg-blue-800 hover:bg-blue-700",text:"text-white"},default:{button:"bg-yellow-500 hover:bg-yellow-400",text:"text-gray-900"}},qe=t=>{const n=t.toUpperCase().split("").map(s=>127397+s.charCodeAt(0));return String.fromCodePoint(...n)},_t=t=>({USA:"US",China:"CN",India:"IN",Brazil:"BR",Russia:"RU",Japan:"JP",Germany:"DE","United Kingdom":"GB",France:"FR","South Korea":"KR",Canada:"CA",Australia:"AU"})[t]||"AQ",yr=({onSelectCountry:t})=>{const[n,s]=m.useState(null),a=()=>{n&&t(n)};return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-950 p-6 text-center overflow-hidden",children:[e.jsxs("div",{className:"animate-fade-in-up",children:[e.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500 mb-4 tracking-tighter uppercase",children:"Global Click War"}),e.jsx("p",{className:"text-xl text-gray-400 mb-12 max-w-lg mx-auto font-medium",children:"Represent your nation in the ultimate worldwide tapping competition. Choose wisely — your allegiance is permanent."})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6 w-full max-w-5xl animate-fade-in-delayed",children:Rt.map(r=>e.jsxs("button",{onClick:()=>s(r),className:`flex flex-col items-center justify-center p-6 rounded-2xl transition-all duration-300 transform hover:scale-105 group border-2 ${(n==null?void 0:n.code)===r.code?"bg-yellow-500 border-yellow-400 text-gray-900 shadow-[0_0_30px_rgba(234,179,8,0.3)] ring-4 ring-yellow-400/20":"bg-gray-900/50 border-gray-800 text-white hover:bg-gray-800 hover:border-gray-700"}`,children:[e.jsx("span",{className:"text-6xl mb-3 group-hover:scale-110 transition-transform",children:qe(r.code)}),e.jsx("span",{className:"font-black text-xs uppercase tracking-widest",children:r.name})]},r.code))}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-gray-900 p-10 rounded-[2.5rem] shadow-2xl border border-gray-800 text-center max-w-md w-full relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-yellow-500 to-orange-500"}),e.jsx("div",{className:"text-9xl mb-6 drop-shadow-2xl",children:qe(n.code)}),e.jsxs("h2",{className:"text-3xl font-black mb-4 text-white uppercase tracking-tight",children:["Enlist for ",n.name,"?"]}),e.jsxs("p",{className:"text-gray-400 mb-8 leading-relaxed font-medium",children:["You are about to represent ",e.jsx("span",{className:"text-yellow-400 font-bold",children:n.name})," in the global arena. This decision is final. Are you ready to tap for glory?"]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:a,className:"w-full py-5 bg-gradient-to-r from-yellow-400 to-orange-500 text-gray-900 font-black rounded-2xl hover:from-yellow-300 hover:to-orange-400 transition-all shadow-xl shadow-yellow-500/20 uppercase tracking-[0.2em] text-sm",children:"Enter the War Room"}),e.jsx("button",{onClick:()=>s(null),className:"w-full py-4 bg-gray-800/50 text-gray-400 font-bold rounded-2xl hover:bg-gray-800 hover:text-white transition-colors uppercase tracking-widest text-[10px]",children:"Choose another nation"})]})]})}),e.jsx("style",{children:`
        @keyframes fade-in-up {
          from { opacity: 0; transform: translateY(30px); }
          to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in-up { animation: fade-in-up 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        .animate-fade-in-delayed { opacity: 0; animation: fade-in-up 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.3s forwards; }
        .animate-fade-in { animation: fade-in 0.3s ease-out forwards; }
      `})]})},Gt=({leaderboard:t,userCountry:n})=>{const s=Object.entries(t).sort(([,a],[,r])=>r-a);return e.jsxs("div",{className:"w-full max-w-md bg-gray-900/60 backdrop-blur-xl rounded-3xl p-6 shadow-2xl border border-gray-800 flex flex-col h-full max-h-[600px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[e.jsx("h2",{className:"text-xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500 uppercase tracking-widest",children:"Global Ranks"}),e.jsx("span",{className:"text-[10px] font-black text-gray-600 uppercase tracking-tighter",children:"Live Updates"})]}),e.jsx("div",{className:"space-y-2 overflow-y-auto pr-2 custom-scrollbar flex-grow",children:s.map(([a,r],i)=>e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-2xl transition-all duration-300 border ${a===n?"bg-yellow-500 border-yellow-400 text-gray-900 font-bold scale-[1.03] shadow-xl shadow-yellow-500/20":"bg-gray-800/40 border-gray-800 hover:border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:`text-xs font-black w-6 ${a===n?"text-gray-900/50":"text-gray-600"}`,children:["#",i+1]}),e.jsx("span",{className:"text-3xl drop-shadow-sm",children:qe(_t(a))}),e.jsx("span",{className:"text-sm font-black uppercase tracking-tight truncate max-w-[100px]",children:a})]}),e.jsx("span",{className:"text-lg font-black font-mono tracking-tighter",children:Math.floor(r).toLocaleString()})]},a))}),e.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #374151; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #4b5563; }
      `})]})},Ot=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),jr=({onPurchase:t,onClose:n,currentTier:s})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 p-8 rounded-lg shadow-2xl text-center max-w-lg w-full relative",children:[e.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors","aria-label":"Close store",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(Ot,{className:"w-8 h-8 text-yellow-400 mr-2"}),e.jsx("h2",{className:"text-3xl font-bold text-yellow-400",children:"Auto-Click Upgrades"})]}),e.jsx("p",{className:"text-gray-300 mb-8",children:"Purchase an auto-clicker to boost your nation's score automatically!"}),e.jsx("div",{className:"space-y-4",children:at.map(a=>e.jsxs("div",{className:`p-4 rounded-lg flex flex-col sm:flex-row items-center justify-between transition-all ${s===a.id?"bg-green-600 border-2 border-green-400":"bg-gray-700 hover:bg-gray-600"}`,children:[e.jsxs("div",{className:"text-left mb-4 sm:mb-0",children:[e.jsx("h3",{className:"text-xl font-bold",children:a.name}),e.jsxs("p",{className:"text-gray-300",children:[a.clicksPerSecond," clicks / second"]}),s===a.id&&e.jsx("p",{className:"text-sm font-bold text-white mt-1",children:"ACTIVE"})]}),e.jsx("button",{onClick:()=>t(a.id),disabled:s===a.id,className:"w-full sm:w-auto px-6 py-3 bg-yellow-500 text-gray-900 font-bold rounded-md hover:bg-yellow-400 transition-colors disabled:bg-gray-500 disabled:cursor-not-allowed disabled:text-gray-400",children:a.price})]},a.id))})]})}),wr=()=>{const[t,n]=m.useState(!0);return t?e.jsxs("div",{className:"w-full bg-gradient-to-r from-yellow-400 via-yellow-500 to-orange-500 p-3 text-center text-gray-900 font-bold relative shadow-lg",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold text-lg",children:"SPECIAL EVENT!"})," Achieve over 100,000 clicks for an exclusive reward!"]}),e.jsx("button",{onClick:()=>n(!1),className:"absolute top-1/2 right-4 -translate-y-1/2 text-gray-800 hover:text-black","aria-label":"Dismiss promotional message",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):null},vr=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),Nr=({x:t,y:n,id:s,value:a})=>e.jsxs("div",{className:"absolute text-yellow-400 font-black text-5xl pointer-events-none z-50 drop-shadow-[0_4px_8px_rgba(0,0,0,0.6)]",style:{left:`${t}px`,top:`${n}px`,transform:"translate(-50%, -50%)",animation:"click-float 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards"},children:["+",a]},s),Sr=({userCountry:t,userClicks:n,leaderboard:s,timeLeft:a,onIncrement:r,autoClickTier:i,onPurchaseTier:o,isGodModeActive:d,onToggleGodMode:c,isAutoClickEnabled:u,onToggleAutoClick:g})=>{const[h,N]=m.useState(!1),[j,A]=m.useState([]),v=m.useRef(null),M=Math.min(Lt,Math.floor(Math.sqrt(n/10))+1);m.useEffect(()=>{if(v.current&&(clearInterval(v.current),v.current=null),u){if(d)v.current=setInterval(()=>{r()},br);else if(i){const E=at.find(_=>_.id===i);E&&(v.current=setInterval(()=>{r()},E.intervalMs))}}return()=>{v.current&&clearInterval(v.current)}},[i,r,d,u]);const H=E=>{r();const _=E.currentTarget.getBoundingClientRect(),O=E.clientX-_.left,D=E.clientY-_.top,y=1+(M-1)*.05,f={x:O,y:D,id:Date.now(),value:y.toFixed(2)};A(T=>[...T,f]),setTimeout(()=>{A(T=>T.filter(B=>B.id!==f.id))},800)},P=Object.values(s).reduce((E,_)=>E+_,0),I=s[t]||0,k=i?at.find(E=>E.id===i):null,p=vt[t]||vt.default;return e.jsxs("div",{className:"flex flex-col min-h-screen bg-gray-950 text-white selection:bg-yellow-500 selection:text-gray-900",children:[e.jsx(wr,{}),e.jsxs("div",{className:"flex flex-col lg:flex-row items-stretch justify-center flex-grow p-4 lg:p-12 gap-12 max-w-7xl mx-auto w-full",children:[e.jsxs("div",{className:"flex flex-col items-center w-full lg:w-3/5 space-y-10",children:[e.jsxs("header",{className:"text-center animate-fade-in space-y-4",children:[e.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 tracking-tighter uppercase leading-none",children:"Global Click War"}),e.jsxs("div",{className:"inline-flex items-center gap-4 bg-gray-900 border border-gray-800 py-3 px-8 rounded-[2rem] shadow-2xl",children:[e.jsx("span",{className:"text-5xl drop-shadow-xl",children:qe(_t(t))}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-600 uppercase tracking-[0.2em] mb-0.5",children:"Your Nation"}),e.jsx("p",{className:"text-2xl font-black uppercase tracking-tight leading-none",children:t})]})]})]}),e.jsxs("div",{className:"w-full max-w-sm bg-gray-900/50 backdrop-blur p-6 rounded-[2rem] border border-gray-800 shadow-inner text-center",children:[e.jsx("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] mb-2",children:"Operation Window Ends In"}),e.jsxs("div",{className:"text-4xl font-mono font-black text-yellow-400 tabular-nums tracking-tight",children:[e.jsxs("span",{children:[String(a.days).padStart(2,"0"),"d "]}),e.jsxs("span",{children:[String(a.hours).padStart(2,"0"),"h "]}),e.jsxs("span",{children:[String(a.minutes).padStart(2,"0"),"m "]}),e.jsxs("span",{children:[String(a.seconds).padStart(2,"0"),"s"]})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-10 bg-gradient-to-br from-yellow-500 via-orange-500 to-red-600 rounded-full opacity-20 blur-3xl group-hover:opacity-40 transition-opacity animate-pulse"}),e.jsxs("button",{onClick:H,className:`relative w-72 h-72 md:w-96 md:h-96 rounded-full flex items-center justify-center font-black text-6xl shadow-2xl transform active:scale-90 active:rotate-2 transition-all duration-75 select-none overflow-hidden border-[12px] border-gray-950/80 ${p.button} ${p.text}`,children:["TAP",j.map(E=>e.jsx(Nr,{...E},E.id))]})]}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsxs("div",{className:"flex justify-center items-center gap-3",children:[e.jsx("span",{className:"text-gray-500 font-black uppercase tracking-widest text-[10px]",children:"Your Contribution"}),e.jsx("div",{className:"px-3 py-1 bg-yellow-500/10 border border-yellow-500/30 rounded-full",children:e.jsxs("span",{className:"text-[10px] text-yellow-500 font-black",children:["RANK LVL ",M]})})]}),e.jsx("p",{className:"text-7xl font-black font-mono tracking-tighter drop-shadow-lg text-white",children:Math.floor(n).toLocaleString()})]}),e.jsxs("div",{className:"flex flex-col items-center gap-6 w-full max-w-md",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full",children:[e.jsxs("button",{onClick:()=>N(!0),className:"flex flex-col items-center justify-center gap-2 p-6 bg-gray-900 rounded-3xl hover:bg-gray-800 transition-all border border-gray-800 hover:border-yellow-500/50 group",children:[e.jsx(Ot,{className:"w-8 h-8 text-yellow-500 group-hover:scale-125 transition-transform"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Armory Store"})]}),e.jsxs("button",{onClick:c,className:`flex flex-col items-center justify-center gap-2 p-6 rounded-3xl transition-all border ${d?"bg-purple-600/20 border-purple-500 text-purple-400 shadow-[0_0_30px_rgba(147,51,234,0.3)]":"bg-gray-900 border-gray-800 hover:border-purple-500/50"}`,children:[e.jsx(vr,{className:`w-8 h-8 ${d?"fill-purple-400":"text-gray-600"}`}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"God Mode"})]})]}),e.jsxs("div",{className:"flex items-center justify-between w-full px-6 py-4 bg-gray-900 border border-gray-800 rounded-3xl shadow-xl",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-600 uppercase tracking-widest",children:"Auto-Tapper Status"}),e.jsx("span",{className:`text-[11px] font-black uppercase ${u?"text-green-500":"text-gray-500"}`,children:u?d?"Overdrive (100/s)":`${(k==null?void 0:k.name)||"Standard"} Active`:"Manual Only"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:g,className:"sr-only peer"}),e.jsx("div",{className:"w-16 h-8 bg-gray-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-green-600 shadow-inner"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col items-center w-full lg:w-2/5 space-y-8",children:[e.jsxs("div",{className:"w-full bg-gray-900/50 border border-gray-800 p-8 rounded-[2.5rem] shadow-2xl space-y-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-[10px] font-black text-gray-600 uppercase tracking-[0.3em]",children:[t," National Score"]}),e.jsx("p",{className:"text-5xl font-black font-mono text-white tabular-nums tracking-tighter",children:Math.floor(I).toLocaleString()}),e.jsx("div",{className:"w-full h-3 bg-gray-950 rounded-full overflow-hidden border border-gray-800",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-500 via-orange-500 to-red-600 transition-all duration-1000 shadow-[0_0_15px_rgba(234,179,8,0.5)]",style:{width:`${Math.min(100,I/(P||1)*1e3)}%`}})})]}),e.jsxs("div",{className:"pt-8 border-t border-gray-800 space-y-1",children:[e.jsx("h3",{className:"text-[10px] font-black text-gray-600 uppercase tracking-[0.3em]",children:"Total Global Impact"}),e.jsx("p",{className:"text-4xl font-black font-mono text-white/30 tabular-nums tracking-tighter",children:Math.floor(P).toLocaleString()})]})]}),e.jsx(Gt,{leaderboard:s,userCountry:t})]}),e.jsx("style",{children:`
          @keyframes click-float {
            0% { transform: translate(-50%, -50%) scale(0.6); opacity: 0; }
            15% { opacity: 1; transform: translate(-50%, -100%) scale(1.3); }
            100% { transform: translate(-50%, -250%) scale(1.6); opacity: 0; }
          }
          @keyframes fade-in {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
          }
          .animate-fade-in { animation: fade-in 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        `})]}),h&&e.jsx(jr,{currentTier:i,onPurchase:o,onClose:()=>N(!1)})]})},kr=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6"}),e.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18"}),e.jsx("path",{d:"M4 22h16"}),e.jsx("path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"}),e.jsx("path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"}),e.jsx("path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z"})]}),Tr=t=>{const a=({USA:"US",China:"CN",India:"IN",Brazil:"BR",Russia:"RU",Japan:"JP",Germany:"DE","United Kingdom":"GB",France:"FR","South Korea":"KR",Canada:"CA",Australia:"AU"}[t]||"AQ").toUpperCase().split("").map(r=>127397+r.charCodeAt(0));return String.fromCodePoint(...a)},Er=({leaderboard:t,userCountry:n})=>{const s=Object.entries(t).sort(([,r],[,i])=>i-r),a=s.length>0?s[0]:null;return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 p-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-yellow-400 mb-4",children:"The War is Over!"}),a&&e.jsxs("div",{className:"flex flex-col items-center p-6 bg-gray-800 rounded-lg",children:[e.jsx(kr,{className:"w-24 h-24 text-yellow-400 mb-4"}),e.jsx("h2",{className:"text-3xl text-white",children:"The winner is"}),e.jsxs("p",{className:"text-5xl font-bold text-yellow-400 mt-2",children:[Tr(a[0])," ",a[0]]}),e.jsxs("p",{className:"text-2xl text-gray-300 mt-2 font-mono",children:["with ",a[1].toLocaleString()," clicks!"]})]})]}),e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-4",children:"Final Standings"}),e.jsx(Gt,{leaderboard:t,userCountry:n})]})]})},Cr=()=>{const[t,n]=m.useState(null),[s,a]=m.useState(0),[r,i]=m.useState({}),[o,d]=m.useState(null),[c,u]=m.useState({days:0,hours:0,minutes:0,seconds:0}),[g,h]=m.useState(!1),[N,j]=m.useState(!0),[A,v]=m.useState(null),[M,H]=m.useState(!1),[P,I]=m.useState(!0),k=m.useCallback(y=>{const f=y-new Date().getTime();return f>0?{days:Math.floor(f/(1e3*60*60*24)),hours:Math.floor(f/(1e3*60*60)%24),minutes:Math.floor(f/1e3/60%60),seconds:Math.floor(f/1e3%60)}:null},[]);m.useEffect(()=>{try{const y=localStorage.getItem("popcat_user_country"),f=localStorage.getItem("popcat_user_clicks"),T=localStorage.getItem("popcat_global_leaderboard");let B=localStorage.getItem("popcat_event_end_time");const F=localStorage.getItem("popcat_autoclick_tier"),se=localStorage.getItem("popcat_god_mode"),xe=localStorage.getItem("popcat_autoclick_enabled");y&&n(JSON.parse(y)),f&&a(JSON.parse(f)),F&&v(JSON.parse(F)),se&&H(JSON.parse(se)),xe&&I(JSON.parse(xe));let Ce=T?JSON.parse(T):{};if(Rt.forEach(G=>{Ce[G.name]===void 0&&(Ce[G.name]=0)}),i(Ce),!B){const G=new Date().getTime()+gr;B=String(G),localStorage.setItem("popcat_event_end_time",B)}const ye=parseInt(B,10);if(d(ye),new Date().getTime()>=ye)h(!0);else{const G=k(ye);G&&u(G)}}catch(y){console.warn("Storage sync failed, using defaults",y)}finally{setTimeout(()=>j(!1),800)}},[k]),m.useEffect(()=>{if(!o||g)return;const y=setInterval(()=>{const f=k(o);f?u(f):(h(!0),clearInterval(y))},1e3);return()=>clearInterval(y)},[o,g,k]);const p=y=>{n(y.name),localStorage.setItem("popcat_user_country",JSON.stringify(y.name)),i(f=>{const T={...f};return T[y.name]===void 0&&(T[y.name]=0),localStorage.setItem("popcat_global_leaderboard",JSON.stringify(T)),T})},E=m.useCallback(()=>{g||!t||a(y=>{const T=1+(Math.min(Lt,Math.floor(Math.sqrt(y/10))+1)-1)*.05,B=y+T;return i(F=>{const se={...F,[t]:(F[t]||0)+T};return localStorage.setItem("popcat_global_leaderboard",JSON.stringify(se)),se}),localStorage.setItem("popcat_user_clicks",JSON.stringify(B)),B})},[t,g]),_=y=>{v(y),localStorage.setItem("popcat_autoclick_tier",JSON.stringify(y))},O=()=>{const y=!M;H(y),localStorage.setItem("popcat_god_mode",JSON.stringify(y))},D=()=>{const y=!P;I(y),localStorage.setItem("popcat_autoclick_enabled",JSON.stringify(y))};return N?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-950 text-white p-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 border-4 border-yellow-500/10 border-t-yellow-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-ping"})})]}),e.jsx("p",{className:"mt-8 text-sm font-black tracking-[0.4em] uppercase text-gray-400 animate-pulse",children:"Syncing Intel..."})]}):g&&t?e.jsx(Er,{leaderboard:r,userCountry:t}):t?e.jsx(Sr,{userCountry:t,userClicks:s,leaderboard:r,timeLeft:c,onIncrement:E,autoClickTier:A,onPurchaseTier:_,isGodModeActive:M,onToggleGodMode:O,isAutoClickEnabled:P,onToggleAutoClick:D}):e.jsx(yr,{onSelectCountry:p})},Mr=({isOpen:t,onClose:n,onAdd:s})=>{const[a,r]=m.useState(""),[i,o]=m.useState(Pe.OTHER),[d,c]=m.useState(""),[u,g]=m.useState("");if(!t)return null;const h=N=>{N.preventDefault(),a.trim()&&(s({name:a,relationship:i,birthday:d,notes:u}),r(""),o(Pe.OTHER),c(""),g(""),n())};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md overflow-hidden shadow-2xl transform transition-all",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"새 친구 등록"}),e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"fas fa-times text-xl"})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"이름 *"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"친구 이름을 입력하세요",value:a,onChange:N=>r(N.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"관계"}),e.jsx("select",{className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",value:i,onChange:N=>o(N.target.value),children:Object.values(Pe).map(N=>e.jsx("option",{value:N,children:N},N))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"생일 (선택)"}),e.jsx("input",{type:"date",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",value:d,onChange:N=>c(N.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"특징 및 메모"}),e.jsx("textarea",{className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none h-24 resize-none",placeholder:"친구의 성격이나 좋아하는 것 등을 적어보세요",value:u,onChange:N=>g(N.target.value)})]}),e.jsx("button",{type:"submit",className:"w-full py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-200",children:"저장하기"})]})]})})},Ar=new _e({apiKey:"AIzaSyD24laq21PKbAI-8TvBOlvM-FP6kV-NmY4"}),Ir=async t=>{const s=await Ar.models.generateContent({model:"gemini-3-flash-preview",contents:`내 친구 ${t.name}에 대한 정보를 바탕으로 몇 가지를 제안해줘.
    관계: ${t.relationship}
    메모: ${t.notes||"없음"}
    
    1. 이 친구에게 어울리는 귀엽거나 재치 있는 별명 3개
    2. 이 친구에게 보내면 좋을 따뜻한 안부 인사말 한 문장
    
    JSON 형식으로 응답해줘.`,config:{responseMimeType:"application/json",responseSchema:{type:K.OBJECT,properties:{nicknames:{type:K.ARRAY,items:{type:K.STRING},description:"3 unique nicknames in Korean"},message:{type:K.STRING,description:"A friendly greeting message in Korean"}},required:["nicknames","message"]}}});return JSON.parse(s.text.trim())},Rr=({friend:t,onDelete:n})=>{const[s,a]=m.useState(!1),[r,i]=m.useState(null),o=async()=>{a(!0);try{const c=await Ir(t);i(c)}catch(c){console.error("AI Insight Error:",c),alert("AI 추천 정보를 가져오는 데 실패했습니다.")}finally{a(!1)}},d=c=>c.charAt(0);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 transition-all hover:shadow-md hover:scale-[1.01]",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold text-xl",children:d(t.name)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:t.name}),e.jsx("span",{className:"inline-block px-2 py-0.5 rounded text-xs font-semibold bg-indigo-50 text-indigo-600",children:t.relationship})]})]}),e.jsx("button",{onClick:()=>n(t.id),className:"text-gray-300 hover:text-red-500 transition-colors",children:e.jsx("i",{className:"fas fa-trash-alt"})})]}),t.birthday&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[e.jsx("i",{className:"fas fa-birthday-cake mr-2 text-pink-400"}),t.birthday]}),t.notes&&e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg line-clamp-2 mb-4",children:t.notes}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-50",children:r?e.jsxs("div",{className:"space-y-3 animate-fade-in",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:r.nicknames.map((c,u)=>e.jsxs("span",{className:"bg-amber-50 text-amber-700 text-xs px-2 py-1 rounded-full border border-amber-100",children:["✨ ",c]},u))}),e.jsxs("p",{className:"text-xs text-indigo-700 italic bg-indigo-50 p-2 rounded border border-indigo-100",children:['"',r.message,'"']}),e.jsx("button",{onClick:()=>i(null),className:"text-[10px] text-gray-400 hover:underline",children:"닫기"})]}):e.jsx("button",{onClick:o,disabled:s,className:`flex items-center justify-center w-full py-2 rounded-lg text-sm font-medium transition-all ${s?"bg-gray-100 text-gray-400":"bg-gradient-to-r from-violet-500 to-indigo-500 text-white hover:from-violet-600 hover:to-indigo-600"}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"AI가 생각하는 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-magic mr-2"}),"AI 별명 & 메시지 추천"]})})})]})},Lr=()=>{const[t,n]=m.useState([]),[s,a]=m.useState(!1),[r,i]=m.useState(""),[o,d]=m.useState("ALL");m.useEffect(()=>{const h=localStorage.getItem("friendlink_friends");if(h)try{n(JSON.parse(h))}catch{console.error("Failed to load friends")}},[]),m.useEffect(()=>{localStorage.setItem("friendlink_friends",JSON.stringify(t))},[t]);const c=h=>{const N={...h,id:crypto.randomUUID(),createdAt:Date.now()};n(j=>[N,...j])},u=h=>{confirm("이 친구를 목록에서 삭제할까요?")&&n(N=>N.filter(j=>j.id!==h))},g=m.useMemo(()=>t.filter(h=>{const N=h.name.toLowerCase().includes(r.toLowerCase())||(h.notes||"").toLowerCase().includes(r.toLowerCase()),j=o==="ALL"||h.relationship===o;return N&&j}),[t,r,o]);return e.jsxs("div",{className:"min-h-screen pb-20 bg-slate-50",children:[e.jsx("header",{className:"bg-white border-b sticky top-0 z-40 backdrop-blur-sm bg-white/80",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white shadow-lg",children:e.jsx("i",{className:"fas fa-user-friends text-xl"})}),e.jsx("h1",{className:"text-2xl font-black text-gray-900 tracking-tight",children:"FriendLink"})]}),e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"친구 검색...",className:"w-full pl-10 pr-4 py-2 bg-gray-100 rounded-full border-none focus:ring-2 focus:ring-indigo-500 focus:bg-white transition-all outline-none",value:r,onChange:h=>i(h.target.value)})]})]})}),e.jsxs("main",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center overflow-x-auto pb-4 gap-2 no-scrollbar",children:[e.jsx("button",{onClick:()=>d("ALL"),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${o==="ALL"?"bg-indigo-600 text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"전체"}),Object.values(Pe).map(h=>e.jsx("button",{onClick:()=>d(h),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${o===h?"bg-indigo-600 text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-100"}`,children:h},h))]}),e.jsxs("div",{className:"mb-6 flex justify-between items-center text-sm text-gray-500",children:[e.jsxs("span",{children:["총 ",e.jsxs("strong",{children:[g.length,"명"]}),"의 친구"]}),r&&e.jsxs("span",{children:["검색 결과: ",g.length,"건"]})]}),g.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.map(h=>e.jsx(Rr,{friend:h,onDelete:u},h.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center text-gray-300 mb-4",children:e.jsx("i",{className:"fas fa-users-slash text-3xl"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"친구가 아직 없나요?"}),e.jsx("p",{className:"text-gray-500 max-w-xs mx-auto mt-2",children:"우측 하단의 버튼을 눌러 소중한 인연들을 저장해 보세요."})]})]}),e.jsxs("button",{onClick:()=>a(!0),className:"fixed bottom-8 right-8 w-14 h-14 bg-indigo-600 text-white rounded-full flex items-center justify-center shadow-xl hover:bg-indigo-700 hover:scale-110 active:scale-95 transition-all z-40 group",children:[e.jsx("i",{className:"fas fa-plus text-xl transition-transform group-hover:rotate-90"}),e.jsx("span",{className:"absolute right-full mr-4 bg-gray-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap",children:"새 친구 추가"})]}),e.jsx(Mr,{isOpen:s,onClose:()=>a(!1),onAdd:c})]})},_r=({stage:t,difficulty:n,score:s,lives:a})=>e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 p-4",children:e.jsxs("div",{className:"max-w-md mx-auto flex justify-between items-center glass p-3 rounded-2xl border border-white/10 shadow-2xl",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-slate-400 font-bold",children:"스테이지"}),e.jsx("span",{className:"text-xl font-bold text-cyan-400 text-glow-cyan",children:t})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-slate-400 font-bold",children:"난이도"}),e.jsx("span",{className:`text-[11px] font-bold px-3 py-0.5 rounded-full border ${n===Ee.EASY?"border-emerald-500/50 text-emerald-400 bg-emerald-500/10":n===Ee.MEDIUM?"border-amber-500/50 text-amber-400 bg-amber-500/10":"border-rose-500/50 text-rose-400 bg-rose-500/10"}`,children:n})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-slate-400 font-bold",children:"생명"}),e.jsx("div",{className:"flex gap-1",children:[...Array(3)].map((r,i)=>e.jsx("i",{className:`fas fa-heart text-[10px] ${i<a?"text-rose-500":"text-slate-700"}`},i))})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-slate-400 font-bold",children:"점수"}),e.jsx("span",{className:"text-xl font-bold text-white",children:s})]})]})]})}),Gr=({puzzle:t,onSelectOption:n,selectedOption:s,isLocked:a,showHint:r,onToggleHint:i})=>e.jsxs("div",{className:"w-full max-w-md mx-auto flex flex-col gap-6 animate-slide-up",children:[e.jsx("div",{className:"glass p-5 rounded-3xl border-l-4 border-l-cyan-500 shadow-xl",children:e.jsxs("p",{className:"text-cyan-200 text-sm italic leading-relaxed",children:[e.jsx("i",{className:"fas fa-quote-left mr-2 opacity-50"}),t.story]})}),e.jsxs("div",{className:"glass p-8 rounded-3xl shadow-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 bg-cyan-500/10 rounded-full blur-3xl group-hover:bg-cyan-500/20 transition-all duration-700"}),e.jsxs("h3",{className:"text-[10px] uppercase tracking-widest text-slate-400 font-bold mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-fingerprint text-cyan-500"}),"패턴 해독"]}),e.jsx("p",{className:"text-2xl font-bold mb-8 text-white font-mono leading-tight whitespace-pre-line",children:t.question}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:t.options.map((o,d)=>e.jsx("button",{disabled:a,onClick:()=>n(o),className:`p-4 rounded-2xl font-mono text-xl font-bold transition-all duration-200 border transform active:scale-95 ${s===o?"bg-cyan-500 border-cyan-400 text-white shadow-lg scale-105 glow-cyan":"bg-slate-800/50 border-white/10 text-slate-300 hover:border-cyan-500/50 hover:bg-slate-800"}`,children:o},d))})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:i,className:`flex items-center gap-2 text-[11px] font-bold uppercase tracking-wider transition-colors ${r?"text-amber-400":"text-slate-500 hover:text-slate-300"}`,children:[e.jsx("i",{className:"fas fa-lightbulb opacity-75"}),r?"힌트 확인됨":"단서 요청하기"]})}),r&&e.jsx("div",{className:"glass p-4 rounded-2xl border border-amber-500/30 bg-amber-500/5 animate-slide-up text-center",children:e.jsxs("p",{className:"text-amber-200 text-xs",children:[e.jsx("span",{className:"font-bold mr-1",children:"HINT:"})," ",t.hint]})})]}),Or=()=>{const[t,n]=He.useState("암호화 코어 초기화 중..."),s=["논리적 패턴 환경 스캔 중...","체임버 잠금 장치 보안 확인 중...","수학적 난이도 매트릭스 보정 중...","퍼즐 엔진과 신경망 연결 수립 중...","수열 내 비정상 패턴 감지 중...","보안 프로토콜 우회 시도 중...","다음 구역의 코드 해독 중..."];return He.useEffect(()=>{const a=setInterval(()=>{n(s[Math.floor(Math.random()*s.length)])},2e3);return()=>clearInterval(a)},[]),e.jsxs("div",{className:"fixed inset-0 z-40 flex flex-col items-center justify-center bg-slate-950/90 backdrop-blur-sm p-6 text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mb-8",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-cyan-500/20 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-t-4 border-cyan-400 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-4 border-4 border-indigo-500/20 rounded-full"}),e.jsx("div",{className:"absolute inset-4 border-b-4 border-indigo-400 rounded-full animate-spin-slow"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-brain text-cyan-400 text-2xl animate-pulse"})})]}),e.jsx("h2",{className:"text-xl font-bold text-white mb-2 tracking-tight",children:"도전 과제 생성 중"}),e.jsx("p",{className:"text-slate-400 text-xs font-mono max-w-xs h-10",children:t}),e.jsx("style",{children:`
        .animate-spin-slow {
          animation: spin 3s linear infinite;
        }
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})},Dr=({onStart:t,onShowRanking:n})=>{const[s,a]=He.useState(Ee.EASY);return e.jsxs("div",{className:"w-full max-w-md mx-auto flex flex-col items-center gap-8 animate-slide-up",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-block p-4 rounded-3xl bg-cyan-500/10 border border-cyan-500/30 mb-6 glow-cyan",children:e.jsx("i",{className:"fas fa-brain text-4xl text-cyan-400"})}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-2 tracking-tighter",children:"MATH PUZZLE"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"논리적 사고의 한계에 도전하세요."})]}),e.jsxs("div",{className:"w-full glass p-6 rounded-3xl flex flex-col gap-4",children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest text-center",children:"시작 난이도 선택"}),e.jsx("div",{className:"flex flex-col gap-2",children:Object.values(Ee).map(r=>e.jsx("button",{onClick:()=>a(r),className:`py-4 rounded-2xl font-bold transition-all border ${s===r?"bg-cyan-600 border-cyan-400 text-white glow-cyan":"bg-slate-800/50 border-white/10 text-slate-400 hover:bg-slate-800"}`,children:r},r))})]}),e.jsxs("div",{className:"flex flex-col w-full gap-3",children:[e.jsx("button",{onClick:()=>t(s),className:"w-full py-5 bg-white text-slate-950 rounded-2xl font-bold text-lg hover:bg-cyan-400 transition-all transform active:scale-95 shadow-xl",children:"게임 시작"}),e.jsxs("button",{onClick:n,className:"w-full py-4 glass text-white rounded-2xl font-bold border-white/20 hover:bg-white/5 transition-all flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-trophy text-amber-400"}),"순위 보기"]})]})]})},Pr=({rankings:t,onBack:n})=>e.jsxs("div",{className:"w-full max-w-md mx-auto flex flex-col gap-6 animate-slide-up",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2 uppercase tracking-tight",children:"TOP AGENTS"}),e.jsx("p",{className:"text-slate-400 text-xs",children:"전체 해독 전문가 순위"})]}),e.jsx("div",{className:"glass rounded-3xl overflow-hidden border border-white/10 shadow-2xl",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-white/5 border-b border-white/10",children:[e.jsx("th",{className:"p-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"순위"}),e.jsx("th",{className:"p-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"에이전트"}),e.jsx("th",{className:"p-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest text-right",children:"점수"})]})}),e.jsx("tbody",{children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"p-10 text-center text-slate-500 italic",children:"아직 기록된 점수가 없습니다."})}):t.map((s,a)=>e.jsxs("tr",{className:"border-b border-white/5 last:border-0 hover:bg-white/5 transition-colors",children:[e.jsxs("td",{className:"p-4 font-mono font-bold text-cyan-400",children:["#",a+1]}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-white",children:s.name}),e.jsxs("span",{className:"text-[10px] text-slate-500",children:["스테이지 ",s.stage]})]})}),e.jsx("td",{className:"p-4 text-right font-mono font-bold text-white",children:s.score.toLocaleString()})]},a))})]})}),e.jsxs("button",{onClick:n,className:"w-full py-4 glass text-slate-400 rounded-2xl font-bold border-white/10 hover:text-white transition-all flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-arrow-left"}),"메인으로 돌아가기"]})]}),Br=new _e({apiKey:"AIzaSyD24laq21PKbAI-8TvBOlvM-FP6kV-NmY4"}),$r={type:K.OBJECT,properties:{story:{type:K.STRING,description:"탈출 게임 스타일의 짧은 서사적 배경 (1-2문장, 한국어로 작성)."},question:{type:K.STRING,description:"해결해야 할 수학적 패턴 문제 (한국어로 작성)."},options:{type:K.ARRAY,items:{type:K.STRING},description:"정확히 4개의 객관식 선택지."},correctAnswer:{type:K.STRING,description:"options 배열 중 정확한 정답."},hint:{type:K.STRING,description:"사용자를 돕기 위한 최소한의 힌트 (한국어로 작성)."},explanation:{type:K.STRING,description:"패턴에 대한 간략한 논리적 설명 (한국어로 작성)."}},required:["story","question","options","correctAnswer","hint","explanation"]};async function Hr(t,n){const s=`
    당신은 "수학 퍼즐 탈출"이라는 모바일 앱의 AI 퍼즐 디자이너입니다.
    ${t} 난이도의 수학 패턴 퍼즐을 생성하세요. 모든 텍스트는 한국어로 작성해야 합니다.
    
    현재 스테이지: ${n}
    
    난이도 가이드라인:
    - 쉬움: 단순 수열, 더하기/빼기 패턴, 기본적인 시각적 논리.
    - 보통: 다단계 규칙, 혼합 연산 (예: 곱하기 후 더하기), 제곱수, 소수 수열.
    - 어려움: 추상적 논리, 숨겨진 제약 조건, 복잡한 수열 (피보나치 유사, 다층 차이), 대수적 패턴 인식.
    
    이야기 테마: 탈출 게임, 미스터리, 첨단 금고, 고대 사원 중 하나를 선택하세요.
    질문: 명확하지만 도전적이어야 합니다.
    
    반드시 수학적으로 정확해야 하며 정답은 하나여야 합니다.
  `;try{const a=await Br.models.generateContent({model:"gemini-3-flash-preview",contents:s,config:{responseMimeType:"application/json",responseSchema:$r,temperature:.9}});return JSON.parse(a.text.trim())}catch(a){return console.error("퍼즐 생성 실패:",a),{story:"벽에 알 수 없는 숫자들이 적혀 있습니다. 마지막 숫자를 알아내야 문이 열릴 것 같습니다.",question:"다음 수열을 완성하세요: 2, 4, 8, 16, ?",options:["24","30","32","64"],correctAnswer:"32",hint:"각 숫자는 이전 숫자의 두 배입니다.",explanation:"공비가 2인 등비수열입니다."}}}const Nt="math_puzzle_rankings",Ur=()=>{const[t,n]=m.useState({stage:1,difficulty:Ee.EASY,score:0,lives:3,status:"MENU"}),[s,a]=m.useState(null),[r,i]=m.useState(!1),[o,d]=m.useState(null),[c,u]=m.useState(null),[g,h]=m.useState(!1),[N,j]=m.useState([]);m.useEffect(()=>{const I=localStorage.getItem(Nt);I&&j(JSON.parse(I))},[]);const A=(I,k)=>{const E={name:prompt("축하합니다! 이름을 입력하세요 (랭킹 등록):")||"익명의 에이전트",score:I,stage:k,date:new Date().toISOString()},_=[...N,E].sort((O,D)=>D.score-O.score).slice(0,10);j(_),localStorage.setItem(Nt,JSON.stringify(_))},v=m.useCallback(async(I,k)=>{i(!0),h(!1),d(null),u(null);try{const p=await Hr(I,k);a(p)}catch(p){console.error(p)}finally{i(!1)}},[]),M=I=>{n({stage:1,difficulty:I,score:0,lives:3,status:"PLAYING"}),v(I,1)},H=I=>{c||!s||(d(I),I===s.correctAnswer?(u({type:"success",message:"잠금 해제 성공. 다음 구역으로 이동합니다."}),setTimeout(()=>{const k=t.stage+1;let p=t.difficulty;t.difficulty===Ee.EASY&&k>5&&(p=Ee.MEDIUM),t.difficulty===Ee.MEDIUM&&k>10&&(p=Ee.HARD),n(E=>({...E,stage:k,difficulty:p,score:E.score+(t.difficulty===Ee.EASY?100:t.difficulty===Ee.MEDIUM?250:500)})),v(p,k)},1500)):(u({type:"error",message:"해독 오류: 보안 프로토콜이 작동되었습니다."}),n(k=>{const p=k.lives-1;return p<=0?(setTimeout(()=>{A(k.score,k.stage),n(E=>({...E,status:"GAME_OVER"}))},1500),{...k,lives:0}):{...k,lives:p}}),setTimeout(()=>{t.lives>1&&(u(null),d(null))},1500)))},P=()=>{n(I=>({...I,status:"MENU"}))};return t.status==="MENU"?e.jsx("div",{className:"min-h-screen pt-12 pb-12 px-4 flex flex-col items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-black",children:e.jsx(Dr,{onStart:M,onShowRanking:()=>n(I=>({...I,status:"RANKING"}))})}):t.status==="RANKING"?e.jsx("div",{className:"min-h-screen pt-12 pb-12 px-4 flex flex-col items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-black",children:e.jsx(Pr,{rankings:N,onBack:P})}):t.status==="GAME_OVER"?e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 bg-slate-950",children:e.jsxs("div",{className:"glass p-10 rounded-3xl border border-rose-500/30 text-center max-w-sm w-full animate-slide-up shadow-2xl",children:[e.jsx("div",{className:"w-20 h-20 bg-rose-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("i",{className:"fas fa-skull-crossbones text-rose-500 text-3xl"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2 uppercase tracking-tighter",children:"작전 실패"}),e.jsxs("p",{className:"text-slate-400 mb-8 leading-relaxed",children:["보안망을 뚫지 못했습니다.",e.jsx("br",{}),"최종 스테이지: ",t.stage,e.jsx("br",{}),"최종 점수: ",t.score.toLocaleString()]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>M(t.difficulty),className:"w-full bg-rose-600 hover:bg-rose-500 text-white font-bold py-4 rounded-2xl transition-all shadow-lg hover:shadow-rose-600/20 transform active:scale-95",children:"다시 시도"}),e.jsx("button",{onClick:P,className:"w-full glass text-slate-400 font-bold py-3 rounded-2xl hover:text-white transition-all",children:"메인 메뉴로"})]})]})}):e.jsxs("div",{className:"min-h-screen pt-24 pb-12 px-4 flex flex-col items-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-black",children:[e.jsx(_r,{stage:t.stage,difficulty:t.difficulty,score:t.score,lives:t.lives}),r&&e.jsx(Or,{}),!r&&s&&e.jsx(Gr,{puzzle:s,onSelectOption:H,selectedOption:o,isLocked:!!c,showHint:g,onToggleHint:()=>h(!g)}),c&&e.jsx("div",{className:"fixed bottom-12 left-0 right-0 z-50 px-4 animate-bounce",children:e.jsx("div",{className:`max-w-md mx-auto glass p-4 rounded-2xl text-center border-2 ${c.type==="success"?"border-emerald-500 bg-emerald-500/20":"border-rose-500 bg-rose-500/20"}`,children:e.jsxs("p",{className:`font-bold text-xs tracking-widest flex items-center justify-center gap-2 ${c.type==="success"?"text-emerald-400":"text-rose-400"}`,children:[e.jsx("i",{className:`fas ${c.type==="success"?"fa-check-circle":"fa-exclamation-triangle"}`}),c.message]})})}),e.jsx("div",{className:"fixed bottom-0 left-0 w-full h-1/4 pointer-events-none bg-gradient-to-t from-cyan-500/5 to-transparent z-0 opacity-50"})]})},Dt=()=>{const t="AIzaSyD24laq21PKbAI-8TvBOlvM-FP6kV-NmY4";return new _e({apiKey:t})},Fr=async(t,n)=>{const s=Dt(),a=`Act as an expert English language tutor. 
  Recommend 6 high-quality English vocabulary words for a student at the ${t} level.
  Their interests include: ${n.join(", ")}.
  Provide the output in a structured JSON format. 
  Each word should include: 
  - word
  - phonetic (IPA)
  - definition (in simple English)
  - koreanTranslation (natural Korean translation)
  - exampleSentence (using the word in a relevant context)
  - synonyms (at least 2)
  - usageTip (a short note on how to use it naturally)`;try{const r=await s.models.generateContent({model:"gemini-3-flash-preview",contents:a,config:{responseMimeType:"application/json",responseSchema:{type:K.OBJECT,properties:{words:{type:K.ARRAY,items:{type:K.OBJECT,properties:{word:{type:K.STRING},phonetic:{type:K.STRING},definition:{type:K.STRING},koreanTranslation:{type:K.STRING},exampleSentence:{type:K.STRING},synonyms:{type:K.ARRAY,items:{type:K.STRING}},usageTip:{type:K.STRING}},required:["word","phonetic","definition","koreanTranslation","exampleSentence","synonyms","usageTip"]}}}}}});return JSON.parse(r.text||'{"words": []}').words}catch(r){throw console.error("Error fetching words:",r),r}},qr=async t=>{var s,a,r,i,o,d;const n=Dt();try{const u=(d=(o=(i=(r=(a=(s=(await n.models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:`Say clearly: ${t}`}]}],config:{responseModalities:[fs.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}}}})).candidates)==null?void 0:s[0])==null?void 0:a.content)==null?void 0:r.parts)==null?void 0:i[0])==null?void 0:o.inlineData)==null?void 0:d.data;if(!u)throw new Error("No audio data received from Gemini TTS. Check your GEMINI_API_KEY and model availability.");const g=atob(u),h=new Uint8Array(g.length);for(let N=0;N<g.length;N++)h[N]=g.charCodeAt(N);return h.buffer}catch(c){throw console.error("Error generating speech:",c),c}},Vr=async(t,n,s=24e3,a=1)=>{const r=new Int16Array(t.buffer),i=r.length/a,o=n.createBuffer(a,i,s);for(let d=0;d<a;d++){const c=o.getChannelData(d);for(let u=0;u<i;u++)c[u]=r[u*a+d]/32768}return o},Wr=({word:t})=>{const[n,s]=m.useState(!1),[a,r]=m.useState(!1),i=async()=>{if(!n){s(!0);try{const o=await qr(t.word),d=new(window.AudioContext||window.webkitAudioContext)({sampleRate:24e3}),c=await Vr(new Uint8Array(o),d,24e3,1),u=d.createBufferSource();u.buffer=c,u.connect(d.destination),u.start(),u.onended=()=>{s(!1),d.close()}}catch(o){console.error("Audio error:",o),s(!1)}}};return e.jsxs("div",{className:"bg-white rounded-3xl border border-slate-100 shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden flex flex-col group",children:[e.jsxs("div",{className:"p-6 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 group-hover:text-indigo-600 transition-colors",children:t.word}),e.jsx("button",{onClick:i,disabled:n,className:`p-2 rounded-full transition-all ${n?"bg-slate-100":"bg-indigo-50 text-indigo-600 hover:bg-indigo-600 hover:text-white"}`,title:"Listen Pronunciation",children:n?e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-indigo-500 border-t-transparent rounded-full"}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),e.jsx("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"}),e.jsx("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14"})]})})]}),e.jsxs("p",{className:"text-slate-400 font-mono text-sm mb-3",children:["[",t.phonetic,"]"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-indigo-600 font-bold text-lg mb-1",children:t.koreanTranslation}),e.jsxs("p",{className:"text-slate-600 text-sm leading-relaxed italic",children:['"',t.definition,'"']})]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-4 border border-slate-100",children:[e.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase tracking-wider mb-2",children:"Example"}),e.jsx("p",{className:"text-slate-800 text-sm font-medium",children:t.exampleSentence})]})]}),e.jsxs("div",{className:"px-6 pb-6",children:[e.jsxs("button",{onClick:()=>r(!a),className:"w-full py-2 text-xs font-bold text-slate-400 uppercase tracking-widest hover:text-indigo-500 transition-colors flex items-center justify-center gap-2",children:[a?"Hide Details":"View Synonyms & Tips",e.jsx("span",{className:`transition-transform duration-300 ${a?"rotate-180":""}`,children:"▼"})]}),a&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 space-y-4 animate-fadeIn",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-[10px] font-bold uppercase tracking-widest mb-2",children:"Synonyms"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.synonyms.map((o,d)=>e.jsx("span",{className:"bg-white border border-slate-200 text-slate-600 px-2 py-1 rounded-lg text-xs",children:o},d))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-[10px] font-bold uppercase tracking-widest mb-1",children:"Usage Tip"}),e.jsx("p",{className:"text-slate-600 text-xs italic leading-snug bg-amber-50 p-2 rounded-lg border border-amber-100",children:t.usageTip})]})]})]})]})},Yr=()=>{const[t,n]=m.useState(st.INTERMEDIATE),[s,a]=m.useState(["Daily Life","Travel"]),[r,i]=m.useState(""),[o,d]=m.useState([]),[c,u]=m.useState(!1),[g,h]=m.useState(null),N=async()=>{u(!0),h(null);try{const v=await Fr(t,s);d(v)}catch(v){h(v!=null&&v.message?`Error: ${v.message}`:"Failed to fetch words. Please try again."),console.error(v)}finally{u(!1)}};m.useEffect(()=>{N()},[t]);const j=v=>{v.preventDefault(),r.trim()&&!s.includes(r.trim())&&(a([...s,r.trim()]),i(""))},A=v=>{a(s.filter((M,H)=>H!==v))};return e.jsxs("div",{className:"min-h-screen pb-20 px-4 pt-12 md:pt-20 max-w-6xl mx-auto",children:[e.jsxs("header",{className:"text-center mb-12",children:[e.jsxs("h1",{className:"text-4xl md:text-5xl font-bold mb-4 tracking-tight",children:["VocabVantage ",e.jsx("span",{className:"gradient-text",children:"AI"})]}),e.jsx("p",{className:"text-slate-600 text-lg max-w-2xl mx-auto",children:"Personalized English vocabulary coaching powered by Gemini. Select your level and interests to get started."})]}),e.jsxs("section",{className:"bg-white rounded-3xl shadow-xl shadow-indigo-100 p-6 md:p-8 mb-10 border border-slate-100",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider text-slate-400 mb-4",children:"Your Proficiency Level"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Object.values(st).map(v=>e.jsx("button",{onClick:()=>n(v),className:`py-3 px-4 rounded-xl text-sm font-medium transition-all duration-200 border ${t===v?"bg-indigo-600 text-white border-indigo-600 shadow-lg shadow-indigo-200":"bg-slate-50 text-slate-600 border-slate-200 hover:border-indigo-300"}`,children:v},v))})]}),e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider text-slate-400 mb-4",children:"Focus Interests"}),e.jsxs("form",{onSubmit:j,className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:r,onChange:v=>i(v.target.value),placeholder:"e.g. Finance, Nature, Coding...",className:"flex-1 bg-slate-50 border border-slate-200 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all"}),e.jsx("button",{type:"submit",className:"bg-indigo-100 text-indigo-700 px-4 py-2 rounded-xl text-sm font-bold hover:bg-indigo-200 transition-colors",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map((v,M)=>e.jsxs("span",{className:"bg-indigo-50 text-indigo-600 px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1 group",children:[v,e.jsx("button",{onClick:()=>A(M),className:"hover:text-indigo-800 font-bold opacity-60 hover:opacity-100",children:"×"})]},M))})]})]}),e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx("button",{onClick:N,disabled:c,className:"group flex items-center gap-2 bg-slate-900 text-white px-8 py-3 rounded-2xl font-semibold hover:bg-slate-800 transition-all disabled:opacity-50",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Updating Vocabulary..."]}):e.jsxs(e.Fragment,{children:["Generate New Recommendations",e.jsx("span",{className:"group-hover:translate-x-1 transition-transform",children:"→"})]})})})]}),g&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-xl text-center mb-8 border border-red-100",children:g}),c&&!o.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-pulse",children:[1,2,3,4,5,6].map(v=>e.jsx("div",{className:"bg-slate-200 h-64 rounded-3xl"},v))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map((v,M)=>e.jsx(Wr,{word:v},`${v.word}-${M}`))})]})};function zr(){return e.jsx(hs,{basename:"/test_myReactProject",children:e.jsx(us,{children:e.jsxs(Se,{path:"/",element:e.jsx(ys,{}),children:[e.jsx(Se,{index:!0,element:e.jsx(Ts,{})}),e.jsx(Se,{path:"DilemmaSimulator",element:e.jsx(As,{})}),e.jsx(Se,{path:"myCard",element:e.jsx(_s,{})}),e.jsx(Se,{path:"gacha",element:e.jsx(Sa,{})}),e.jsx(Se,{path:"Last_night",element:e.jsx(Xa,{})}),e.jsx(Se,{path:"mordern",element:e.jsx(sr,{})}),e.jsx(Se,{path:"word",element:e.jsx(cr,{})}),e.jsx(Se,{path:"word2",element:e.jsx(fr,{})}),e.jsx(Se,{path:"click_war",element:e.jsx(Cr,{})}),e.jsx(Se,{path:"friend",element:e.jsx(Lr,{})}),e.jsx(Se,{path:"math",element:e.jsx(Ur,{})}),e.jsx(Se,{path:"AI_voca",element:e.jsx(Yr,{})})]})})})}const Pt=document.getElementById("root");if(!Pt)throw new Error("Could not find root element to mount to");const Kr=ps.createRoot(Pt);Kr.render(e.jsx(He.StrictMode,{children:e.jsx(zr,{})}));
